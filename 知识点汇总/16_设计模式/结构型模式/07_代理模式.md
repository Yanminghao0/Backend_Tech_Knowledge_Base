# ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰

> ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®

---

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯

- **ç±»å‹**: ç»“æ„å‹æ¨¡å¼
- **éš¾åº¦**: â­â­â­
- **ä½¿ç”¨é¢‘ç‡**: â­â­â­â­â­
- **å…³é”®è¯**: é™æ€ä»£ç†ã€JDKåŠ¨æ€ä»£ç†ã€CGLIBä»£ç†ã€AOP

---

## ğŸ¯ æ¨¡å¼æ„å›¾

**æ ¸å¿ƒæ€æƒ³**ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ä»£ç†æ¨¡å¼é€šè¿‡å¼•å…¥ä¸€ä¸ªä»£ç†å¯¹è±¡ä½œä¸ºä¸­é—´å±‚ï¼Œæ¥é—´æ¥è®¿é—®ç›®æ ‡å¯¹è±¡ï¼Œä»è€Œå¯ä»¥åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„å‰æä¸‹å¢å¼ºå…¶åŠŸèƒ½æˆ–æ§åˆ¶å…¶è®¿é—®ã€‚

**è§£å†³çš„é—®é¢˜**ï¼š
- å¦‚ä½•åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„å‰æä¸‹å¯¹å…¶è¿›è¡ŒåŠŸèƒ½å¢å¼º
- å¦‚ä½•æ§åˆ¶å¯¹æ•æ„Ÿå¯¹è±¡çš„è®¿é—®æƒé™
- å¦‚ä½•å¤„ç†åˆ›å»ºæˆæœ¬é«˜çš„å¯¹è±¡ï¼ˆå»¶è¿Ÿåˆå§‹åŒ–ï¼‰
- å¦‚ä½•å®ç°è¿œç¨‹å¯¹è±¡çš„æœ¬åœ°è®¿é—®
- å¦‚ä½•è®°å½•å¯¹è±¡çš„è®¿é—®æ—¥å¿—æˆ–ç»Ÿè®¡è®¿é—®æ¬¡æ•°

**é€‚ç”¨åœºæ™¯**ï¼š
- ğŸ”’ **è®¿é—®æ§åˆ¶**ï¼šå¦‚æƒé™éªŒè¯ã€å®‰å…¨æ£€æŸ¥
- ğŸš€ **æ€§èƒ½ä¼˜åŒ–**ï¼šå¦‚å»¶è¿ŸåŠ è½½ã€ç¼“å­˜ä»£ç†
- ğŸ“ **æ—¥å¿—è®°å½•**ï¼šå¦‚è¯·æ±‚æ—¥å¿—ã€æ€§èƒ½ç›‘æ§
- ğŸŒ **è¿œç¨‹ä»£ç†**ï¼šå¦‚RPCè°ƒç”¨ã€åˆ†å¸ƒå¼æœåŠ¡
- ğŸ§ª **æµ‹è¯•æ›¿èº«**ï¼šå¦‚å•å…ƒæµ‹è¯•ä¸­çš„æ¨¡æ‹Ÿå¯¹è±¡
- ğŸ’¾ **æ•°æ®åº“è®¿é—®**ï¼šå¦‚è¿æ¥æ± ã€äº‹åŠ¡ç®¡ç†
- ğŸ–¥ï¸ **UIç»„ä»¶**ï¼šå¦‚è™šæ‹Ÿåˆ—è¡¨ã€æ‡’åŠ è½½ç»„ä»¶
- ğŸ”„ **äº‹åŠ¡ç®¡ç†**ï¼šå¦‚å£°æ˜å¼äº‹åŠ¡
- ğŸ›¡ï¸ **å¼‚å¸¸å¤„ç†**ï¼šå¦‚ç»Ÿä¸€å¼‚å¸¸æ•è·

## ğŸ—ï¸ UMLç±»å›¾

```mermaid
classDiagram
    class Subject {
        <<interface>>
        +request(): void
    }
    class RealSubject {
        +request(): void
    }
    class Proxy {
        -realSubject: RealSubject
        +request(): void
    }
    class Client {
    }

    Client --> Subject
    Subject <|-- RealSubject
    Subject <|-- Proxy
    Proxy --> RealSubject
```

**ç±»å›¾è¯´æ˜**ï¼š
- `Subject`ï¼šæŠ½è±¡ä¸»é¢˜æ¥å£ï¼Œå®šä¹‰äº†RealSubjectå’ŒProxyçš„å…±åŒæ¥å£
- `RealSubject`ï¼šçœŸå®ä¸»é¢˜ç±»ï¼Œå®ç°äº†Subjectæ¥å£ï¼Œæ˜¯ä»£ç†å¯¹è±¡æ‰€ä»£è¡¨çš„çœŸå®å¯¹è±¡
- `Proxy`ï¼šä»£ç†ç±»ï¼Œå®ç°äº†Subjectæ¥å£ï¼ŒåŒ…å«å¯¹RealSubjectçš„å¼•ç”¨ï¼Œå¯ä»¥è®¿é—®ã€æ§åˆ¶æˆ–æ‰©å±•RealSubjectçš„åŠŸèƒ½
- `Client`ï¼šå®¢æˆ·ç«¯ï¼Œé€šè¿‡Subjectæ¥å£ä¸ä»£ç†å¯¹è±¡äº¤äº’

**ä»£ç†æ¨¡å¼ç±»å‹**ï¼š
1. **é™æ€ä»£ç†**ï¼šç¼–è¯‘æœŸå°±å·²ç»ç¡®å®šä»£ç†ç±»å’Œç›®æ ‡ç±»çš„å…³ç³»
2. **åŠ¨æ€ä»£ç†**ï¼šè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼ˆå¦‚JDKåŠ¨æ€ä»£ç†ã€CGLIBä»£ç†ï¼‰
3. **è¿œç¨‹ä»£ç†**ï¼šä¸ºä¸åŒåœ°å€ç©ºé—´çš„å¯¹è±¡æä¾›æœ¬åœ°ä»£ç†
4. **è™šæ‹Ÿä»£ç†**ï¼šå»¶è¿ŸåŠ è½½åˆ›å»ºæˆæœ¬é«˜çš„å¯¹è±¡
5. **ä¿æŠ¤ä»£ç†**ï¼šæ§åˆ¶å¯¹åŸå§‹å¯¹è±¡çš„è®¿é—®æƒé™
6. **æ™ºèƒ½å¼•ç”¨**ï¼šåœ¨è®¿é—®å¯¹è±¡æ—¶æ‰§è¡Œä¸€äº›é™„åŠ æ“ä½œ
7. **ç¼“å­˜ä»£ç†**ï¼šä¸º expensive æ“ä½œç»“æœæä¾›ä¸´æ—¶ç¼“å­˜

## ğŸ’» ä»£ç å®ç°

### 1. é™æ€ä»£ç†

```java
// æŠ½è±¡ä¸»é¢˜æ¥å£
public interface Image {
    void display();
}

// çœŸå®ä¸»é¢˜ç±»
public class RealImage implements Image {
    private String fileName;

    public RealImage(String fileName) {
        this.fileName = fileName;
        loadFromDisk(fileName);
    }

    private void loadFromDisk(String fileName) {
        System.out.println("ä»ç£ç›˜åŠ è½½å›¾ç‰‡: " + fileName);
        // æ¨¡æ‹ŸåŠ è½½å›¾ç‰‡çš„è€—æ—¶æ“ä½œ
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    @Override
    public void display() {
        System.out.println("æ˜¾ç¤ºå›¾ç‰‡: " + fileName);
    }
}

// ä»£ç†ç±»
public class ProxyImage implements Image {
    private RealImage realImage;
    private String fileName;
    private static int accessCount = 0;

    public ProxyImage(String fileName) {
        this.fileName = fileName;
    }

    @Override
    public void display() {
        // å»¶è¿Ÿåˆå§‹åŒ–ï¼šåªåœ¨éœ€è¦æ—¶æ‰åˆ›å»ºçœŸå®å¯¹è±¡
        if (realImage == null) {
            realImage = new RealImage(fileName);
        }
        // è®¿é—®æ§åˆ¶ï¼šè®°å½•è®¿é—®æ¬¡æ•°
        accessCount++;
        System.out.println("å›¾ç‰‡è®¿é—®æ¬¡æ•°: " + accessCount);
        // è°ƒç”¨çœŸå®å¯¹è±¡çš„æ–¹æ³•
        realImage.display();
        // åŠŸèƒ½å¢å¼ºï¼šæ·»åŠ é¢å¤–æ“ä½œ
        logDisplayTime();
    }

    private void logDisplayTime() {
        System.out.println("å›¾ç‰‡æ˜¾ç¤ºæ—¶é—´: " + java.time.LocalTime.now());
    }
}

// å®¢æˆ·ç«¯ä»£ç 
public class Client {
    public static void main(String[] args) {
        Image image = new ProxyImage("design_patterns.jpg");

        // ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œä¼šåŠ è½½å›¾ç‰‡
        System.out.println("=== ç¬¬ä¸€æ¬¡è®¿é—® ===");
        image.display();

        // ç¬¬äºŒæ¬¡è®¿é—®ï¼Œä¸ä¼šé‡æ–°åŠ è½½å›¾ç‰‡
        System.out.println("\n=== ç¬¬äºŒæ¬¡è®¿é—® ===");
        image.display();

        // ç¬¬ä¸‰æ¬¡è®¿é—®
        System.out.println("\n=== ç¬¬ä¸‰æ¬¡è®¿é—® ===");
        image.display();
    }
}
```

### 2. JDKåŠ¨æ€ä»£ç†

```java
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;
import java.time.LocalDateTime;

// ä¸šåŠ¡æ¥å£
public interface UserService {
    String getUserById(Long id);
    void updateUser(Long id, String name);
}

// ä¸šåŠ¡å®ç°ç±»
public class UserServiceImpl implements UserService {
    @Override
    public String getUserById(Long id) {
        System.out.println("æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒID: " + id);
        return "User{id=" + id + ", name=\"å¼ ä¸‰\"}";
    }

    @Override
    public void updateUser(Long id, String name) {
        System.out.println("æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼ŒID: " + id + ", æ–°åç§°: " + name);
    }
}

// åŠ¨æ€ä»£ç†å¤„ç†å™¨
public class LoggingInvocationHandler implements InvocationHandler {
    private Object target;

    public LoggingInvocationHandler(Object target) {
        this.target = target;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        // å‰ç½®å¢å¼ºï¼šè®°å½•æ–¹æ³•è°ƒç”¨å‰çš„æ—¥å¿—
        System.out.println("===== æ–¹æ³•è°ƒç”¨å¼€å§‹ ====");
        System.out.println("è°ƒç”¨æ–¹æ³•: " + method.getName());
        System.out.println("è°ƒç”¨æ—¶é—´: " + LocalDateTime.now());
        System.out.println("å‚æ•°åˆ—è¡¨: " + java.util.Arrays.toString(args));

        // è®¡æ—¶å¼€å§‹
        long startTime = System.currentTimeMillis();

        try {
            // è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•
            Object result = method.invoke(target, args);

            // åç½®å¢å¼ºï¼šè®°å½•æ–¹æ³•è°ƒç”¨æˆåŠŸçš„æ—¥å¿—
            System.out.println("è¿”å›ç»“æœ: " + result);
            return result;
        } catch (Exception e) {
            // å¼‚å¸¸å¢å¼ºï¼šè®°å½•æ–¹æ³•è°ƒç”¨å¼‚å¸¸çš„æ—¥å¿—
            System.out.println("æ–¹æ³•è°ƒç”¨å¼‚å¸¸: " + e.getMessage());
            throw e;
        } finally {
            // æœ€ç»ˆå¢å¼ºï¼šè®°å½•æ–¹æ³•è°ƒç”¨è€—æ—¶
            long endTime = System.currentTimeMillis();
            System.out.println("æ–¹æ³•è€—æ—¶: " + (endTime - startTime) + "ms");
            System.out.println("===== æ–¹æ³•è°ƒç”¨ç»“æŸ ====\n");
        }
    }
}

// ä»£ç†å·¥å‚
public class ProxyFactory {
    @SuppressWarnings("unchecked")
    public static <T> T createProxy(T target) {
        return (T) Proxy.newProxyInstance(
            target.getClass().getClassLoader(),
            target.getClass().getInterfaces(),
            new LoggingInvocationHandler(target)
        );
    }
}

// å®¢æˆ·ç«¯ä»£ç 
public class DynamicProxyClient {
    public static void main(String[] args) {
        // åˆ›å»ºç›®æ ‡å¯¹è±¡
        UserService userService = new UserServiceImpl();

        // åˆ›å»ºä»£ç†å¯¹è±¡
        UserService userServiceProxy = ProxyFactory.createProxy(userService);

        // é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•
        String user = userServiceProxy.getUserById(1L);
        userServiceProxy.updateUser(1L, "æå››");
    }
}
```

### 3. CGLIBåŠ¨æ€ä»£ç†

```java
import net.sf.cglib.proxy.Enhancer;
import net.sf.cglib.proxy.MethodInterceptor;
import net.sf.cglib.proxy.MethodProxy;
import java.lang.reflect.Method;
import java.time.LocalDateTime;

// æ²¡æœ‰å®ç°æ¥å£çš„ç›®æ ‡ç±»
public class OrderService {
    public void createOrder(String product, int quantity) {
        System.out.println("åˆ›å»ºè®¢å• - å•†å“: " + product + ", æ•°é‡: " + quantity);
    }

    public double calculatePrice(String product, int quantity) {
        System.out.println("è®¡ç®—ä»·æ ¼ - å•†å“: " + product + ", æ•°é‡: " + quantity);
        return quantity * 99.9;
    }
}

// CGLIBæ–¹æ³•æ‹¦æˆªå™¨
public class CglibLoggingInterceptor implements MethodInterceptor {
    @Override
    public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable {
        // å‰ç½®å¢å¼º
        System.out.println("===== CGLIBä»£ç† - æ–¹æ³•è°ƒç”¨å¼€å§‹ ====");
        System.out.println("è°ƒç”¨æ–¹æ³•: " + method.getName());
        System.out.println("è°ƒç”¨æ—¶é—´: " + LocalDateTime.now());
        System.out.println("å‚æ•°åˆ—è¡¨: " + java.util.Arrays.toString(args));

        // è®¡æ—¶å¼€å§‹
        long startTime = System.currentTimeMillis();

        try {
            // è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•
            Object result = proxy.invokeSuper(obj, args);

            // åç½®å¢å¼º
            System.out.println("è¿”å›ç»“æœ: " + result);
            return result;
        } catch (Exception e) {
            // å¼‚å¸¸å¢å¼º
            System.out.println("æ–¹æ³•è°ƒç”¨å¼‚å¸¸: " + e.getMessage());
            throw e;
        } finally {
            // æœ€ç»ˆå¢å¼º
            long endTime = System.currentTimeMillis();
            System.out.println("æ–¹æ³•è€—æ—¶: " + (endTime - startTime) + "ms");
            System.out.println("===== CGLIBä»£ç† - æ–¹æ³•è°ƒç”¨ç»“æŸ ====\n");
        }
    }
}

// CGLIBä»£ç†å·¥å‚
public class CglibProxyFactory {
    @SuppressWarnings("unchecked")
    public static <T> T createProxy(Class<T> targetClass) {
        Enhancer enhancer = new Enhancer();
        enhancer.setSuperclass(targetClass);
        enhancer.setCallback(new CglibLoggingInterceptor());
        return (T) enhancer.create();
    }
}

// å®¢æˆ·ç«¯ä»£ç 
public class CglibProxyClient {
    public static void main(String[] args) {
        // åˆ›å»ºCGLIBä»£ç†å¯¹è±¡ï¼ˆæ— éœ€ç›®æ ‡ç±»å®ç°æ¥å£ï¼‰
        OrderService orderServiceProxy = CglibProxyFactory.createProxy(OrderService.class);

        // é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•
        orderServiceProxy.createOrder("ç¬”è®°æœ¬ç”µè„‘", 2);
        double price = orderServiceProxy.calculatePrice("ç¬”è®°æœ¬ç”µè„‘", 2);
    }
}
```

## ğŸ” æºç åº”ç”¨

### JDKä¸­çš„ä»£ç†æ¨¡å¼
- **`java.lang.reflect.Proxy`**ï¼šJDKåŠ¨æ€ä»£ç†çš„æ ¸å¿ƒç±»
- **`java.lang.reflect.InvocationHandler`**ï¼šJDKåŠ¨æ€ä»£ç†çš„å›è°ƒæ¥å£
- **`java.rmi.*`**ï¼šè¿œç¨‹æ–¹æ³•è°ƒç”¨ä¸­çš„è¿œç¨‹ä»£ç†å®ç°
- **`javax.ejb.EJBProxy`**ï¼šEJBä¸­çš„è¿œç¨‹ä»£ç†

### Springæ¡†æ¶ä¸­çš„ä»£ç†æ¨¡å¼
- **`org.springframework.aop.framework.ProxyFactoryBean`**ï¼šAOPä»£ç†å·¥å‚
- **`org.springframework.aop.framework.JdkDynamicAopProxy`**ï¼šJDKåŠ¨æ€ä»£ç†å®ç°
- **`org.springframework.aop.framework.CglibAopProxy`**ï¼šCGLIBåŠ¨æ€ä»£ç†å®ç°
- **`org.springframework.transaction.interceptor.TransactionInterceptor`**ï¼šäº‹åŠ¡ä»£ç†
- **`org.springframework.cache.interceptor.CacheInterceptor`**ï¼šç¼“å­˜ä»£ç†
- **`org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor`**ï¼šå®‰å…¨ä»£ç†

```java
// Spring AOPé…ç½®ç¤ºä¾‹
@Configuration
@EnableAspectJAutoProxy
public class AopConfig {
    @Bean
    public LoggingAspect loggingAspect() {
        return new LoggingAspect();
    }
}

// Springå£°æ˜å¼äº‹åŠ¡ï¼ˆåŸºäºä»£ç†æ¨¡å¼ï¼‰
@Service
public class UserServiceImpl implements UserService {
    @Transactional
    public void transferMoney(Long fromId, Long toId, double amount) {
        // ä¸šåŠ¡é€»è¾‘...
    }
}
```

### MyBatisä¸­çš„ä»£ç†æ¨¡å¼
- **`org.apache.ibatis.binding.MapperProxy`**ï¼šMapperæ¥å£çš„åŠ¨æ€ä»£ç†
- **`org.apache.ibatis.session.defaults.DefaultSqlSession.getMapper()`**ï¼šè·å–Mapperä»£ç†å¯¹è±¡

```java
// MyBatis Mapperä»£ç†
SqlSession session = sqlSessionFactory.openSession();
UserMapper userMapper = session.getMapper(UserMapper.class);
User user = userMapper.selectUser(1);
```

### Hibernateä¸­çš„ä»£ç†æ¨¡å¼
- **`org.hibernate.proxy.ProxyFactory`**ï¼šHibernateå®ä½“ä»£ç†å·¥å‚
- **å»¶è¿ŸåŠ è½½æœºåˆ¶**ï¼šé€šè¿‡ä»£ç†å¯¹è±¡å®ç°å…³è”å¯¹è±¡çš„å»¶è¿ŸåŠ è½½

### Spring Bootä¸­çš„ä»£ç†åº”ç”¨
- **`@Async`**ï¼šå¼‚æ­¥æ–¹æ³•è°ƒç”¨ï¼ˆåŸºäºä»£ç†å®ç°ï¼‰
- **`@Retryable`**ï¼šé‡è¯•æœºåˆ¶ï¼ˆåŸºäºä»£ç†å®ç°ï¼‰
- **`@Validated`**ï¼šå‚æ•°æ ¡éªŒï¼ˆåŸºäºä»£ç†å®ç°ï¼‰

### AspectJä¸­çš„ä»£ç†æ¨¡å¼
- AspectJæä¾›äº†æ¯”Spring AOPæ›´å¼ºå¤§çš„ç»‡å…¥èƒ½åŠ›ï¼Œæ”¯æŒç¼–è¯‘æœŸç»‡å…¥å’Œç±»åŠ è½½æœŸç»‡å…¥

### Retrofitä¸­çš„ä»£ç†æ¨¡å¼
- **`retrofit2.Retrofit.create()`**ï¼šä¸ºæ¥å£åˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡

```java
// Retrofitä»£ç†æ¨¡å¼åº”ç”¨
public interface ApiService {
    @GET("users/{id}")
    Call<User> getUser(@Path("id") int id);
}

Retrofit retrofit = new Retrofit.Builder()
    .baseUrl("https://api.example.com/")
    .build();

ApiService apiService = retrofit.create(ApiService.class);
Call<User> call = apiService.getUser(1);
```

### Spring Cloudä¸­çš„ä»£ç†æ¨¡å¼
- **`org.springframework.cloud.netflix.ribbon.RibbonLoadBalancerClient`**ï¼šè´Ÿè½½å‡è¡¡ä»£ç†
- **`org.springframework.cloud.openfeign.FeignClient`**ï¼šå£°æ˜å¼RESTå®¢æˆ·ç«¯ï¼ˆåŸºäºåŠ¨æ€ä»£ç†ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ€§èƒ½å½±å“**ï¼šä»£ç†æ¨¡å¼ä¼šå¢åŠ ä¸€æ¬¡æ–¹æ³•è°ƒç”¨ï¼Œå¯¹æ€§èƒ½æœ‰è½»å¾®å½±å“

2. **è°ƒè¯•å¤æ‚æ€§**ï¼šå¢åŠ äº†è°ƒç”¨å±‚çº§ï¼Œå¯èƒ½ä½¿è°ƒè¯•å˜å¾—å¤æ‚

3. **é™æ€ä»£ç†çš„ç»´æŠ¤æˆæœ¬**ï¼šæ¯ä¸€ä¸ªçœŸå®ä¸»é¢˜ç±»éƒ½éœ€è¦å¯¹åº”ä¸€ä¸ªä»£ç†ç±»ï¼Œå¢åŠ äº†ä»£ç é‡

4. **åŠ¨æ€ä»£ç†çš„å±€é™æ€§**ï¼š
   - JDKåŠ¨æ€ä»£ç†åªèƒ½ä»£ç†å®ç°äº†æ¥å£çš„ç±»
   - CGLIBä¸èƒ½ä»£ç†finalç±»å’Œfinalæ–¹æ³•

5. **äº‹åŠ¡ç®¡ç†é™·é˜±**ï¼šåœ¨åŒä¸€ä¸ªç±»ä¸­è°ƒç”¨äº‹åŠ¡æ–¹æ³•ä¸ä¼šè§¦å‘ä»£ç†ï¼Œå¯¼è‡´äº‹åŠ¡å¤±æ•ˆ

6. **ä»£ç†å¯¹è±¡ä¸çœŸå®å¯¹è±¡çš„åŒºåˆ«**ï¼šä»£ç†å¯¹è±¡æ˜¯ç›®æ ‡å¯¹è±¡çš„å¢å¼ºï¼Œä¸æ˜¯åŒä¸€å¯¹è±¡

7. **åºåˆ—åŒ–é—®é¢˜**ï¼šåŠ¨æ€ä»£ç†å¯¹è±¡å¯èƒ½æ— æ³•æ­£å¸¸åºåˆ—åŒ–

8. **å¼‚å¸¸å¤„ç†**ï¼šä»£ç†ä¸­çš„å¼‚å¸¸å¤„ç†å¯èƒ½ä¼šæ©ç›–åŸå§‹å¼‚å¸¸

9. **è¿‡åº¦ä½¿ç”¨**ï¼šä¸è¦ç›²ç›®ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼Œåªæœ‰åœ¨ç¡®å®éœ€è¦å¢å¼ºæˆ–æ§åˆ¶è®¿é—®æ—¶æ‰ä½¿ç”¨

## ğŸ“ æœ€ä½³å®è·µ

1. **æ¥å£è®¾è®¡**ï¼šä¸ºä»£ç†å¯¹è±¡å’ŒçœŸå®å¯¹è±¡å®šä¹‰å…±åŒçš„æ¥å£ï¼Œéµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™

2. **é€‰æ‹©åˆé€‚çš„ä»£ç†æ–¹å¼**ï¼š
   - éœ€è¦å®ç°æ¥å£ï¼šä¼˜å…ˆä½¿ç”¨JDKåŠ¨æ€ä»£ç†
   - æ— éœ€å®ç°æ¥å£ï¼šä½¿ç”¨CGLIBä»£ç†
   - Spring AOPä¼šè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ä»£ç†æ–¹å¼

3. **èŒè´£å•ä¸€**ï¼šä¸€ä¸ªä»£ç†ç±»åº”è¯¥åªè´Ÿè´£ä¸€ç§å¢å¼ºåŠŸèƒ½

4. **ç»„åˆä½¿ç”¨**ï¼šå¤šä¸ªä»£ç†å¯ä»¥ç»„åˆä½¿ç”¨ï¼Œå½¢æˆä»£ç†é“¾

```java
// ä»£ç†é“¾ç¤ºä¾‹
Object target = new RealSubject();
Object proxy1 = new LoggingProxy(target);
Object proxy2 = new TransactionProxy(proxy1);
Object proxy3 = new SecurityProxy(proxy2);
proxy3.request();
```

5. **ä½¿ç”¨å·¥å‚æ¨¡å¼åˆ›å»ºä»£ç†**ï¼šé€šè¿‡å·¥å‚ç»Ÿä¸€ç®¡ç†ä»£ç†å¯¹è±¡çš„åˆ›å»º

6. **AOPæ›¿ä»£**ï¼šå¯¹äºæ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œä¼˜å…ˆä½¿ç”¨AOPè€Œéæ‰‹åŠ¨åˆ›å»ºä»£ç†

7. **é¿å…åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ä»£ç†å¯¹è±¡**ï¼šå¯èƒ½å¯¼è‡´æœªåˆå§‹åŒ–å®Œæˆçš„å¯¹è±¡è¢«ä½¿ç”¨

8. **æ–‡æ¡£è¯´æ˜**ï¼šæ˜ç¡®æ ‡è®°å“ªäº›ç±»æ˜¯ä»£ç†ç±»ï¼Œä»¥åŠå®ƒä»¬çš„å¢å¼ºåŠŸèƒ½

9. **æµ‹è¯•ä»£ç†è¡Œä¸º**ï¼šå•ç‹¬æµ‹è¯•ä»£ç†çš„å¢å¼ºåŠŸèƒ½ï¼Œç¡®ä¿å…¶æ­£ç¡®æ€§

10. **ä½¿ç”¨æ³¨è§£é©±åŠ¨**ï¼šåœ¨Springä¸­ä¼˜å…ˆä½¿ç”¨æ³¨è§£å¼AOPé…ç½®

## ğŸ“š ç›¸å…³æ¨¡å¼

- **è£…é¥°å™¨æ¨¡å¼**ï¼šä¸¤è€…éƒ½å®ç°äº†å¯¹ç›®æ ‡å¯¹è±¡çš„å¢å¼ºï¼Œä½†è£…é¥°å™¨æ¨¡å¼å…³æ³¨äºåŠ¨æ€æ·»åŠ åŠŸèƒ½ï¼Œè€Œä»£ç†æ¨¡å¼å…³æ³¨äºæ§åˆ¶è®¿é—®
- **é€‚é…å™¨æ¨¡å¼**ï¼šé€‚é…å™¨æ¨¡å¼æ”¹å˜æ¥å£ä»¥åŒ¹é…å®¢æˆ·ç«¯éœ€æ±‚ï¼Œä»£ç†æ¨¡å¼ä¿æŒåŸæ¥å£ä¸å˜
- **å¤–è§‚æ¨¡å¼**ï¼šå¤–è§‚æ¨¡å¼ä¸ºå¤æ‚ç³»ç»Ÿæä¾›ç®€åŒ–æ¥å£ï¼Œä»£ç†æ¨¡å¼ä¸ºå•ä¸ªå¯¹è±¡æä¾›æ§åˆ¶è®¿é—®
- **ç­–ç•¥æ¨¡å¼**ï¼šå¯ä»¥ä¸ä»£ç†æ¨¡å¼ç»“åˆä½¿ç”¨ï¼ŒåŠ¨æ€æ”¹å˜ä»£ç†çš„å¢å¼ºç­–ç•¥
- **å·¥å‚æ–¹æ³•æ¨¡å¼**ï¼šé€šå¸¸ä¸ä»£ç†æ¨¡å¼ç»“åˆä½¿ç”¨ï¼Œåˆ›å»ºä»£ç†å¯¹è±¡
- **å•ä¾‹æ¨¡å¼**ï¼šå¯ä»¥ä¸ä»£ç†æ¨¡å¼ç»“åˆï¼Œå®ç°å»¶è¿Ÿåˆå§‹åŒ–çš„å•ä¾‹
- **è§‚å¯Ÿè€…æ¨¡å¼**ï¼šä»£ç†å¯¹è±¡å¯ä»¥ä½œä¸ºè§‚å¯Ÿè€…ï¼Œç›‘æ§ç›®æ ‡å¯¹è±¡çš„çŠ¶æ€å˜åŒ–
- **æ¨¡æ¿æ–¹æ³•æ¨¡å¼**ï¼šä»£ç†çš„invokeæ–¹æ³•å¯ä»¥å®ç°æ¨¡æ¿æ–¹æ³•æ¨¡å¼

