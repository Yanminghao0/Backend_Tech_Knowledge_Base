# å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰

> ä¸ºå­ç³»ç»Ÿæä¾›ç»Ÿä¸€çš„é«˜å±‚æ¥å£ï¼Œç®€åŒ–å®¢æˆ·ç«¯è°ƒç”¨

---

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯

- **ç±»å‹**: ç»“æ„å‹æ¨¡å¼
- **éš¾åº¦**: â­â­
- **ä½¿ç”¨é¢‘ç‡**: â­â­â­â­
- **å…³é”®è¯**: ç®€åŒ–æ¥å£ã€å­ç³»ç»Ÿå°è£…ã€é™ä½è€¦åˆ

---

## ğŸ¯ æ¨¡å¼æ„å›¾

**æ ¸å¿ƒæ€æƒ³**ï¼šä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªç»Ÿä¸€çš„é«˜å±‚æ¥å£ï¼Œä½¿å¾—å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚å¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚

**è§£å†³çš„é—®é¢˜**ï¼š
- å¦‚ä½•ç®€åŒ–å¤æ‚å­ç³»ç»Ÿçš„ä½¿ç”¨éš¾åº¦
- å¦‚ä½•é™ä½å®¢æˆ·ç«¯ä¸å­ç³»ç»Ÿä¹‹é—´çš„è€¦åˆåº¦
- å¦‚ä½•ä¸ºå¤æ‚å­ç³»ç»Ÿæä¾›ä¸€ä¸ªç»Ÿä¸€çš„è®¿é—®å…¥å£
- å¦‚ä½•éš”ç¦»å®¢æˆ·ç«¯ä¸å­ç³»ç»Ÿçš„ç›´æ¥äº¤äº’

**é€‚ç”¨åœºæ™¯**ï¼š
- ğŸ¢ **å¤æ‚ç³»ç»Ÿ**ï¼šå½“ç³»ç»ŸåŒ…å«å¤šä¸ªå­ç³»ç»Ÿï¼Œä¸”å­ç³»ç»Ÿä¹‹é—´å…³ç³»å¤æ‚æ—¶
- ğŸ§© **APIè®¾è®¡**ï¼šä¸ºåº“æˆ–æ¡†æ¶æä¾›ç®€æ´æ˜“ç”¨çš„APIæ¥å£
- ğŸ”„ **ç‰ˆæœ¬è¿ç§»**ï¼šåœ¨ç³»ç»Ÿå‡çº§æˆ–é‡æ„æ—¶ï¼Œæä¾›å…¼å®¹æ—§ç³»ç»Ÿçš„å¤–è§‚æ¥å£
- ğŸ›¡ï¸ **åˆ†å±‚æ¶æ„**ï¼šåœ¨åˆ†å±‚æ¶æ„ä¸­ï¼Œä¸ºä¸‹å±‚ç»„ä»¶æä¾›ç»Ÿä¸€çš„ä¸Šå±‚è®¿é—®æ¥å£
- ğŸ“± **å®¢æˆ·ç«¯åº”ç”¨**ï¼šç®€åŒ–å®¢æˆ·ç«¯ä¸åå°æœåŠ¡çš„äº¤äº’
- ğŸŒ **å¾®æœåŠ¡ç½‘å…³**ï¼šä½œä¸ºå¾®æœåŠ¡æ¶æ„çš„ç½‘å…³ï¼Œç»Ÿä¸€å¯¹å¤–æä¾›æœåŠ¡

## ğŸ—ï¸ UMLç±»å›¾

```mermaid
classDiagram
    class Facade {
        -subsystemA: SubsystemA
        -subsystemB: SubsystemB
        -subsystemC: SubsystemC
        +Facade()
        +operation()
    }
    class SubsystemA {
        +operationA()
    }
    class SubsystemB {
        +operationB()
    }
    class SubsystemC {
        +operationC()
    }
    class Client {
    }

    Client --> Facade
    Facade --> SubsystemA
    Facade --> SubsystemB
    Facade --> SubsystemC
```

**ç±»å›¾è¯´æ˜**ï¼š
- `Facade`ï¼šå¤–è§‚ç±»ï¼Œæä¾›ç»Ÿä¸€çš„é«˜å±‚æ¥å£ï¼ŒçŸ¥é“å“ªäº›å­ç³»ç»Ÿè´Ÿè´£å¤„ç†è¯·æ±‚
- `Subsystem`ï¼šå­ç³»ç»Ÿç±»ï¼Œå®ç°å­ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œä¸çŸ¥é“å¤–è§‚çš„å­˜åœ¨
- `Client`ï¼šå®¢æˆ·ç«¯ï¼Œé€šè¿‡å¤–è§‚æ¥å£ä¸å­ç³»ç»Ÿäº¤äº’

## ğŸ’» ä»£ç å®ç°

### åŸºç¡€å®ç°

```java
// å­ç³»ç»ŸA
public class SubsystemA {
    public void operationA() {
        System.out.println("æ‰§è¡Œå­ç³»ç»ŸAçš„æ“ä½œ");
    }
}

// å­ç³»ç»ŸB
public class SubsystemB {
    public void operationB() {
        System.out.println("æ‰§è¡Œå­ç³»ç»ŸBçš„æ“ä½œ");
    }
}

// å­ç³»ç»ŸC
public class SubsystemC {
    public void operationC() {
        System.out.println("æ‰§è¡Œå­ç³»ç»ŸCçš„æ“ä½œ");
    }
}

// å¤–è§‚ç±»
public class Facade {
    private SubsystemA subsystemA;
    private SubsystemB subsystemB;
    private SubsystemC subsystemC;

    public Facade() {
        subsystemA = new SubsystemA();
        subsystemB = new SubsystemB();
        subsystemC = new SubsystemC();
    }

    // æä¾›ç®€åŒ–çš„æ¥å£
    public void simpleOperation() {
        System.out.println("å¤–è§‚ç±»åè°ƒå„å­ç³»ç»Ÿæ“ä½œï¼š");
        subsystemA.operationA();
        subsystemB.operationB();
        subsystemC.operationC();
    }

    // å¯ä»¥æä¾›å¤šä¸ªä¸åŒçš„é«˜å±‚æ¥å£
    public void anotherOperation() {
        System.out.println("å¤–è§‚ç±»æä¾›çš„å¦ä¸€ä¸ªæ“ä½œï¼š");
        subsystemB.operationB();
        subsystemC.operationC();
    }
}

// å®¢æˆ·ç«¯ä»£ç 
public class Client {
    public static void main(String[] args) {
        // ä¸ä½¿ç”¨å¤–è§‚æ¨¡å¼ï¼Œå®¢æˆ·ç«¯éœ€è¦ç›´æ¥ä¸å¤šä¸ªå­ç³»ç»Ÿäº¤äº’
        System.out.println("ä¸ä½¿ç”¨å¤–è§‚æ¨¡å¼ï¼š");
        SubsystemA subsystemA = new SubsystemA();
        SubsystemB subsystemB = new SubsystemB();
        SubsystemC subsystemC = new SubsystemC();
        subsystemA.operationA();
        subsystemB.operationB();
        subsystemC.operationC();

        // ä½¿ç”¨å¤–è§‚æ¨¡å¼ï¼Œå®¢æˆ·ç«¯åªéœ€è¦ä¸å¤–è§‚äº¤äº’
        System.out.println("\nä½¿ç”¨å¤–è§‚æ¨¡å¼ï¼š");
        Facade facade = new Facade();
        facade.simpleOperation();
        facade.anotherOperation();
    }
}
```

### å®é™…åº”ç”¨ç¤ºä¾‹ï¼šå®¶åº­å½±é™¢ç³»ç»Ÿ

```java
// å­ç³»ç»Ÿï¼šæŠ•å½±ä»ª
public class Projector {
    public void on() {
        System.out.println("æŠ•å½±ä»ªå¼€å¯");
    }

    public void off() {
        System.out.println("æŠ•å½±ä»ªå…³é—­");
    }

    public void setInput(String input) {
        System.out.println("æŠ•å½±ä»ªè¾“å…¥è®¾ç½®ä¸ºï¼š" + input);
    }

    public void zoom(int level) {
        System.out.println("æŠ•å½±ä»ªå˜ç„¦çº§åˆ«ï¼š" + level);
    }
}

// å­ç³»ç»Ÿï¼šéŸ³å“
public class SoundSystem {
    public void on() {
        System.out.println("éŸ³å“å¼€å¯");
    }

    public void off() {
        System.out.println("éŸ³å“å…³é—­");
    }

    public void setVolume(int volume) {
        System.out.println("éŸ³å“éŸ³é‡è®¾ç½®ä¸ºï¼š" + volume);
    }

    public void setInput(String input) {
        System.out.println("éŸ³å“è¾“å…¥è®¾ç½®ä¸ºï¼š" + input);
    }
}

// å­ç³»ç»Ÿï¼šæ’­æ”¾å™¨
public class Player {
    public void on() {
        System.out.println("æ’­æ”¾å™¨å¼€å¯");
    }

    public void off() {
        System.out.println("æ’­æ”¾å™¨å…³é—­");
    }

    public void play(String media) {
        System.out.println("æ’­æ”¾åª’ä½“ï¼š" + media);
    }

    public void pause() {
        System.out.println("æš‚åœæ’­æ”¾");
    }

    public void stop() {
        System.out.println("åœæ­¢æ’­æ”¾");
    }
}

// å­ç³»ç»Ÿï¼šç¯å…‰
public class Lights {
    public void dim(int level) {
        System.out.println("ç¯å…‰è°ƒæš—è‡³ï¼š" + level + "%");
    }

    public void on() {
        System.out.println("ç¯å…‰å¼€å¯");
    }
}

// å¤–è§‚ç±»ï¼šå®¶åº­å½±é™¢é¥æ§å™¨
public class HomeTheaterFacade {
    private Projector projector;
    private SoundSystem soundSystem;
    private Player player;
    private Lights lights;

    public HomeTheaterFacade(Projector projector, SoundSystem soundSystem, Player player, Lights lights) {
        this.projector = projector;
        this.soundSystem = soundSystem;
        this.player = player;
        this.lights = lights;
    }

    // è§‚çœ‹ç”µå½±æ¨¡å¼
    public void watchMovie(String movie) {
        System.out.println("===== å‡†å¤‡è§‚çœ‹ç”µå½± ====");
        lights.dim(20);
        projector.on();
        projector.setInput("æ’­æ”¾å™¨");
        projector.zoom(10);
        soundSystem.on();
        soundSystem.setInput("æ’­æ”¾å™¨");
        soundSystem.setVolume(80);
        player.on();
        player.play(movie);
        System.out.println("===== ç”µå½±å¼€å§‹æ’­æ”¾ ====");
    }

    // æš‚åœç”µå½±
    public void pauseMovie() {
        System.out.println("===== æš‚åœç”µå½± ====");
        player.pause();
        lights.dim(50);
    }

    // ç»“æŸç”µå½±
    public void endMovie() {
        System.out.println("===== ç»“æŸç”µå½± ====");
        player.stop();
        player.off();
        projector.off();
        soundSystem.off();
        lights.on();
        System.out.println("===== ç”µå½±æ’­æ”¾ç»“æŸ ====");
    }

    // å¬éŸ³ä¹æ¨¡å¼
    public void listenMusic(String music) {
        System.out.println("===== å‡†å¤‡å¬éŸ³ä¹ ====");
        lights.dim(60);
        soundSystem.on();
        soundSystem.setInput("æ’­æ”¾å™¨");
        soundSystem.setVolume(60);
        player.on();
        player.play(music);
        System.out.println("===== éŸ³ä¹å¼€å§‹æ’­æ”¾ ====");
    }
}

// å®¢æˆ·ç«¯ä»£ç 
public class HomeTheaterClient {
    public static void main(String[] args) {
        // åˆ›å»ºå­ç³»ç»Ÿå¯¹è±¡
        Projector projector = new Projector();
        SoundSystem soundSystem = new SoundSystem();
        Player player = new Player();
        Lights lights = new Lights();

        // åˆ›å»ºå¤–è§‚å¯¹è±¡
        HomeTheaterFacade homeTheater = new HomeTheaterFacade(projector, soundSystem, player, lights);

        // è§‚çœ‹ç”µå½±
        homeTheater.watchMovie("æ˜Ÿé™…ç©¿è¶Š");

        // æš‚åœç”µå½±
        homeTheater.pauseMovie();

        // ç»§ç»­è§‚çœ‹åç»“æŸ
        homeTheater.watchMovie("æ˜Ÿé™…ç©¿è¶Š"); // ç®€åŒ–å¤„ç†ï¼Œå®é™…åº”è°ƒç”¨resumeæ–¹æ³•
        homeTheater.endMovie();

        // å¬éŸ³ä¹
        homeTheater.listenMusic("ç»å…¸é’¢ç´æ›²");
    }
}
```

## ğŸ” æºç åº”ç”¨

### Java IO
- **`java.io.File`**ï¼šä½œä¸ºæ–‡ä»¶ç³»ç»Ÿçš„å¤–è§‚ï¼Œç®€åŒ–äº†å¤æ‚çš„æ–‡ä»¶æ“ä½œ
- **`java.nio.file.Paths`** å’Œ **`java.nio.file.Files`**ï¼šä½œä¸ºNIOæ–‡ä»¶ç³»ç»Ÿçš„å¤–è§‚æ¥å£

### Springæ¡†æ¶
- **`org.springframework.context.ApplicationContext`**ï¼šä½œä¸ºSpringå®¹å™¨çš„å¤–è§‚ï¼Œæä¾›äº†å¯¹å¤šä¸ªBeanç®¡ç†å­ç³»ç»Ÿçš„ç»Ÿä¸€è®¿é—®
- **`org.springframework.jdbc.core.JdbcTemplate`**ï¼šä½œä¸ºJDBCæ“ä½œçš„å¤–è§‚ï¼Œç®€åŒ–äº†æ•°æ®åº“è®¿é—®
- **`org.springframework.web.client.RestTemplate`**ï¼šä½œä¸ºRESTå®¢æˆ·ç«¯çš„å¤–è§‚ï¼Œç®€åŒ–äº†HTTPè¯·æ±‚

```java
// Springä¸­çš„å¤–è§‚æ¨¡å¼åº”ç”¨
ApplicationContext context = new ClassPathXmlApplicationContext("applicationContext.xml");
UserService userService = context.getBean(UserService.class);
userService.getUserById(1L);
```

### MyBatis
- **`org.apache.ibatis.session.SqlSession`**ï¼šä½œä¸ºMyBatisæ ¸å¿ƒåŠŸèƒ½çš„å¤–è§‚æ¥å£
- **`org.apache.ibatis.session.SqlSessionFactory`**ï¼šä½œä¸ºSqlSessionåˆ›å»ºçš„å¤–è§‚

### Tomcat
- **`org.apache.catalina.connector.Request`** å’Œ **`Response`**ï¼šä½œä¸ºServlet APIçš„å¤–è§‚å®ç°
- **`org.apache.catalina.startup.Tomcat`**ï¼šä½œä¸ºTomcatæœåŠ¡å™¨çš„å¤–è§‚ç±»

### Slf4j
- **`org.slf4j.LoggerFactory`**ï¼šä½œä¸ºå„ç§æ—¥å¿—æ¡†æ¶çš„å¤–è§‚ï¼Œæä¾›ç»Ÿä¸€çš„æ—¥å¿—æ¥å£

```java
// Slf4jå¤–è§‚æ¨¡å¼åº”ç”¨
Logger logger = LoggerFactory.getLogger(MyClass.class);
logger.info("è¿™æ˜¯ä¸€æ¡æ—¥å¿—æ¶ˆæ¯");
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¤–è§‚æ¥å£è†¨èƒ€**ï¼šé¿å…å°†æ‰€æœ‰å­ç³»ç»ŸåŠŸèƒ½éƒ½æ·»åŠ åˆ°ä¸€ä¸ªå¤–è§‚ç±»ä¸­ï¼Œå¯¼è‡´å¤–è§‚æ¥å£è¿‡äºåºå¤§

2. **è¿‡åº¦å°è£…**ï¼šä¸è¦è¿‡åº¦å°è£…å­ç³»ç»Ÿï¼Œåº”å…è®¸å®¢æˆ·ç«¯åœ¨éœ€è¦æ—¶ç›´æ¥è®¿é—®å­ç³»ç»Ÿ

3. **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªå¤–è§‚ç±»åº”ä¿æŒå•ä¸€èŒè´£ï¼Œåªå°è£…ç‰¹å®šåŠŸèƒ½æˆ–å­ç³»ç»Ÿç»„åˆ

4. **åŒå‘ä¾èµ–**ï¼šé¿å…å¤–è§‚ç±»ä¸å­ç³»ç»Ÿä¹‹é—´å½¢æˆåŒå‘ä¾èµ–

5. **å¤–è§‚é“¾**ï¼šå¤æ‚ç³»ç»Ÿä¸­å¯ä»¥åˆ›å»ºå¤šä¸ªå¤–è§‚ç±»ï¼Œå½¢æˆå¤–è§‚é“¾æˆ–å¤–è§‚å±‚æ¬¡ç»“æ„

6. **ä¸è¦åœ¨å¤–è§‚ä¸­æ·»åŠ ä¸šåŠ¡é€»è¾‘**ï¼šå¤–è§‚åº”ä»…è´Ÿè´£åè°ƒå­ç³»ç»Ÿï¼Œè€Œéæ·»åŠ æ–°çš„ä¸šåŠ¡é€»è¾‘

7. **è€ƒè™‘çº¿ç¨‹å®‰å…¨**ï¼šå¦‚æœå¤šä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶è®¿é—®å¤–è§‚ï¼Œéœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜

## ğŸ“ æœ€ä½³å®è·µ

1. **æœ€å°çŸ¥è¯†åŸåˆ™**ï¼šå®¢æˆ·ç«¯åº”åªçŸ¥é“å¤–è§‚å¯¹è±¡ï¼Œè€Œä¸çŸ¥é“å­ç³»ç»Ÿçš„å­˜åœ¨

2. **åˆ†å±‚å¤–è§‚**ï¼šå¯¹äºå¤§å‹ç³»ç»Ÿï¼Œå¯ä»¥ä¸ºä¸åŒå±‚æ¬¡åˆ›å»ºä¸åŒçš„å¤–è§‚ç±»

```java
// æ•°æ®è®¿é—®å±‚å¤–è§‚
public class DataAccessFacade { ... }

// ä¸šåŠ¡é€»è¾‘å±‚å¤–è§‚
public class BusinessLogicFacade { ... }

// è¡¨ç¤ºå±‚å¤–è§‚
public class PresentationFacade { ... }
```

3. **é»˜è®¤å¤–è§‚**ï¼šä¸ºæœ€å¸¸ç”¨çš„å­ç³»ç»Ÿç»„åˆæä¾›é»˜è®¤å¤–è§‚å®ç°

4. **å¯é…ç½®å¤–è§‚**ï¼šå…è®¸å®¢æˆ·ç«¯é€šè¿‡é…ç½®é€‰æ‹©ä¸åŒçš„å­ç³»ç»Ÿå®ç°

5. **æŠ½è±¡å¤–è§‚**ï¼šä¸ºå¤–è§‚ç±»å®šä¹‰æŠ½è±¡æ¥å£ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ—¶æ›¿æ¢ä¸åŒçš„å¤–è§‚å®ç°

```java
public interface Facade {
    void operation();
}

public class ConcreteFacade1 implements Facade {
    // å®ç°1
}

public class ConcreteFacade2 implements Facade {
    // å®ç°2
}
```

6. **å»¶è¿Ÿåˆå§‹åŒ–**ï¼šåœ¨å¤–è§‚ç±»ä¸­å»¶è¿Ÿåˆå§‹åŒ–å­ç³»ç»Ÿå¯¹è±¡ï¼Œæé«˜æ€§èƒ½

```java
public class LazyFacade {
    private Subsystem subsystem;

    public void operation() {
        if (subsystem == null) {
            subsystem = new Subsystem(); // å»¶è¿Ÿåˆå§‹åŒ–
        }
        subsystem.operation();
    }
}
```

7. **ä¸è¦æ»¥ç”¨å¤–è§‚**ï¼šåªæœ‰å½“å­ç³»ç»Ÿç¡®å®å¤æ‚ä¸”ä½¿ç”¨é¢‘ç¹æ—¶æ‰ä½¿ç”¨å¤–è§‚æ¨¡å¼

## ğŸ“š ç›¸å…³æ¨¡å¼

- **å•ä¾‹æ¨¡å¼**ï¼šå¤–è§‚ç±»é€šå¸¸è®¾è®¡ä¸ºå•ä¾‹ï¼Œç¡®ä¿å…¨å±€åªæœ‰ä¸€ä¸ªå¤–è§‚å®ä¾‹
- **ä¸­ä»‹è€…æ¨¡å¼**ï¼šå¤–è§‚æ¨¡å¼å…³æ³¨äºç®€åŒ–å­ç³»ç»Ÿè®¿é—®ï¼Œè€Œä¸­ä»‹è€…æ¨¡å¼å…³æ³¨äºåè°ƒå­ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡
- **ä»£ç†æ¨¡å¼**ï¼šå¤–è§‚æ¨¡å¼ä¸ºå­ç³»ç»Ÿæä¾›ç»Ÿä¸€æ¥å£ï¼Œè€Œä»£ç†æ¨¡å¼ä¸ºå•ä¸ªå¯¹è±¡æä¾›æ›¿ä»£è®¿é—®
- **é€‚é…å™¨æ¨¡å¼**ï¼šå¤–è§‚æ¨¡å¼ä¸ºç®€åŒ–æ¥å£è€Œè®¾è®¡ï¼Œé€‚é…å™¨æ¨¡å¼ä¸ºæ¥å£è½¬æ¢è€Œè®¾è®¡
- **æŠ½è±¡å·¥å‚æ¨¡å¼**ï¼šå¯ä»¥ä¸å¤–è§‚æ¨¡å¼ç»“åˆä½¿ç”¨ï¼Œç”±æŠ½è±¡å·¥å‚åˆ›å»ºå­ç³»ç»Ÿå¯¹è±¡
- **ç»„åˆæ¨¡å¼**ï¼šå¤–è§‚æ¨¡å¼ä¸ç»„åˆæ¨¡å¼éƒ½å¯ä»¥ç®€åŒ–å®¢æˆ·ç«¯æ“ä½œï¼Œä½†å±‚æ¬¡ç»“æ„ä¸åŒ

