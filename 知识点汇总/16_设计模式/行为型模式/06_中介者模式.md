## ä¸­ä»‹è€…æ¨¡å¼ (Mediator Pattern)

### æ¦‚è¿°
ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰å®šä¹‰äº†ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œä½¿åŸæœ‰å¯¹è±¡ä¹‹é—´çš„è€¦åˆæ¾æ•£ï¼Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ï¼Œå®ƒé€šè¿‡å¼•å…¥ä¸­ä»‹è€…å¯¹è±¡ï¼Œå°†ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»è½¬å˜ä¸ºä¸€å¯¹å¤šå…³ç³»ï¼Œä»è€Œé™ä½ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚

## ğŸ¯ æ¨¡å¼æ„å›¾

**æ ¸å¿ƒæ€æƒ³**ï¼šç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚

**è§£å†³çš„é—®é¢˜**ï¼š
- å¦‚ä½•è§£å†³å¯¹è±¡ä¹‹é—´å¤æ‚çš„ç›¸äº’ä¾èµ–å…³ç³»
- å¦‚ä½•å‡å°‘å¯¹è±¡ä¹‹é—´çš„ç›´æ¥é€šä¿¡
- å¦‚ä½•ç®€åŒ–å¯¹è±¡ä¹‹é—´çš„äº¤äº’é€»è¾‘
- å¦‚ä½•é›†ä¸­æ§åˆ¶å¯¹è±¡ä¹‹é—´çš„äº¤äº’

**é€‚ç”¨åœºæ™¯**ï¼š
- ğŸ•¸ï¸ **å¯¹è±¡é—´å­˜åœ¨å¤æ‚äº¤äº’**ï¼šç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤æ‚çš„å¼•ç”¨å…³ç³»ï¼Œäº§ç”Ÿçš„ç›¸äº’ä¾èµ–å…³ç³»ç»“æ„æ··ä¹±ä¸”éš¾ä»¥ç†è§£
- ğŸ’» **GUIç»„ä»¶é€šä¿¡**ï¼šå¦‚çª—å£ã€æŒ‰é’®ã€æ–‡æœ¬æ¡†ç­‰ç»„ä»¶ä¹‹é—´çš„äº¤äº’
- ğŸ“± **èŠå¤©ç³»ç»Ÿ**ï¼šç”¨æˆ·ä¹‹é—´é€šè¿‡æœåŠ¡å™¨è¿›è¡Œæ¶ˆæ¯è½¬å‘
- ğŸ¦ **é“¶è¡Œäº¤æ˜“ç³»ç»Ÿ**ï¼šä¸åŒè´¦æˆ·ä¹‹é—´çš„è½¬è´¦éœ€è¦é€šè¿‡é“¶è¡Œç³»ç»Ÿä¸­ä»‹
- ğŸ® **æ¸¸æˆå¼€å‘**ï¼šæ¸¸æˆå¯¹è±¡ä¹‹é—´çš„äº¤äº’ç®¡ç†
- ğŸš¦ **äº¤é€šæ§åˆ¶ç³»ç»Ÿ**ï¼šé£æœºã€ç«è½¦ç­‰äº¤é€šå·¥å…·çš„è°ƒåº¦
- ğŸ¢ **éƒ¨é—¨åä½œ**ï¼šä¼ä¸šä¸­ä¸åŒéƒ¨é—¨ä¹‹é—´é€šè¿‡ç»ç†è¿›è¡Œåè°ƒ
- ğŸ“Š **å¾®æœåŠ¡æ¶æ„**ï¼šæœåŠ¡ä¹‹é—´é€šè¿‡APIç½‘å…³è¿›è¡Œé€šä¿¡

## ğŸ—ï¸ UMLç±»å›¾

```mermaid
classDiagram
    class Mediator {
        <<interface>>
        +send(message: String, colleague: Colleague): void
    }
    class ConcreteMediator {
        -colleague1: Colleague
        -colleague2: Colleague
        -colleague3: Colleague
        +send(message: String, colleague: Colleague): void
        +setColleague1(colleague: Colleague): void
        +setColleague2(colleague: Colleague): void
        +setColleague3(colleague: Colleague): void
    }
    class Colleague {
        <<abstract>>
        -mediator: Mediator
        +Colleague(mediator: Mediator)
        +send(message: String): void
        +receive(message: String): void
    }
    class ConcreteColleague1 {
        +receive(message: String): void
    }
    class ConcreteColleague2 {
        +receive(message: String): void
    }
    class ConcreteColleague3 {
        +receive(message: String): void
    }
    class Client {
    }

    Mediator <|-- ConcreteMediator
    Colleague <|-- ConcreteColleague1
    Colleague <|-- ConcreteColleague2
    Colleague <|-- ConcreteColleague3
    ConcreteMediator --> Colleague : colleagues
    Colleague --> Mediator : mediator
    Client --> Mediator
    Client --> Colleague
```

**æ ¸å¿ƒè§’è‰²**ï¼š
- **Mediatorï¼ˆæŠ½è±¡ä¸­ä»‹è€…ï¼‰**ï¼šå®šä¹‰ä¸­ä»‹è€…æ¥å£ï¼Œå£°æ˜äº†ç”¨äºä¸å„åŒäº‹å¯¹è±¡é€šä¿¡çš„æ–¹æ³•
- **ConcreteMediatorï¼ˆå…·ä½“ä¸­ä»‹è€…ï¼‰**ï¼šå®ç°æŠ½è±¡ä¸­ä»‹è€…æ¥å£ï¼Œåè°ƒå„ä¸ªåŒäº‹å¯¹è±¡æ¥å®ç°åä½œè¡Œä¸ºï¼Œäº†è§£å¹¶ç»´æŠ¤å®ƒçš„å„ä¸ªåŒäº‹
- **Colleagueï¼ˆæŠ½è±¡åŒäº‹ç±»ï¼‰**ï¼šå®šä¹‰åŒäº‹ç±»çš„æ¥å£ï¼Œä¿å­˜ä¸­ä»‹è€…å¯¹è±¡ï¼Œæä¾›åŒäº‹å¯¹è±¡äº¤äº’çš„æŠ½è±¡æ–¹æ³•
- **ConcreteColleagueï¼ˆå…·ä½“åŒäº‹ç±»ï¼‰**ï¼šå®ç°æŠ½è±¡åŒäº‹ç±»ï¼Œå½“éœ€è¦ä¸å…¶ä»–åŒäº‹é€šä¿¡æ—¶ï¼Œé€šè¿‡ä¸­ä»‹è€…å¯¹è±¡è¿›è¡Œ
- **Clientï¼ˆå®¢æˆ·ç«¯ï¼‰**ï¼šåˆ›å»ºä¸­ä»‹è€…å¯¹è±¡å¹¶è®¾ç½®åŒäº‹å¯¹è±¡ä¹‹é—´çš„å…³è”

**ä¸­ä»‹è€…æ¨¡å¼å˜ä½“**ï¼š
1. **Facade-Mediatoræ··åˆ**ï¼šå…¼å…·å¤–è§‚æ¨¡å¼å’Œä¸­ä»‹è€…æ¨¡å¼çš„ç‰¹ç‚¹
2. **Mediator-Singleton**ï¼šä¸­ä»‹è€…å®ç°ä¸ºå•ä¾‹æ¨¡å¼
3. **Event-Based Mediator**ï¼šåŸºäºäº‹ä»¶çš„ä¸­ä»‹è€…å®ç°
4. **Chat Room Mediator**ï¼šèŠå¤©å®¤æ¨¡å¼ï¼Œå…è®¸å¤šä¸ªåŒäº‹é€šè¿‡ä¸­ä»‹è€…äº¤æµ
5. **Broker Mediator**ï¼šç»çºªäººæ¨¡å¼ï¼Œè´Ÿè´£åè°ƒåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¯¹è±¡

## ğŸ’» ä»£ç å®ç°

### 1. åŸºç¡€å®ç°ï¼ˆèŠå¤©å®¤ä¸­ä»‹è€…ï¼‰

```java
// æŠ½è±¡ä¸­ä»‹è€…
public interface Mediator {
    void send(String message, Colleague colleague);
}

// æŠ½è±¡åŒäº‹ç±»
public abstract class Colleague {
    protected Mediator mediator;
    protected String name;

    public Colleague(Mediator mediator, String name) {
        this.mediator = mediator;
        this.name = name;
    }

    public void send(String message) {
        System.out.println(name + " å‘é€: " + message);
        mediator.send(message, this);
    }

    public abstract void receive(String message);
}

// å…·ä½“ä¸­ä»‹è€… - èŠå¤©å®¤
public class ChatRoomMediator implements Mediator {
    private List<Colleague> colleagues = new ArrayList<>();

    public void addColleague(Colleague colleague) {
        colleagues.add(colleague);
    }

    @Override
    public void send(String message, Colleague sender) {
        for (Colleague colleague : colleagues) {
            // ä¸å‘é€ç»™è‡ªå·±
            if (colleague != sender) {
                colleague.receive(message);
            }
        }
    }
}

// å…·ä½“åŒäº‹ç±» - ç”¨æˆ·
public class UserColleague extends Colleague {
    public UserColleague(Mediator mediator, String name) {
        super(mediator, name);
    }

    @Override
    public void receive(String message) {
        System.out.println(name + " æ¥æ”¶: " + message);
    }
}

// å®¢æˆ·ç«¯ä»£ç 
public class Client {
    public static void main(String[] args) {
        // åˆ›å»ºä¸­ä»‹è€…
        Mediator chatRoom = new ChatRoomMediator();

        // åˆ›å»ºåŒäº‹
        Colleague alice = new UserColleague(chatRoom, "Alice");
        Colleague bob = new UserColleague(chatRoom, "Bob");
        Colleague charlie = new UserColleague(chatRoom, "Charlie");

        // å°†åŒäº‹åŠ å…¥ä¸­ä»‹è€…
        ((ChatRoomMediator) chatRoom).addColleague(alice);
        ((ChatRoomMediator) chatRoom).addColleague(bob);
        ((ChatRoomMediator) chatRoom).addColleague(charlie);

        // å‘é€æ¶ˆæ¯
        System.out.println("===== èŠå¤©å¼€å§‹ =====");
        alice.send("å¤§å®¶å¥½!");
        System.out.println();
        bob.send("æ¬¢è¿åŠ å…¥èŠå¤©å®¤!");
        System.out.println();
        charlie.send("å¾ˆé«˜å…´è®¤è¯†å¤§å®¶!");
    }
}
```

### 2. é«˜çº§å®ç°ï¼ˆæ™ºèƒ½å®¶å±…æ§åˆ¶ç³»ç»Ÿï¼‰

```java
// è®¾å¤‡ç±»å‹æšä¸¾
public enum DeviceType {
    LIGHT, TV, AIR_CONDITIONER, SPEAKER
}

// æŠ½è±¡ä¸­ä»‹è€… - æ™ºèƒ½å®¶å±…ä¸­å¿ƒ
public interface SmartHomeMediator {
    void registerDevice(Device device);
    void sendCommand(Command command, Device sender);
    void deviceStatusChanged(Device device, boolean status);
}

// å…·ä½“ä¸­ä»‹è€… - æ™ºèƒ½å®¶å±…æ§åˆ¶ä¸­å¿ƒ
public class SmartHomeControlCenter implements SmartHomeMediator {
    private Map<DeviceType, List<Device>> devices = new HashMap<>();
    private Map<String, Device> deviceMap = new HashMap<>();

    @Override
    public void registerDevice(Device device) {
        DeviceType type = device.getType();
        devices.computeIfAbsent(type, k -> new ArrayList<>()).add(device);
        deviceMap.put(device.getId(), device);
        System.out.println("è®¾å¤‡æ³¨å†Œ: " + device.getName() + " (" + type + ")");
    }

    @Override
    public void sendCommand(Command command, Device sender) {
        System.out.println("\n[æ§åˆ¶ä¸­å¿ƒ] æ”¶åˆ°æ¥è‡ª " + sender.getName() + " çš„å‘½ä»¤: " + command);

        switch (command.getType()) {
            case TURN_ON:
                executeTurnOnCommand(command.getTargetDeviceId());
                break;
            case TURN_OFF:
                executeTurnOffCommand(command.getTargetDeviceId());
                break;
            case ADJUST:
                executeAdjustCommand(command.getTargetDeviceId(), command.getValue());
                break;
            case SCENE:
                executeSceneCommand(command.getValue());
                break;
            default:
                System.out.println("ä¸æ”¯æŒçš„å‘½ä»¤ç±»å‹: " + command.getType());
        }
    }

    @Override
    public void deviceStatusChanged(Device device, boolean status) {
        System.out.println("\n[æ§åˆ¶ä¸­å¿ƒ] è®¾å¤‡çŠ¶æ€å˜åŒ–: " + device.getName() + " - " + (status ? "å¼€å¯" : "å…³é—­"));

        // è‡ªåŠ¨åŒ–åœºæ™¯é€»è¾‘
        if (device.getType() == DeviceType.LIGHT && !status) {
            // å¦‚æœç¯å…‰å…³é—­ï¼Œè‡ªåŠ¨å…³é—­ç”µè§†å’ŒéŸ³å“
            turnOffDevices(DeviceType.TV);
            turnOffDevices(DeviceType.SPEAKER);
        } else if (device.getType() == DeviceType.TV && status) {
            // å¦‚æœç”µè§†å¼€å¯ï¼Œè‡ªåŠ¨å…³é—­ç¯å…‰å¹¶æ‰“å¼€ç©ºè°ƒ
            turnOffDevices(DeviceType.LIGHT);
            turnOnDevices(DeviceType.AIR_CONDITIONER);
        }
    }

    private void executeTurnOnCommand(String deviceId) {
        Device device = deviceMap.get(deviceId);
        if (device != null) {
            device.turnOn();
        } else {
            System.out.println("è®¾å¤‡ä¸å­˜åœ¨: " + deviceId);
        }
    }

    private void executeTurnOffCommand(String deviceId) {
        Device device = deviceMap.get(deviceId);
        if (device != null) {
            device.turnOff();
        } else {
            System.out.println("è®¾å¤‡ä¸å­˜åœ¨: " + deviceId);
        }
    }

    private void executeAdjustCommand(String deviceId, String value) {
        Device device = deviceMap.get(deviceId);
        if (device != null && device instanceof AdjustableDevice) {
            ((AdjustableDevice) device).adjust(value);
        } else {
            System.out.println("è®¾å¤‡ä¸æ”¯æŒè°ƒèŠ‚æˆ–ä¸å­˜åœ¨: " + deviceId);
        }
    }

    private void executeSceneCommand(String sceneName) {
        System.out.println("æ‰§è¡Œåœºæ™¯: " + sceneName);

        switch (sceneName.toLowerCase()) {
            case "ç”µå½±æ¨¡å¼":
                turnOffDevices(DeviceType.LIGHT);
                turnOnDevices(DeviceType.TV);
                turnOnDevices(DeviceType.SPEAKER);
                adjustDevices(DeviceType.AIR_CONDITIONER, "24");
                break;
            case "ç¡çœ æ¨¡å¼":
                turnOffDevices(DeviceType.TV);
                turnOffDevices(DeviceType.SPEAKER);
                turnOnDevices(DeviceType.LIGHT);
                adjustDevices(DeviceType.AIR_CONDITIONER, "26");
                break;
            case "ç¦»å®¶æ¨¡å¼":
                turnOffAllDevices();
                break;
            default:
                System.out.println("ä¸æ”¯æŒçš„åœºæ™¯: " + sceneName);
        }
    }

    private void turnOnDevices(DeviceType type) {
        List<Device> deviceList = devices.getOrDefault(type, Collections.emptyList());
        deviceList.forEach(Device::turnOn);
    }

    private void turnOffDevices(DeviceType type) {
        List<Device> deviceList = devices.getOrDefault(type, Collections.emptyList());
        deviceList.forEach(Device::turnOff);
    }

    private void adjustDevices(DeviceType type, String value) {
        List<Device> deviceList = devices.getOrDefault(type, Collections.emptyList());
        deviceList.stream()
            .filter(d -> d instanceof AdjustableDevice)
            .forEach(d -> ((AdjustableDevice) d).adjust(value));
    }

    private void turnOffAllDevices() {
        devices.values().forEach(list -> list.forEach(Device::turnOff));
    }
}

// å‘½ä»¤ç±»
public class Command {
    private CommandType type;
    private String targetDeviceId;
    private String value;

    // æ„é€ å™¨ã€getterå’Œsetter
    public Command(CommandType type, String targetDeviceId, String value) {
        this.type = type;
        this.targetDeviceId = targetDeviceId;
        this.value = value;
    }

    // Getters
    public CommandType getType() { return type; }
    public String getTargetDeviceId() { return targetDeviceId; }
    public String getValue() { return value; }
}

// å‘½ä»¤ç±»å‹æšä¸¾
public enum CommandType {
    TURN_ON, TURN_OFF, ADJUST, SCENE
}

// æŠ½è±¡åŒäº‹ç±» - è®¾å¤‡
public abstract class Device {
    protected SmartHomeMediator mediator;
    protected String id;
    protected String name;
    protected DeviceType type;
    protected boolean status;

    public Device(SmartHomeMediator mediator, String id, String name, DeviceType type) {
        this.mediator = mediator;
        this.id = id;
        this.name = name;
        this.type = type;
        this.status = false;
    }

    public void turnOn() {
        if (!status) {
            status = true;
            System.out.println(name + " å·²å¼€å¯");
            mediator.deviceStatusChanged(this, true);
        } else {
            System.out.println(name + " å·²ç»æ˜¯å¼€å¯çŠ¶æ€");
        }
    }

    public void turnOff() {
        if (status) {
            status = false;
            System.out.println(name + " å·²å…³é—­");
            mediator.deviceStatusChanged(this, false);
        } else {
            System.out.println(name + " å·²ç»æ˜¯å…³é—­çŠ¶æ€");
        }
    }

    public void sendCommand(Command command) {
        mediator.sendCommand(command, this);
    }

    // Getters
    public String getId() { return id; }
    public String getName() { return name; }
    public DeviceType getType() { return type; }
    public boolean isStatus() { return status; }
}

// å¯è°ƒèŠ‚è®¾å¤‡æ¥å£
public interface AdjustableDevice {
    void adjust(String value);
}

// å…·ä½“è®¾å¤‡ - æ™ºèƒ½ç¯
public class SmartLight extends Device {
    private int brightness = 100;
    private String color = "white";

    public SmartLight(SmartHomeMediator mediator, String id, String name) {
        super(mediator, id, name, DeviceType.LIGHT);
    }

    @Override
    public void turnOn() {
        super.turnOn();
        System.out.println("äº®åº¦: " + brightness + ", é¢œè‰²: " + color);
    }

    public void setBrightness(int brightness) {
        this.brightness = Math.max(0, Math.min(100, brightness));
        if (status) {
            System.out.println(name + " äº®åº¦å·²è°ƒæ•´ä¸º: " + this.brightness);
        }
    }

    public void setColor(String color) {
        this.color = color;
        if (status) {
            System.out.println(name + " é¢œè‰²å·²è°ƒæ•´ä¸º: " + this.color);
        }
    }
}

// å…·ä½“è®¾å¤‡ - æ™ºèƒ½ç”µè§†
public class SmartTV extends Device implements AdjustableDevice {
    private int volume = 50;
    private String channel = "CCTV-1";

    public SmartTV(SmartHomeMediator mediator, String id, String name) {
        super(mediator, id, name, DeviceType.TV);
    }

    @Override
    public void turnOn() {
        super.turnOn();
        System.out.println("é¢‘é“: " + channel + ", éŸ³é‡: " + volume);
    }

    public void changeChannel(String channel) {
        this.channel = channel;
        if (status) {
            System.out.println(name + " é¢‘é“å·²åˆ‡æ¢ä¸º: " + this.channel);
        }
    }

    public void setVolume(int volume) {
        this.volume = Math.max(0, Math.min(100, volume));
        if (status) {
            System.out.println(name + " éŸ³é‡å·²è°ƒæ•´ä¸º: " + this.volume);
        }
    }

    @Override
    public void adjust(String value) {
        try {
            int numValue = Integer.parseInt(value);
            setVolume(numValue);
        } catch (NumberFormatException e) {
            changeChannel(value);
        }
    }
}

// å…·ä½“è®¾å¤‡ - æ™ºèƒ½ç©ºè°ƒ
public class SmartAirConditioner extends Device implements AdjustableDevice {
    private int temperature = 26;
    private String mode = "auto";

    public SmartAirConditioner(SmartHomeMediator mediator, String id, String name) {
        super(mediator, id, name, DeviceType.AIR_CONDITIONER);
    }

    @Override
    public void turnOn() {
        super.turnOn();
        System.out.println("æ¸©åº¦: " + temperature + "Â°C, æ¨¡å¼: " + mode);
    }

    public void setTemperature(int temperature) {
        this.temperature = Math.max(16, Math.min(30, temperature));
        if (status) {
            System.out.println(name + " æ¸©åº¦å·²è°ƒæ•´ä¸º: " + this.temperature + "Â°C");
        }
    }

    public void setMode(String mode) {
        this.mode = mode;
        if (status) {
            System.out.println(name + " æ¨¡å¼å·²åˆ‡æ¢ä¸º: " + this.mode);
        }
    }

    @Override
    public void adjust(String value) {
        try {
            int temp = Integer.parseInt(value);
            setTemperature(temp);
        } catch (NumberFormatException e) {
            setMode(value);
        }
    }
}

// æ™ºèƒ½å®¶å±…å®¢æˆ·ç«¯
public class SmartHomeClient {
    public static void main(String[] args) {
        // åˆ›å»ºä¸­ä»‹è€… - æ™ºèƒ½å®¶å±…æ§åˆ¶ä¸­å¿ƒ
        SmartHomeMediator mediator = new SmartHomeControlCenter();

        // åˆ›å»ºè®¾å¤‡
        Device livingRoomLight = new SmartLight(mediator, "light-001", "å®¢å…ç¯å…‰");
        Device bedroomLight = new SmartLight(mediator, "light-002", "å§å®¤ç¯å…‰");
        Device tv = new SmartTV(mediator, "tv-001", "å®¢å…ç”µè§†");
        Device ac = new SmartAirConditioner(mediator, "ac-001", "å®¢å…ç©ºè°ƒ");

        // æ³¨å†Œè®¾å¤‡åˆ°ä¸­ä»‹è€…
        mediator.registerDevice(livingRoomLight);
        mediator.registerDevice(bedroomLight);
        mediator.registerDevice(tv);
        mediator.registerDevice(ac);

        System.out.println("\n===== å¼€å¯ç”µè§† =====");
        tv.turnOn();

        System.out.println("\n===== è°ƒæ•´ç©ºè°ƒæ¸©åº¦ =====");
        ac.sendCommand(new Command(CommandType.ADJUST, "ac-001", "24"));

        System.out.println("\n===== æ‰§è¡Œç”µå½±æ¨¡å¼ =====");
        tv.sendCommand(new Command(CommandType.SCENE, null, "ç”µå½±æ¨¡å¼"));

        System.out.println("\n===== å…³é—­ç¯å…‰ =====");
        livingRoomLight.turnOff();
    }
}
```

## ğŸ” æºç åº”ç”¨

### Javaä¸­çš„ä¸­ä»‹è€…æ¨¡å¼
- **`java.util.Timer`**ï¼šè°ƒåº¦å¤šä¸ªå®šæ—¶ä»»åŠ¡
- **`java.awt.EventQueue`**ï¼šAWTäº‹ä»¶åˆ†å‘çº¿ç¨‹
- **`java.util.concurrent.Executor`**ï¼šçº¿ç¨‹æ± ç®¡ç†å¤šä¸ªä»»åŠ¡æ‰§è¡Œ
- **`javax.swing.DefaultButtonModel`**ï¼šSwingç»„ä»¶æ¨¡å‹
- **`java.beans.PropertyChangeSupport`**ï¼šJavaBeanå±æ€§å˜æ›´æ”¯æŒ

```java
// Java PropertyChangeSupportç¤ºä¾‹ï¼ˆä¸­ä»‹è€…æ¨¡å¼åº”ç”¨ï¼‰
public class PropertyChangeExample {
    public static class User implements PropertyChangeListener {
        private String name;

        @Override
        public void propertyChange(PropertyChangeEvent evt) {
            System.out.println("ç”¨æˆ·æ”¶åˆ°å±æ€§å˜æ›´é€šçŸ¥: " + evt.getPropertyName() + ": " + evt.getNewValue());
            this.name = (String) evt.getNewValue();
        }
    }

    public static class UserService {
        private PropertyChangeSupport support = new PropertyChangeSupport(this);
        private String userName;

        public void addPropertyChangeListener(PropertyChangeListener listener) {
            support.addPropertyChangeListener(listener);
        }

        public void setUserName(String userName) {
            String oldValue = this.userName;
            this.userName = userName;
            support.firePropertyChange("userName", oldValue, userName);
        }
    }

    public static void main(String[] args) {
        UserService service = new UserService();
        User user = new User();

        // æ³¨å†Œç›‘å¬å™¨ï¼ˆä¸­ä»‹è€…æ¨¡å¼ä¸­çš„åŒäº‹æ³¨å†Œï¼‰
        service.addPropertyChangeListener(user);

        // è®¾ç½®å±æ€§ï¼Œè§¦å‘é€šçŸ¥
        service.setUserName("å¼ ä¸‰");
        service.setUserName("æå››");
    }
}
```

### Springæ¡†æ¶ä¸­çš„åº”ç”¨
- **`org.springframework.context.ApplicationContext`**ï¼šSpringå®¹å™¨ä½œä¸ºä¸­ä»‹è€…åè°ƒBeanä¹‹é—´çš„ä¾èµ–å…³ç³»
- **`org.springframework.messaging.MessageChannel`**ï¼šæ¶ˆæ¯é€šé“ä½œä¸ºä¸­ä»‹è€…ä¼ é€’æ¶ˆæ¯
- **`org.springframework.web.servlet.DispatcherServlet`**ï¼šSpring MVCä¸­çš„å‰ç«¯æ§åˆ¶å™¨ï¼Œä½œä¸ºä¸­ä»‹è€…åè°ƒè¯·æ±‚å¤„ç†æµç¨‹
- **`org.springframework.cloud.netflix.zuul.ZuulFilter`**ï¼šAPIç½‘å…³ä½œä¸ºæœåŠ¡ä¹‹é—´çš„ä¸­ä»‹è€…
- **`org.springframework.amqp.rabbit.core.RabbitTemplate`**ï¼šæ¶ˆæ¯é˜Ÿåˆ—æ¨¡æ¿ä½œä¸ºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„ä¸­ä»‹è€…

```java
// Spring DispatcherServletå·¥ä½œæµç¨‹ï¼ˆä¸­ä»‹è€…æ¨¡å¼åº”ç”¨ï¼‰
/*
DispatcherServletä½œä¸ºå‰ç«¯æ§åˆ¶å™¨ï¼Œåè°ƒä»¥ä¸‹ç»„ä»¶ï¼š
1. HandlerMapping - æ˜ å°„è¯·æ±‚åˆ°å¤„ç†å™¨
2. HandlerAdapter - é€‚é…å¤„ç†å™¨æ‰§è¡Œ
3. HandlerExceptionResolver - å¤„ç†å¼‚å¸¸
4. ViewResolver - è§£æè§†å›¾
5. RequestToViewNameTranslator - è½¬æ¢è¯·æ±‚åˆ°è§†å›¾å
6. LocaleResolver - è§£ææœ¬åœ°åŒ–ä¿¡æ¯
7. ThemeResolver - è§£æä¸»é¢˜
8. MultipartResolver - å¤„ç†æ–‡ä»¶ä¸Šä¼ 
*/

// Spring Cloud Zuulä½œä¸ºAPIç½‘å…³ï¼ˆä¸­ä»‹è€…æ¨¡å¼åº”ç”¨ï¼‰
@SpringBootApplication
@EnableZuulProxy
public class ZuulGatewayApplication {
    public static void main(String[] args) {
        SpringApplication.run(ZuulGatewayApplication.class, args);
    }
}

// é…ç½®æ–‡ä»¶ application.yml
/*
zuul:
  routes:
    user-service:
      path: /user/**
      serviceId: user-service
    order-service:
      path: /order/**
      serviceId: order-service
    product-service:
      path: /product/**
      serviceId: product-service
*/
```

### å…¶ä»–æ¡†æ¶ä¸­çš„åº”ç”¨
- **Apache Camel**ï¼šä¼ä¸šé›†æˆæ¨¡å¼æ¡†æ¶ï¼Œè·¯ç”±ä½œä¸ºä¸­ä»‹è€…
- **Spring Cloud Gateway**ï¼šå¾®æœåŠ¡ç½‘å…³
- **Netty**ï¼šç½‘ç»œåº”ç”¨æ¡†æ¶ä¸­çš„EventLoop
- **RabbitMQ/Kafka**ï¼šæ¶ˆæ¯é˜Ÿåˆ—ä½œä¸ºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„ä¸­ä»‹
- **Struts2**ï¼šActionServletä½œä¸ºå‰ç«¯æ§åˆ¶å™¨
- **MyBatis**ï¼šSqlSessionä½œä¸ºä¸­ä»‹åè°ƒæ•°æ®åº“æ“ä½œ
- **Elasticsearch**ï¼šåè°ƒåˆ†å¸ƒå¼èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡
- **Docker Swarm/Kubernetes**ï¼šå®¹å™¨ç¼–æ’ç³»ç»Ÿä½œä¸ºå®¹å™¨çš„ä¸­ä»‹è€…

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¸­ä»‹è€…è†¨èƒ€é£é™©**ï¼šéšç€åŒäº‹ç±»å¢åŠ ï¼Œä¸­ä»‹è€…å¯èƒ½å˜å¾—å¤æ‚åºå¤§ï¼Œæˆä¸º"ä¸Šå¸å¯¹è±¡"

2. **æ€§èƒ½ç“¶é¢ˆ**ï¼šä¸­ä»‹è€…å¯èƒ½æˆä¸ºç³»ç»Ÿçš„æ€§èƒ½ç“¶é¢ˆ

3. **å•ç‚¹æ•…éšœ**ï¼šä¸­ä»‹è€…æ•…éšœä¼šå½±å“æ•´ä¸ªç³»ç»Ÿ

4. **è¿‡åº¦è€¦åˆ**ï¼šä¸­ä»‹è€…ä¸åŒäº‹ç±»ä¹‹é—´å¯èƒ½å½¢æˆè¿‡åº¦è€¦åˆ

5. **å¹¶å‘å¤„ç†**ï¼šå¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨

6. **æµ‹è¯•å¤æ‚åº¦**ï¼šä¸­ä»‹è€…çš„æµ‹è¯•å¯èƒ½å˜å¾—å¤æ‚

7. **å¯æ‰©å±•æ€§**ï¼šæ·»åŠ æ–°çš„äº¤äº’é€»è¾‘å¯èƒ½éœ€è¦ä¿®æ”¹ä¸­ä»‹è€…

8. **çŠ¶æ€ç®¡ç†**ï¼šä¸­ä»‹è€…éœ€è¦ç®¡ç†å¤§é‡çŠ¶æ€ä¿¡æ¯

## ğŸ“ æœ€ä½³å®è·µ

1. **ä¿æŒä¸­ä»‹è€…ç®€æ´**ï¼šé¿å…ä¸­ä»‹è€…æ‰¿æ‹…è¿‡å¤šè´£ä»»

2. **æ‹†åˆ†å¤æ‚ä¸­ä»‹è€…**ï¼šå°†å¤§å‹ä¸­ä»‹è€…æ‹†åˆ†ä¸ºå¤šä¸ªæ›´å°çš„ä¸­ä»‹è€…

```java
// æ‹†åˆ†å¤æ‚ä¸­ä»‹è€…ç¤ºä¾‹
public class OrderMediator {
    private PaymentMediator paymentMediator;
    private InventoryMediator inventoryMediator;
    private ShippingMediator shippingMediator;
    private NotificationMediator notificationMediator;

    // å§”æ‰˜ç»™ä¸“é—¨çš„ä¸­ä»‹è€…å¤„ç†ç‰¹å®šåŠŸèƒ½
    public void processOrder(Order order) {
        // æ£€æŸ¥åº“å­˜
        boolean hasStock = inventoryMediator.checkStock(order);
        if (!hasStock) {
            notificationMediator.sendOutOfStockNotification(order);
            return;
        }

        // å¤„ç†æ”¯ä»˜
        boolean paymentSuccess = paymentMediator.processPayment(order);
        if (!paymentSuccess) {
            notificationMediator.sendPaymentFailedNotification(order);
            return;
        }

        // å®‰æ’å‘è´§
        shippingMediator.scheduleDelivery(order);

        // å‘é€é€šçŸ¥
        notificationMediator.sendOrderConfirmation(order);
    }
}
```

3. **ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼**ï¼šç»“åˆè§‚å¯Ÿè€…æ¨¡å¼å¤„ç†çŠ¶æ€å˜åŒ–é€šçŸ¥

4. **ä¸­ä»‹è€…æ¥å£åŒ–**ï¼šé€šè¿‡æ¥å£å®šä¹‰ä¸­ä»‹è€…ï¼Œä¾¿äºæ›¿æ¢å®ç°

5. **å•ä¾‹ä¸­ä»‹è€…**ï¼šå¯¹äºå…¨å±€ä¸­ä»‹è€…è€ƒè™‘ä½¿ç”¨å•ä¾‹æ¨¡å¼

6. **äº‹ä»¶é©±åŠ¨è®¾è®¡**ï¼šåŸºäºäº‹ä»¶çš„ä¸­ä»‹è€…å®ç°

7. **çŠ¶æ€ç®¡ç†åˆ†ç¦»**ï¼šå°†çŠ¶æ€ç®¡ç†ä¸åè°ƒé€»è¾‘åˆ†ç¦»

8. **ä½¿ç”¨ä¾èµ–æ³¨å…¥**ï¼šé€šè¿‡ä¾èµ–æ³¨å…¥ç®¡ç†åŒäº‹å¯¹è±¡

9. **é¿å…åŒå‘ä¾èµ–**ï¼šé˜²æ­¢ä¸­ä»‹è€…ä¸åŒäº‹ç±»ä¹‹é—´çš„åŒå‘ä¾èµ–

10. **æ–‡æ¡£åŒ–äº¤äº’è§„åˆ™**ï¼šæ¸…æ™°è®°å½•ä¸­ä»‹è€…ä¸åŒäº‹ç±»ä¹‹é—´çš„äº¤äº’è§„åˆ™

## ğŸ“š ç›¸å…³æ¨¡å¼

- **å¤–è§‚æ¨¡å¼**ï¼šéƒ½å°è£…äº†å¤æ‚çš„äº¤äº’ï¼Œä½†å¤–è§‚æ¨¡å¼å…³æ³¨ç®€åŒ–æ¥å£ï¼Œä¸­ä»‹è€…æ¨¡å¼å…³æ³¨åè°ƒäº¤äº’
- **è§‚å¯Ÿè€…æ¨¡å¼**ï¼šéƒ½æ¶‰åŠå¯¹è±¡é—´é€šä¿¡ï¼Œä½†è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€å¯¹å¤šä¾èµ–ï¼Œä¸­ä»‹è€…æ¨¡å¼æ˜¯å¤šå¯¹å¤šåè°ƒ
- **å•ä¾‹æ¨¡å¼**ï¼šä¸­ä»‹è€…é€šå¸¸å®ç°ä¸ºå•ä¾‹
- **å·¥å‚æ¨¡å¼**ï¼šåˆ›å»ºåŒäº‹å¯¹è±¡
- **å‘½ä»¤æ¨¡å¼**ï¼šå°†ä¸­ä»‹è€…æ“ä½œå°è£…ä¸ºå‘½ä»¤
- **çŠ¶æ€æ¨¡å¼**ï¼šä¸­ä»‹è€…å¯ä»¥ä½¿ç”¨çŠ¶æ€æ¨¡å¼ç®¡ç†è‡ªèº«çŠ¶æ€
- **ç­–ç•¥æ¨¡å¼**ï¼šä¸åŒçš„ä¸­ä»‹ç­–ç•¥
- **è´£ä»»é“¾æ¨¡å¼**ï¼šè¯·æ±‚å¤„ç†é“¾å¯ä»¥ä½œä¸ºä¸­ä»‹è€…çš„ä¸€ç§å®ç°æ–¹å¼