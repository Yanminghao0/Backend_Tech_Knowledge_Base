# ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰

> å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬å°è£…èµ·æ¥ï¼Œå¹¶ä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢

---

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯

- **ç±»å‹**: è¡Œä¸ºå‹æ¨¡å¼
- **éš¾åº¦**: â­â­
- **ä½¿ç”¨é¢‘ç‡**: â­â­â­â­â­
- **å…³é”®è¯**: ç®—æ³•æ—ã€åŠ¨æ€é€‰æ‹©ã€æ¶ˆé™¤if-else

---

## ğŸ¯ æ¨¡å¼æ„å›¾

**æ ¸å¿ƒæ€æƒ³**ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶ä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ strategyæ¨¡å¼è®©ç®—æ³•å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–ã€‚

**è§£å†³çš„é—®é¢˜**ï¼š
- å¦‚ä½•åœ¨è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©ä¸åŒçš„ç®—æ³•æˆ–è¡Œä¸º
- å¦‚ä½•é¿å…ä½¿ç”¨å¤§é‡æ¡ä»¶è¯­å¥ï¼ˆif-else/switch-caseï¼‰æ¥é€‰æ‹©ä¸åŒè¡Œä¸º
- å¦‚ä½•å°†ç®—æ³•çš„å®ç°ä¸ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ç«¯è§£è€¦
- å¦‚ä½•æ–¹ä¾¿åœ°æ‰©å±•æ–°çš„ç®—æ³•æˆ–è¡Œä¸º

**é€‚ç”¨åœºæ™¯**ï¼š
- ğŸ›’ **ç”µå•†ç³»ç»Ÿ**ï¼šä¸åŒçš„æ”¯ä»˜æ–¹å¼ï¼ˆä¿¡ç”¨å¡ã€æ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ï¼‰
- ğŸ“Š **æŠ¥è¡¨ç³»ç»Ÿ**ï¼šä¸åŒçš„æ•°æ®æ’åºå’Œè¿‡æ»¤ç®—æ³•
- ğŸ§® **è®¡ç®—ç³»ç»Ÿ**ï¼šä¸åŒçš„æ•°å€¼è®¡ç®—æ–¹æ³•
- ğŸ¨ **å›¾å½¢ç³»ç»Ÿ**ï¼šä¸åŒçš„æ¸²æŸ“ç®—æ³•
- ğŸ“„ **æ–‡æ¡£å¤„ç†**ï¼šä¸åŒçš„æ ¼å¼è½¬æ¢ç®—æ³•
- ğŸšš **ç‰©æµç³»ç»Ÿ**ï¼šä¸åŒçš„è·¯å¾„è§„åˆ’ç®—æ³•
- ğŸ” **æœç´¢ç³»ç»Ÿ**ï¼šä¸åŒçš„æœç´¢ç®—æ³•
- ğŸ“± **UIæ¡†æ¶**ï¼šä¸åŒçš„å¸ƒå±€ç­–ç•¥
- ğŸ”’ **å®‰å…¨ç³»ç»Ÿ**ï¼šä¸åŒçš„åŠ å¯†ç®—æ³•
- ğŸ“¦ **å‹ç¼©å·¥å…·**ï¼šä¸åŒçš„å‹ç¼©ç®—æ³•

## ğŸ—ï¸ UMLç±»å›¾

```mermaid
classDiagram
    class Context {
        -strategy: Strategy
        +Context(strategy: Strategy)
        +setStrategy(strategy: Strategy)
        +executeStrategy(): void
    }
    class Strategy {
        <<interface>>
        +execute(): void
    }
    class ConcreteStrategyA {
        +execute(): void
    }
    class ConcreteStrategyB {
        +execute(): void
    }
    class ConcreteStrategyC {
        +execute(): void
    }
    class Client {
    }

    Context --> Strategy
    Strategy <|-- ConcreteStrategyA
    Strategy <|-- ConcreteStrategyB
    Strategy <|-- ConcreteStrategyC
    Client --> Context
    Client --> ConcreteStrategyA
    Client --> ConcreteStrategyB
    Client --> ConcreteStrategyC
```

**æ ¸å¿ƒè§’è‰²**ï¼š
- **Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰**ï¼šä½¿ç”¨ç­–ç•¥çš„å¯¹è±¡ï¼Œç»´æŠ¤ä¸€ä¸ªå¯¹Strategyå¯¹è±¡çš„å¼•ç”¨
- **Strategyï¼ˆç­–ç•¥æ¥å£ï¼‰**ï¼šå®šä¹‰æ‰€æœ‰æ”¯æŒçš„ç®—æ³•çš„å…¬å…±æ¥å£
- **ConcreteStrategyï¼ˆå…·ä½“ç­–ç•¥ï¼‰**ï¼šå®ç°Strategyæ¥å£çš„å…·ä½“ç®—æ³•
- **Clientï¼ˆå®¢æˆ·ç«¯ï¼‰**ï¼šåˆ›å»ºå¹¶é…ç½®å…·ä½“ç­–ç•¥å¯¹è±¡ï¼Œå°†ç­–ç•¥å¯¹è±¡ä¼ é€’ç»™ä¸Šä¸‹æ–‡

**ç­–ç•¥æ¨¡å¼å˜ä½“**ï¼š
1. **ç®€å•ç­–ç•¥æ¨¡å¼**ï¼šåŸºæœ¬å®ç°ï¼Œä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹åº”ä¸€ä¸ªç­–ç•¥
2. **ç­–ç•¥å·¥å‚æ¨¡å¼**ï¼šä½¿ç”¨å·¥å‚åˆ›å»ºç­–ç•¥å¯¹è±¡
3. **å…ƒç­–ç•¥æ¨¡å¼**ï¼šç­–ç•¥é€‰æ‹©æœ¬èº«ä¹Ÿæˆä¸ºä¸€ç§ç­–ç•¥
4. **ç­–ç•¥é“¾æ¨¡å¼**ï¼šå¤šä¸ªç­–ç•¥å½¢æˆé“¾å¼è°ƒç”¨
5. **ç­–ç•¥ç»„åˆæ¨¡å¼**ï¼šç»„åˆå¤šä¸ªç­–ç•¥å½¢æˆæ–°ç­–ç•¥

## ğŸ’» ä»£ç å®ç°

### 1. åŸºç¡€å®ç°ï¼ˆæ’åºç­–ç•¥ï¼‰

```java
// ç­–ç•¥æ¥å£
public interface SortStrategy {
    void sort(int[] array);
    String getStrategyName();
}

// ä¸Šä¸‹æ–‡ç±»
public class SorterContext {
    private SortStrategy strategy;

    public SorterContext(SortStrategy strategy) {
        this.strategy = strategy;
    }

    public void setStrategy(SortStrategy strategy) {
        this.strategy = strategy;
        System.out.println("æ’åºç­–ç•¥å·²åˆ‡æ¢ä¸º: " + strategy.getStrategyName());
    }

    public void sortArray(int[] array) {
        System.out.print("ä½¿ç”¨" + strategy.getStrategyName() + "æ’åºå‰: ");
        printArray(array);

        long startTime = System.currentTimeMillis();
        strategy.sort(array);
        long endTime = System.currentTimeMillis();

        System.out.print("ä½¿ç”¨" + strategy.getStrategyName() + "æ’åºå: ");
        printArray(array);
        System.out.println("æ’åºè€—æ—¶: " + (endTime - startTime) + "ms");
    }

    private void printArray(int[] array) {
        for (int num : array) {
            System.out.print(num + " ");
        }
        System.out.println();
    }
}

// å…·ä½“ç­–ç•¥ - å†’æ³¡æ’åº
public class BubbleSortStrategy implements SortStrategy {
    @Override
    public void sort(int[] array) {
        if (array == null || array.length <= 1) return;

        int n = array.length;
        for (int i = 0; i < n - 1; i++) {
            for (int j = 0; j < n - i - 1; j++) {
                if (array[j] > array[j + 1]) {
                    // äº¤æ¢å…ƒç´ 
                    int temp = array[j];
                    array[j] = array[j + 1];
                    array[j + 1] = temp;
                }
            }
        }
    }

    @Override
    public String getStrategyName() {
        return "å†’æ³¡æ’åº";}
}

// å…·ä½“ç­–ç•¥ - é€‰æ‹©æ’åº
public class SelectionSortStrategy implements SortStrategy {
    @Override
    public void sort(int[] array) {
        if (array == null || array.length <= 1) return;

        int n = array.length;
        for (int i = 0; i < n - 1; i++) {
            int minIndex = i;
            for (int j = i + 1; j < n; j++) {
                if (array[j] < array[minIndex]) {
                    minIndex = j;
                }
            }
            // äº¤æ¢æ‰¾åˆ°çš„æœ€å°å€¼å’Œå½“å‰ä½ç½®
            int temp = array[minIndex];
            array[minIndex] = array[i];
            array[i] = temp;
        }
    }

    @Override
    public String getStrategyName() {
        return "é€‰æ‹©æ’åº";}
}

// å…·ä½“ç­–ç•¥ - å¿«é€Ÿæ’åº
public class QuickSortStrategy implements SortStrategy {
    @Override
    public void sort(int[] array) {
        if (array == null || array.length <= 1) return;
        quickSort(array, 0, array.length - 1);
    }

    private void quickSort(int[] array, int low, int high) {
        if (low < high) {
            int pi = partition(array, low, high);
            quickSort(array, low, pi - 1);
            quickSort(array, pi + 1, high);
        }
    }

    private int partition(int[] array, int low, int high) {
        int pivot = array[high];
        int i = low - 1;
        for (int j = low; j < high; j++) {
            if (array[j] <= pivot) {
                i++;
                // äº¤æ¢å…ƒç´ 
                int temp = array[i];
                array[i] = array[j];
                array[j] = temp;
            }
        }
        // äº¤æ¢pivot
        int temp = array[i + 1];
        array[i + 1] = array[high];
        array[high] = temp;
        return i + 1;
    }

    @Override
    public String getStrategyName() {
        return "å¿«é€Ÿæ’åº";}
}

// å®¢æˆ·ç«¯
public class SortClient {
    public static void main(String[] args) {
        int[] array = {64, 34, 25, 12, 22, 11, 90};
        int[] arrayCopy1 = Arrays.copyOf(array, array.length);
        int[] arrayCopy2 = Arrays.copyOf(array, array.length);
        int[] arrayCopy3 = Arrays.copyOf(array, array.length);

        // åˆ›å»ºä¸åŒç­–ç•¥
        SortStrategy bubbleSort = new BubbleSortStrategy();
        SortStrategy selectionSort = new SelectionSortStrategy();
        SortStrategy quickSort = new QuickSortStrategy();

        // ä½¿ç”¨å†’æ³¡æ’åº
        SorterContext sorter = new SorterContext(bubbleSort);
        sorter.sortArray(arrayCopy1);

        // åˆ‡æ¢åˆ°é€‰æ‹©æ’åº
        sorter.setStrategy(selectionSort);
        sorter.sortArray(arrayCopy2);

        // åˆ‡æ¢åˆ°å¿«é€Ÿæ’åº
        sorter.setStrategy(quickSort);
        sorter.sortArray(arrayCopy3);

        // æµ‹è¯•å¤§æ•°æ®é‡ä¸‹çš„æ€§èƒ½å·®å¼‚
        int[] bigArray = generateRandomArray(10000);
        int[] bigArrayCopy1 = Arrays.copyOf(bigArray, bigArray.length);
        int[] bigArrayCopy2 = Arrays.copyOf(bigArray, bigArray.length);
        int[] bigArrayCopy3 = Arrays.copyOf(bigArray, bigArray.length);

        System.out.println("\nå¤§æ•°æ®é‡æ’åºæ€§èƒ½æµ‹è¯•ï¼ˆ10000ä¸ªå…ƒç´ ï¼‰:");
        sorter.setStrategy(bubbleSort);
        sorter.sortArray(bigArrayCopy1);

        sorter.setStrategy(selectionSort);
        sorter.sortArray(bigArrayCopy2);

        sorter.setStrategy(quickSort);
        sorter.sortArray(bigArrayCopy3);
    }

    private static int[] generateRandomArray(int size) {
        int[] array = new int[size];
        Random random = new Random();
        for (int i = 0; i < size; i++) {
            array[i] = random.nextInt(100000);
        }
        return array;
    }
}
```

### 2. é«˜çº§å®ç°ï¼ˆæ”¯ä»˜ç­–ç•¥ï¼‰

```java
import java.math.BigDecimal;
import java.util.HashMap;
import java.util.Map;
import java.util.UUID;

// è®¢å•ç±»
public class Order {
    private String orderId;
    private BigDecimal amount;
    private String productName;
    private long timestamp;

    public Order(String productName, BigDecimal amount) {
        this.orderId = UUID.randomUUID().toString();
        this.productName = productName;
        this.amount = amount;
        this.timestamp = System.currentTimeMillis();
    }

    // Getters and Setters
    public String getOrderId() { return orderId; }
    public BigDecimal getAmount() { return amount; }
    public String getProductName() { return productName; }
    public long getTimestamp() { return timestamp; }
}

// æ”¯ä»˜ç»“æœç±»
public class PaymentResult {
    private boolean success;
    private String transactionId;
    private String message;
    private BigDecimal amount;
    private long timestamp;

    // æ„é€ å‡½æ•°ã€Getterså’ŒSetters
    public PaymentResult(boolean success, String transactionId, String message, BigDecimal amount) {
        this.success = success;
        this.transactionId = transactionId;
        this.message = message;
        this.amount = amount;
        this.timestamp = System.currentTimeMillis();
    }

    public boolean isSuccess() { return success; }
    public String getTransactionId() { return transactionId; }
    public String getMessage() { return message; }
    public BigDecimal getAmount() { return amount; }
    public long getTimestamp() { return timestamp; }
}

// æ”¯ä»˜ç­–ç•¥æ¥å£
public interface PaymentStrategy {
    PaymentResult pay(Order order);
    String getPaymentMethod();
    boolean supportsRefund();
}

// ä¸Šä¸‹æ–‡ç±»
public class PaymentContext {
    private PaymentStrategy strategy;
    private static final Map<String, PaymentStrategy> strategyCache = new HashMap<>();

    // ç­–ç•¥æ³¨å†Œ
    public static void registerStrategy(String paymentMethod, PaymentStrategy strategy) {
        strategyCache.put(paymentMethod.toLowerCase(), strategy);
    }

    // ç­–ç•¥å·¥å‚æ–¹æ³•
    public static PaymentContext createWithStrategy(String paymentMethod) {
        PaymentStrategy strategy = strategyCache.get(paymentMethod.toLowerCase());
        if (strategy == null) {
            throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ”¯ä»˜æ–¹å¼: " + paymentMethod);
        }
        return new PaymentContext(strategy);
    }

    public PaymentContext(PaymentStrategy strategy) {
        this.strategy = strategy;
    }

    public void setStrategy(PaymentStrategy strategy) {
        this.strategy = strategy;
    }

    public PaymentResult executePayment(Order order) {
        System.out.println("ä½¿ç”¨" + strategy.getPaymentMethod() + "æ”¯ä»˜è®¢å•: " + order.getOrderId());
        return strategy.pay(order);
    }

    public String getCurrentPaymentMethod() {
        return strategy.getPaymentMethod();
    }

    public boolean supportsRefund() {
        return strategy.supportsRefund();
    }
}

// å…·ä½“ç­–ç•¥ - ä¿¡ç”¨å¡æ”¯ä»˜
public class CreditCardPaymentStrategy implements PaymentStrategy {
    private String cardNumber;
    private String nameOnCard;
    private String expiryDate;
    private String cvv;

    public CreditCardPaymentStrategy(String cardNumber, String nameOnCard, String expiryDate, String cvv) {
        this.cardNumber = maskCardNumber(cardNumber);
        this.nameOnCard = nameOnCard;
        this.expiryDate = expiryDate;
        this.cvv = cvv;
    }

    @Override
    public PaymentResult pay(Order order) {
        // æ¨¡æ‹Ÿä¿¡ç”¨å¡æ”¯ä»˜å¤„ç†
        try {
            Thread.sleep(1500); // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
            // ç”Ÿæˆäº¤æ˜“ID
            String transactionId = "CC" + System.currentTimeMillis() + UUID.randomUUID().toString().substring(0, 8);
            return new PaymentResult(true, transactionId,
                    "ä¿¡ç”¨å¡æ”¯ä»˜æˆåŠŸ", order.getAmount());
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            return new PaymentResult(false, null, "æ”¯ä»˜å¤„ç†ä¸­æ–­", order.getAmount());
        }
    }

    @Override
    public String getPaymentMethod() {
        return "ä¿¡ç”¨å¡æ”¯ä»˜";}

    @Override
    public boolean supportsRefund() {
        return true;
    }

    private String maskCardNumber(String cardNumber) {
        if (cardNumber == null || cardNumber.length() < 13) {
            return "Invalid Card Number";
        }
        return "XXXX-XXXX-XXXX-" + cardNumber.substring(cardNumber.length() - 4);
    }
}

// å…·ä½“ç­–ç•¥ - æ”¯ä»˜å®æ”¯ä»˜
public class AlipayStrategy implements PaymentStrategy {
    private String userId;
    private String phoneNumber;

    public AlipayStrategy(String userId, String phoneNumber) {
        this.userId = userId;
        this.phoneNumber = maskPhoneNumber(phoneNumber);
    }

    @Override
    public PaymentResult pay(Order order) {
        // æ¨¡æ‹Ÿæ”¯ä»˜å®æ”¯ä»˜å¤„ç†
        try {
            Thread.sleep(1000); // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
            // ç”Ÿæˆäº¤æ˜“ID
            String transactionId = "ALIPAY" + System.currentTimeMillis();
            return new PaymentResult(true, transactionId,
                    "æ”¯ä»˜å®æ”¯ä»˜æˆåŠŸ", order.getAmount());
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            return new PaymentResult(false, null, "æ”¯ä»˜å¤„ç†ä¸­æ–­", order.getAmount());
        }
    }

    @Override
    public String getPaymentMethod() {
        return "æ”¯ä»˜å®æ”¯ä»˜";}

    @Override
    public boolean supportsRefund() {
        return true;
    }

    private String maskPhoneNumber(String phoneNumber) {
        if (phoneNumber == null || phoneNumber.length() < 11) {
            return phoneNumber;
        }
        return phoneNumber.substring(0, 3) + "****" + phoneNumber.substring(7);
    }
}

// å…·ä½“ç­–ç•¥ - å¾®ä¿¡æ”¯ä»˜
public class WechatPayStrategy implements PaymentStrategy {
    private String openId;
    private String nickname;

    public WechatPayStrategy(String openId, String nickname) {
        this.openId = openId.substring(0, 8) + "..." + openId.substring(openId.length() - 8);
        this.nickname = nickname;
    }

    @Override
    public PaymentResult pay(Order order) {
        // æ¨¡æ‹Ÿå¾®ä¿¡æ”¯ä»˜å¤„ç†
        try {
            Thread.sleep(1200); // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
            // ç”Ÿæˆäº¤æ˜“ID
            String transactionId = "WX" + System.currentTimeMillis();
            return new PaymentResult(true, transactionId,
                    "å¾®ä¿¡æ”¯ä»˜æˆåŠŸ", order.getAmount());
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            return new PaymentResult(false, null, "æ”¯ä»˜å¤„ç†ä¸­æ–­", order.getAmount());
        }
    }

    @Override
    public String getPaymentMethod() {
        return "å¾®ä¿¡æ”¯ä»˜";}

    @Override
    public boolean supportsRefund() {
        return true;
    }
}

// å…·ä½“ç­–ç•¥ - ç°é‡‘æ”¯ä»˜
public class CashPaymentStrategy implements PaymentStrategy {
    private String cashierName;

    public CashPaymentStrategy(String cashierName) {
        this.cashierName = cashierName;
    }

    @Override
    public PaymentResult pay(Order order) {
        // æ¨¡æ‹Ÿç°é‡‘æ”¯ä»˜å¤„ç†
        try {
            Thread.sleep(500); // æ¨¡æ‹Ÿå¤„ç†æ—¶é—´
            // ç”Ÿæˆäº¤æ˜“ID
            String transactionId = "CASH" + System.currentTimeMillis();
            return new PaymentResult(true, transactionId,
                    "ç°é‡‘æ”¯ä»˜æˆåŠŸï¼Œæ”¶é“¶å‘˜: " + cashierName, order.getAmount());
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            return new PaymentResult(false, null, "æ”¯ä»˜å¤„ç†ä¸­æ–­", order.getAmount());
        }
    }

    @Override
    public String getPaymentMethod() {
        return "ç°é‡‘æ”¯ä»˜";}

    @Override
    public boolean supportsRefund() {
        return false;
    }
}

// å®¢æˆ·ç«¯
public class PaymentClient {
    public static void main(String[] args) {
        // åˆ›å»ºè®¢å•
        Order order = new Order("é«˜çº§ç¼–ç¨‹è¯¾ç¨‹", new BigDecimal(199.99));
        System.out.println("åˆ›å»ºè®¢å•: " + order.getOrderId() + ", é‡‘é¢: " + order.getAmount() + ", å•†å“: " + order.getProductName());

        // æ³¨å†Œæ”¯ä»˜ç­–ç•¥
        PaymentContext.registerStrategy("creditcard",
                new CreditCardPaymentStrategy("4111111111111111", "å¼ ä¸‰", "12/25", "123"));
        PaymentContext.registerStrategy("alipay",
                new AlipayStrategy("zhangsan123", "13800138000"));
        PaymentContext.registerStrategy("wechat",
                new WechatPayStrategy("o6_bmjrPTlm6_2sgVt7hMZOPfL2M", "å¼ ä¸‰çš„å¾®ä¿¡"));

        try {
            // ä½¿ç”¨ä¿¡ç”¨å¡æ”¯ä»˜
            PaymentContext creditCardPayment = PaymentContext.createWithStrategy("creditcard");
            PaymentResult result = creditCardPayment.executePayment(order);
            System.out.println(result.isSuccess() ? "æ”¯ä»˜æˆåŠŸ" : "æ”¯ä»˜å¤±è´¥");
            System.out.println("äº¤æ˜“ID: " + result.getTransactionId());
            System.out.println("æ¶ˆæ¯: " + result.getMessage());

            // åˆ›å»ºæ–°è®¢å•
            Order order2 = new Order("è®¾è®¡æ¨¡å¼ä¹¦ç±", new BigDecimal(59.90));
            System.out.println("\nåˆ›å»ºè®¢å•: " + order2.getOrderId() + ", é‡‘é¢: " + order2.getAmount() + ", å•†å“: " + order2.getProductName());

            // ä½¿ç”¨å¾®ä¿¡æ”¯ä»˜
            PaymentContext wechatPayment = PaymentContext.createWithStrategy("wechat");
            PaymentResult result2 = wechatPayment.executePayment(order2);
            System.out.println(result2.isSuccess() ? "æ”¯ä»˜æˆåŠŸ" : "æ”¯ä»˜å¤±è´¥");
            System.out.println("äº¤æ˜“ID: " + result2.getTransactionId());
            System.out.println("æ¶ˆæ¯: " + result2.getMessage());

            // ä½¿ç”¨ç°é‡‘æ”¯ä»˜ï¼ˆç›´æ¥åˆ›å»ºï¼Œä¸é€šè¿‡æ³¨å†Œï¼‰
            PaymentContext cashPayment = new PaymentContext(new CashPaymentStrategy("æå››"));
            Order order3 = new Order("å’–å•¡", new BigDecimal(35.00));
            System.out.println("\nåˆ›å»ºè®¢å•: " + order3.getOrderId() + ", é‡‘é¢: " + order3.getAmount() + ", å•†å“: " + order3.getProductName());
            PaymentResult result3 = cashPayment.executePayment(order3);
            System.out.println(result3.isSuccess() ? "æ”¯ä»˜æˆåŠŸ" : "æ”¯ä»˜å¤±è´¥");
            System.out.println("äº¤æ˜“ID: " + result3.getTransactionId());
            System.out.println("æ¶ˆæ¯: " + result3.getMessage());
            System.out.println("æ˜¯å¦æ”¯æŒé€€æ¬¾: " + cashPayment.supportsRefund());
        } catch (IllegalArgumentException e) {
            System.out.println("æ”¯ä»˜é”™è¯¯: " + e.getMessage());
        }
    }
}
```

## ğŸ” æºç åº”ç”¨

### Javaä¸­çš„ç­–ç•¥æ¨¡å¼
- **`java.util.Comparator`**ï¼šæ¯”è¾ƒå™¨æ¥å£
- **`java.util.concurrent.Executor`**ï¼šæ‰§è¡Œå™¨æ¥å£
- **`java.io.FileFilter`**ï¼šæ–‡ä»¶è¿‡æ»¤æ¥å£
- **`java.nio.file.PathMatcher`**ï¼šè·¯å¾„åŒ¹é…å™¨
- **`java.security.AuthenticationProvider`**ï¼šè®¤è¯æä¾›è€…
- **`javax.servlet.Filter`**ï¼šè¿‡æ»¤å™¨æ¥å£
- **`java.awt.LayoutManager`**ï¼šå¸ƒå±€ç®¡ç†å™¨

```java
// Java Comparatorç­–ç•¥æ¨¡å¼ç¤ºä¾‹
public class ComparatorExample {
    public static void main(String[] args) {
        List<String> words = Arrays.asList("apple", "Banana", "cherry", "date");

        // è‡ªç„¶æ’åºç­–ç•¥
        Collections.sort(words);
        System.out.println("è‡ªç„¶æ’åº: " + words);

        // è‡ªå®šä¹‰æ’åºç­–ç•¥ - é•¿åº¦æ’åº
        Comparator<String> lengthComparator = Comparator.comparingInt(String::length);
        Collections.sort(words, lengthComparator);
        System.out.println("é•¿åº¦æ’åº: " + words);

        // è‡ªå®šä¹‰æ’åºç­–ç•¥ - å¿½ç•¥å¤§å°å†™æ’åº
        Comparator<String> ignoreCaseComparator = String::compareToIgnoreCase;
        Collections.sort(words, ignoreCaseComparator);
        System.out.println("å¿½ç•¥å¤§å°å†™æ’åº: " + words);

        // ç»„åˆæ’åºç­–ç•¥ - å…ˆé•¿åº¦åå­—æ¯
        Comparator<String> combinedComparator = lengthComparator.thenComparing(ignoreCaseComparator);
        Collections.sort(words, combinedComparator);
        System.out.println("ç»„åˆæ’åº: " + words);
    }
}
```

### Springæ¡†æ¶ä¸­çš„åº”ç”¨
- **`org.springframework.beans.factory.support.InstantiationStrategy`**ï¼šå®ä¾‹åŒ–ç­–ç•¥
- **`org.springframework.core.io.ResourceLoader`**ï¼šèµ„æºåŠ è½½ç­–ç•¥
- **`org.springframework.transaction.PlatformTransactionManager`**ï¼šäº‹åŠ¡ç®¡ç†ç­–ç•¥
- **`org.springframework.security.authentication.AuthenticationManager`**ï¼šè®¤è¯ç­–ç•¥
- **`org.springframework.web.client.RestTemplate`**ï¼šHTTPå®¢æˆ·ç«¯ç­–ç•¥
- **`org.springframework.cache.CacheManager`**ï¼šç¼“å­˜ç­–ç•¥
- **`org.springframework.scheduling.TaskScheduler`**ï¼šä»»åŠ¡è°ƒåº¦ç­–ç•¥

```java
// Springç¼“å­˜ç­–ç•¥ç¤ºä¾‹
@Configuration
@EnableCaching
public class CacheConfig {
    // é…ç½®ä¸åŒçš„ç¼“å­˜ç­–ç•¥
    @Bean
    public CacheManager concurrentMapCacheManager() {
        return new ConcurrentMapCacheManager("users", "products");
    }

    // æˆ–è€…ä½¿ç”¨Redisç¼“å­˜ç­–ç•¥
    @Bean
    public CacheManager redisCacheManager(RedisConnectionFactory connectionFactory) {
        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofMinutes(10))
            .serializeKeysWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new StringRedisSerializer()))
            .serializeValuesWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new GenericJackson2JsonRedisSerializer()));

        return RedisCacheManager.builder(connectionFactory)
            .cacheDefaults(config)
            .withCacheConfiguration("users", 
                RedisCacheConfiguration.defaultCacheConfig().entryTtl(Duration.ofHours(1)))
            .withCacheConfiguration("products", 
                RedisCacheConfiguration.defaultCacheConfig().entryTtl(Duration.ofMinutes(5)))
            .build();
    }
}

// ä½¿ç”¨ç¼“å­˜ç­–ç•¥
@Service
public class ProductService {
    private final ProductRepository repository;

    @Autowired
    public ProductService(ProductRepository repository) {
        this.repository = repository;
    }

    // ä½¿ç”¨ç¼“å­˜ç­–ç•¥
    @Cacheable("products")
    public Product getProduct(Long id) {
        System.out.println("ä»æ•°æ®åº“è·å–äº§å“: " + id);
        return repository.findById(id)
            .orElseThrow(() -> new ProductNotFoundException(id));
    }

    @CacheEvict("products")
    public void updateProduct(Product product) {
        repository.save(product);
    }

    @Caching(evict = {
        @CacheEvict(value = "products", key = "#id"),
        @CacheEvict(value = "products", allEntries = true)
    })
    public void deleteProduct(Long id) {
        repository.deleteById(id);
    }
}
```

### å…¶ä»–æ¡†æ¶ä¸­çš„åº”ç”¨
- **Apache Struts2**ï¼šæ‹¦æˆªå™¨ç­–ç•¥
- **Hibernate**ï¼šæŸ¥è¯¢ç­–ç•¥
- **MyBatis**ï¼šæ‰§è¡Œå™¨ç­–ç•¥
- **Logback/Log4j**ï¼šæ—¥å¿—è¾“å‡ºç­–ç•¥
- **Elasticsearch**ï¼šæœç´¢ç­–ç•¥
- **Spring Boot**ï¼šè‡ªåŠ¨é…ç½®ç­–ç•¥
- **React**ï¼šæ¸²æŸ“ç­–ç•¥
- **Vue.js**ï¼šç»„ä»¶æ¸²æŸ“ç­–ç•¥
- **Android**ï¼šå¸ƒå±€ç­–ç•¥
- **iOS**ï¼šåŠ¨ç”»ç­–ç•¥

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç­–ç•¥è¿‡å¤šé—®é¢˜**ï¼šå¦‚æœç­–ç•¥æ•°é‡è¿‡å¤šï¼Œä¼šå¯¼è‡´ç±»çˆ†ç‚¸

2. **ç­–ç•¥é€‰æ‹©å¤æ‚æ€§**ï¼šå®¢æˆ·ç«¯éœ€è¦äº†è§£ä¸åŒç­–ç•¥çš„å·®å¼‚æ‰èƒ½é€‰æ‹©åˆé€‚çš„ç­–ç•¥

3. **çŠ¶æ€ç»´æŠ¤**ï¼šæ— çŠ¶æ€ç­–ç•¥å¯ä»¥å…±äº«ï¼Œä½†æœ‰çŠ¶æ€ç­–ç•¥éœ€è¦æ¯æ¬¡åˆ›å»ºæ–°å®ä¾‹

4. **ä¸Šä¸‹æ–‡ä¸ç­–ç•¥é€šä¿¡**ï¼šä¸Šä¸‹æ–‡éœ€è¦å‘ç­–ç•¥ä¼ é€’è¶³å¤Ÿçš„ä¿¡æ¯

5. **ç­–ç•¥åˆ‡æ¢å¼€é”€**ï¼šæŸäº›ç­–ç•¥åˆ‡æ¢å¯èƒ½æ¶‰åŠè¾ƒå¤§çš„å¼€é”€

6. **ç­–ç•¥ä¸€è‡´æ€§**ï¼šç¡®ä¿æ‰€æœ‰ç­–ç•¥å®ç°éµå¾ªç›¸åŒçš„å¥‘çº¦

7. **æµ‹è¯•å¤æ‚åº¦**ï¼šéœ€è¦ä¸ºæ¯ä¸ªç­–ç•¥ç¼–å†™æµ‹è¯•ç”¨ä¾‹

8. **è¿‡åº¦è®¾è®¡**ï¼šç®€å•åœºæ™¯ä¸‹ä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯èƒ½å¯¼è‡´è¿‡åº¦è®¾è®¡

## ğŸ“ æœ€ä½³å®è·µ

1. **ç­–ç•¥æ¥å£è®¾è®¡**ï¼šä¿æŒç­–ç•¥æ¥å£ç®€æ´ï¼Œä¸“æ³¨äºå•ä¸€åŠŸèƒ½

```java
// è‰¯å¥½çš„ç­–ç•¥æ¥å£è®¾è®¡
public interface PaymentStrategy {
    // å•ä¸€æŠ½è±¡æ–¹æ³•
    PaymentResult processPayment(Order order);
    
    // é»˜è®¤æ–¹æ³•æä¾›å…±åŒåŠŸèƒ½
    default String getPaymentMethod() {
        return this.getClass().getSimpleName().replace("PaymentStrategy", "");
    }
}
```

2. **ç­–ç•¥å·¥å‚**ï¼šä½¿ç”¨å·¥å‚æ¨¡å¼ç®¡ç†ç­–ç•¥åˆ›å»º

```java
// ç­–ç•¥å·¥å‚
public class PaymentStrategyFactory {
    private static final Map<String, Supplier<PaymentStrategy>> strategies = new HashMap<>();

    static {
        // æ³¨å†Œç­–ç•¥
        strategies.put("creditcard", CreditCardPayment::new);
        strategies.put("alipay", AlipayPayment::new);
        strategies.put("wechat", WechatPayment::new);
    }

    public static PaymentStrategy getStrategy(String paymentMethod) {
        Supplier<PaymentStrategy> strategySupplier = strategies.get(paymentMethod.toLowerCase());
        if (strategySupplier == null) {
            throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ”¯ä»˜æ–¹å¼: " + paymentMethod);
        }
        return strategySupplier.get();
    }

    public static PaymentStrategy getStrategy(String paymentMethod, Map<String, Object> config) {
        // æ ¹æ®é…ç½®åˆ›å»ºç­–ç•¥
        PaymentStrategy strategy = getStrategy(paymentMethod);
        // é…ç½®ç­–ç•¥
        configureStrategy(strategy, config);
        return strategy;
    }

    private static void configureStrategy(PaymentStrategy strategy, Map<String, Object> config) {
        // ä½¿ç”¨åå°„æˆ–ç­–ç•¥æ¥å£ä¸­çš„é…ç½®æ–¹æ³•é…ç½®ç­–ç•¥
    }
}
```

3. **ç­–ç•¥ç¼“å­˜**ï¼šç¼“å­˜æ— çŠ¶æ€ç­–ç•¥å®ä¾‹ä»¥æé«˜æ€§èƒ½

4. **ç­–ç•¥ç»„åˆ**ï¼šç»„åˆå¤šä¸ªç­–ç•¥å½¢æˆå¤åˆç­–ç•¥

5. **ç­–ç•¥å…ƒæ•°æ®**ï¼šä¸ºç­–ç•¥æä¾›å…ƒæ•°æ®ï¼Œè¾…åŠ©ç­–ç•¥é€‰æ‹©

6. **é»˜è®¤ç­–ç•¥**ï¼šæä¾›é»˜è®¤ç­–ç•¥ï¼Œç¡®ä¿ç³»ç»Ÿå¯ç”¨æ€§

7. **ç­–ç•¥éªŒè¯**ï¼šåœ¨ä½¿ç”¨ç­–ç•¥å‰éªŒè¯å…¶é€‚ç”¨æ€§

8. **ç­–ç•¥æ–‡æ¡£**ï¼šä¸ºæ¯ä¸ªç­–ç•¥æä¾›æ¸…æ™°çš„æ–‡æ¡£è¯´æ˜

9. **ç­–ç•¥é€‰æ‹©å™¨**ï¼šåˆ›å»ºç­–ç•¥é€‰æ‹©å™¨ï¼Œå°è£…ç­–ç•¥é€‰æ‹©é€»è¾‘

10. **æ³¨è§£é©±åŠ¨ç­–ç•¥**ï¼šä½¿ç”¨æ³¨è§£æ ‡è®°å’Œå‘ç°ç­–ç•¥

## ğŸ“š ç›¸å…³æ¨¡å¼

- **çŠ¶æ€æ¨¡å¼**ï¼šçŠ¶æ€æ¨¡å¼å°è£…å¯¹è±¡å†…éƒ¨çŠ¶æ€ï¼Œè€Œç­–ç•¥æ¨¡å¼å°è£…ç®—æ³•
- **å·¥å‚æ¨¡å¼**ï¼šé€šå¸¸ä¸ç­–ç•¥æ¨¡å¼ä¸€èµ·ä½¿ç”¨ï¼Œåˆ›å»ºç­–ç•¥å¯¹è±¡
- **æ¨¡æ¿æ–¹æ³•æ¨¡å¼**ï¼šæ¨¡æ¿æ–¹æ³•å®šä¹‰ç®—æ³•éª¨æ¶ï¼Œç­–ç•¥æ¨¡å¼æä¾›å®Œæ•´ç®—æ³•
- **å‘½ä»¤æ¨¡å¼**ï¼šå‘½ä»¤æ¨¡å¼å°è£…è¯·æ±‚ï¼Œç­–ç•¥æ¨¡å¼å°è£…ç®—æ³•
- **è£…é¥°å™¨æ¨¡å¼**ï¼šè£…é¥°å™¨æ¨¡å¼åŠ¨æ€æ·»åŠ åŠŸèƒ½ï¼Œç­–ç•¥æ¨¡å¼åŠ¨æ€é€‰æ‹©ç®—æ³•
- **äº«å…ƒæ¨¡å¼**ï¼šå¯ä»¥ä¸ç­–ç•¥æ¨¡å¼ç»“åˆï¼Œå…±äº«æ— çŠ¶æ€ç­–ç•¥å¯¹è±¡
- **ä»£ç†æ¨¡å¼**ï¼šä»£ç†æ¨¡å¼æ§åˆ¶è®¿é—®ï¼Œç­–ç•¥æ¨¡å¼æä¾›ç®—æ³•é€‰æ‹©
- **ç»„åˆæ¨¡å¼**ï¼šå¯ä»¥ç»„åˆå¤šä¸ªç­–ç•¥å½¢æˆå¤åˆç­–ç•¥
- **ä¾èµ–æ³¨å…¥**ï¼šé€šå¸¸ç”¨äºæ³¨å…¥ç­–ç•¥å¯¹è±¡åˆ°ä¸Šä¸‹æ–‡ä¸­
- **æœåŠ¡å®šä½å™¨æ¨¡å¼**ï¼šå¯ä»¥ç”¨äºå®šä½ç­–ç•¥å®ç°

