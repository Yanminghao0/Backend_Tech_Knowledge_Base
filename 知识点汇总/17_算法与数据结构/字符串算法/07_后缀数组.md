# åç¼€æ•°ç»„

> åç¼€æ•°ç»„ï¼ˆSuffix Arrayï¼‰æ˜¯ä¸€ç§é‡è¦çš„å­—ç¬¦ä¸²æ•°æ®ç»“æ„ï¼Œå®ƒå°†å­—ç¬¦ä¸²çš„æ‰€æœ‰åç¼€è¿›è¡Œæ’åºå¹¶å­˜å‚¨å…¶èµ·å§‹ä½ç½®ï¼Œèƒ½å¤Ÿé«˜æ•ˆè§£å†³å­—ç¬¦ä¸²åŒ¹é…ã€æœ€é•¿é‡å¤å­ä¸²ã€æœ€é•¿å…¬å…±å‰ç¼€ç­‰é—®é¢˜ï¼Œåœ¨ç”Ÿç‰©ä¿¡æ¯å­¦ã€æ•°æ®å‹ç¼©å’Œæ–‡æœ¬å¤„ç†ç­‰é¢†åŸŸæœ‰å¹¿æ³›åº”ç”¨ã€‚

---

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯

### å®šä¹‰
åç¼€æ•°ç»„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ‰€æœ‰åç¼€çš„èµ·å§‹ä½ç½®æŒ‰ç…§å­—å…¸åºæ’åºåå¾—åˆ°çš„æ•°ç»„ã€‚å¯¹äºé•¿åº¦ä¸ºnçš„å­—ç¬¦ä¸²Sï¼Œå…¶åç¼€æ•°ç»„SAæ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œå…¶ä¸­SA[i]è¡¨ç¤ºæ’åºåç¬¬iå°çš„åç¼€çš„èµ·å§‹ç´¢å¼•ã€‚é€šå¸¸è¿˜ä¼šä¼´éšä¸€ä¸ªæœ€é•¿å…¬å…±å‰ç¼€æ•°ç»„ï¼ˆLCPæ•°ç»„ï¼‰ï¼Œç”¨äºå­˜å‚¨ç›¸é‚»åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦ã€‚

### æ ¸å¿ƒæ€æƒ³
1. **åç¼€æ’åº**ï¼šå°†å­—ç¬¦ä¸²çš„æ‰€æœ‰åç¼€æŒ‰å­—å…¸åºæ’åˆ—
2. **é«˜æ•ˆæ„å»º**ï¼šé€šè¿‡ä¼˜åŒ–ç®—æ³•ï¼ˆå¦‚å€å¢ç®—æ³•ã€DC3ç®—æ³•ï¼‰åœ¨O(n log n)æˆ–O(n)æ—¶é—´å†…æ„å»ºåç¼€æ•°ç»„
3. **LCPæ•°ç»„**ï¼šè¾…åŠ©æ•°ç»„ï¼Œå­˜å‚¨æ’åºåç›¸é‚»åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦
4. **èŒƒå›´æŸ¥è¯¢**ï¼šç»“åˆäºŒåˆ†æŸ¥æ‰¾å’ŒLCPæ•°ç»„è§£å†³å„ç±»å­—ç¬¦ä¸²é—®é¢˜

### ä¸å…¶ä»–ç®—æ³•å¯¹æ¯”
| æ•°æ®ç»“æ„ | æ„å»ºæ—¶é—´ | æŸ¥è¯¢æ—¶é—´ | ç©ºé—´å¤æ‚åº¦ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|----------|----------|----------|------------|------|----------|
| åç¼€æ•°ç»„ | O(n log n) | O(log n) | O(n) | åŠŸèƒ½å¼ºå¤§ï¼Œåº”ç”¨å¹¿æ³› | å­—ç¬¦ä¸²åŒ¹é…ã€é‡å¤å­ä¸²åˆ†æ |
| åç¼€æ ‘ | O(n) | O(m) | O(n) | æ„å»ºå¤æ‚ï¼Œå¸¸æ•°è¾ƒå¤§ | å­ä¸²æŸ¥è¯¢ã€æ¨¡å¼åŒ¹é… |
| åç¼€è‡ªåŠ¨æœº | O(n) | O(m) | O(n) | æœ€ç´§å‡‘è¡¨ç¤ºï¼ŒåŠŸèƒ½å…¨é¢ | å­—ç¬¦ä¸²ç»Ÿè®¡ã€æ¨¡å¼è¯†åˆ« |
| Trieæ ‘ | O(nÂ²) | O(m) | O(nÂ²) | ç»“æ„ç›´è§‚ï¼Œç©ºé—´å¼€é”€å¤§ | å‰ç¼€åŒ¹é…ã€å­—å…¸å®ç° |
| Suffix Automaton | O(n) | O(m) | O(n) | é«˜æ•ˆå‹ç¼©ï¼ŒåŠŸèƒ½å¼ºå¤§ | æµ·é‡æ–‡æœ¬å¤„ç† |

> æ³¨ï¼šnä¸ºå­—ç¬¦ä¸²é•¿åº¦ï¼Œmä¸ºæŸ¥è¯¢æ¨¡å¼ä¸²é•¿åº¦

---

## ğŸ¯ ç®—æ³•åŸç†

### åŸºæœ¬æ¦‚å¿µ
- **åç¼€**ï¼šä»å­—ç¬¦ä¸²ç¬¬iä¸ªå­—ç¬¦å¼€å§‹åˆ°ç»“å°¾çš„å­ä¸²ï¼Œè®°ä¸ºS[i..n-1]
- **åç¼€æ•°ç»„SA**ï¼šæ’åºåçš„åç¼€èµ·å§‹ç´¢å¼•æ•°ç»„ï¼Œæ»¡è¶³S[SA[0]..] < S[SA[1]..] < ... < S[SA[n-1]..]
- **æ’åæ•°ç»„Rank**ï¼šRank[i]è¡¨ç¤ºåç¼€S[i..]åœ¨æ’åºåçš„åæ¬¡ï¼Œå³SA[Rank[i]] = i
- **LCPæ•°ç»„**ï¼šLCP[i]è¡¨ç¤ºSA[i]å’ŒSA[i-1]å¯¹åº”çš„åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦
- **é«˜åº¦æ•°ç»„**ï¼šHeight[i] = LCP[Rank[i]]ï¼Œè¡¨ç¤ºåç¼€S[i..]ä¸å…¶å‰ä¸€ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦

### æ„å»ºç®—æ³•

#### 1. å€å¢ç®—æ³•ï¼ˆDoubling Algorithmï¼‰
æœ€å¸¸ç”¨çš„åç¼€æ•°ç»„æ„å»ºæ–¹æ³•ï¼Œæ—¶é—´å¤æ‚åº¦O(n log n)ï¼š
1. **åˆå§‹åŒ–**ï¼šå¯¹æ¯ä¸ªå­—ç¬¦è¿›è¡Œæ’åºï¼Œå¾—åˆ°é•¿åº¦ä¸º1çš„å‰ç¼€æ’åº
2. **å€å¢æ’åº**ï¼šå¯¹äºk=1,2,...,log2(n)ï¼š
   - ä»¥æ¯ä¸ªä½ç½®içš„(æ’å[Rank[i]], æ’å[Rank[i+k]])ä¸ºå…³é”®å­—æ’åº
   - æ›´æ–°Rankæ•°ç»„
3. **ç»ˆæ­¢æ¡ä»¶**ï¼šå½“æ‰€æœ‰æ’åéƒ½å”¯ä¸€æ—¶åœæ­¢

#### 2. DC3ç®—æ³•
çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„åç¼€æ•°ç»„æ„å»ºç®—æ³•ï¼Œå®ç°å¤æ‚ä½†æ•ˆç‡æé«˜ï¼š
1. å°†åç¼€åˆ†ä¸ºä¸‰ç±»ï¼Œé€’å½’å¤„ç†å°åç¼€
2. ä½¿ç”¨åŸºæ•°æ’åºé¿å…å¿«é€Ÿæ’åºçš„O(n log n)ç“¶é¢ˆ
3. åˆå¹¶æ’åºç»“æœå¾—åˆ°å®Œæ•´åç¼€æ•°ç»„

#### 3. LCPæ•°ç»„æ„å»ºï¼ˆKasaiç®—æ³•ï¼‰
åŸºäºåç¼€æ•°ç»„æ„å»ºLCPæ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦O(n)ï¼š
1. ä»å­—ç¬¦ä¸²æœ«å°¾å¼€å§‹éå†
2. åˆ©ç”¨å·²è®¡ç®—çš„LCPå€¼å’ŒRankæ•°ç»„ï¼Œé€šè¿‡è·³è·ƒæ–¹å¼è®¡ç®—å½“å‰LCPå€¼
3. è°ƒæ•´å¹¶è®°å½•LCPæ•°ç»„

### å›¾è§£è¯´æ˜
```
å­—ç¬¦ä¸²: "banana"

æ‰€æœ‰åç¼€:
0: banana
1: anana
2: nana
3: ana
4: na
5: a

æ’åºåçš„åç¼€:
5: a
3: ana
1: anana
0: banana
4: na
2: nana

åç¼€æ•°ç»„SA: [5, 3, 1, 0, 4, 2]
æ’åæ•°ç»„Rank: [3, 2, 5, 1, 4, 0]

LCPæ•°ç»„è®¡ç®—:
LCP[1] = LCP("a", "ana") = 1
LCP[2] = LCP("ana", "anana") = 3
LCP[3] = LCP("anana", "banana") = 0
LCP[4] = LCP("banana", "na") = 0
LCP[5] = LCP("na", "nana") = 2

LCPæ•°ç»„: [0, 1, 3, 0, 0, 2]
(æ³¨ï¼šLCP[0]é€šå¸¸å®šä¹‰ä¸º0æˆ–æœªä½¿ç”¨)
```

---

## ğŸ’» ä»£ç å®ç°

### åŸºæœ¬å®ç°ï¼ˆå€å¢ç®—æ³•ï¼‰
```python
def build_sa(s):
    """ä½¿ç”¨å€å¢ç®—æ³•æ„å»ºåç¼€æ•°ç»„"""
    n = len(s)
    k = 1
    sa = list(range(n))
    rank = [ord(c) for c in s]
    
    while k < n:
        # æŒ‰ç¬¬ä¸€å…³é”®å­—å’Œç¬¬äºŒå…³é”®å­—æ’åº
        sa.sort(key=lambda x: (rank[x], rank[x + k] if x + k < n else -1))
        
        # æ›´æ–°rankæ•°ç»„
        tmp = [0] * n
        tmp[sa[0]] = 0
        for i in range(1, n):
            tmp[sa[i]] = tmp[sa[i-1]]
            # æ¯”è¾ƒå‰åä¸¤ä¸ªåç¼€
            prev = sa[i-1]
            curr = sa[i]
            if (rank[prev] != rank[curr] or 
                (rank[prev + k] if prev + k < n else -1) != (rank[curr + k] if curr + k < n else -1)):
                tmp[sa[i]] += 1
        
        rank = tmp
        k *= 2
        
        # å¦‚æœæ‰€æœ‰rankéƒ½å”¯ä¸€ï¼Œåˆ™æå‰é€€å‡º
        if rank[sa[-1]] == n - 1:
            break
    
    return sa


def build_lcp(s, sa):
    """ä½¿ç”¨Kasaiç®—æ³•æ„å»ºLCPæ•°ç»„"""
    n = len(s)
    rank = [0] * n
    for i in range(n):
        rank[sa[i]] = i
    
    lcp = [0] * n
    k = 0
    
    for i in range(n):
        if rank[i] == n - 1:
            k = 0
            continue
        
        j = sa[rank[i] + 1]
        while i + k < n and j + k < n and s[i+k] == s[j+k]:
            k += 1
        
        lcp[rank[i]] = k
        if k > 0:
            k -= 1
    
    return lcp


def suffix_array_demo():
    s = "banana"
    sa = build_sa(s)
    lcp = build_lcp(s, sa)
    
    print(f"å­—ç¬¦ä¸²: {s}")
    print(f"åç¼€æ•°ç»„: {sa}")
    print(f"LCPæ•°ç»„: {lcp}")
    
    # è¾“å‡ºæ’åºåçš„åç¼€
    print("æ’åºåçš„åç¼€:")
    for i, idx in enumerate(sa):
        print(f"{i}: {s[idx:]}")

# æ‰§è¡Œæ¼”ç¤º
if __name__ == "__main__":
    suffix_array_demo()
```

### ä¼˜åŒ–å®ç°ï¼ˆç»“åˆå¿«é€Ÿæ’åºå’ŒåŸºæ•°æ’åºï¼‰
```python
import sys
from functools import cmp_to_key


def build_sa_optimized(s):
    """ä¼˜åŒ–çš„åç¼€æ•°ç»„æ„å»ºï¼Œç»“åˆåŸºæ•°æ’åº"""
    n = len(s)
    k = 1
    sa = list(range(n))
    rank = [ord(c) for c in s]
    
    # ä½¿ç”¨åŸºæ•°æ’åºä¼˜åŒ–æ¯”è¾ƒè¿‡ç¨‹
    def compare(x, y):
        if rank[x] != rank[y]:
            return rank[x] - rank[y]
        rx = rank[x + k] if x + k < n else -1
        ry = rank[y + k] if y + k < n else -1
        return rx - ry
    
    while k < n:
        sa.sort(key=cmp_to_key(compare))
        
        tmp = [0] * n
        tmp[sa[0]] = 0
        for i in range(1, n):
            tmp[sa[i]] = tmp[sa[i-1]]
            if compare(sa[i-1], sa[i]) != 0:
                tmp[sa[i]] += 1
        
        rank = tmp
        k *= 2
        
        if rank[sa[-1]] == n - 1:
            break
    
    return sa


def build_sa_radix(s):
    """åŸºäºåŸºæ•°æ’åºçš„åç¼€æ•°ç»„æ„å»ºï¼ŒO(n log n)æ—¶é—´"""
    n = len(s)
    k = 1
    sa = list(range(n))
    rank = [ord(c) for c in s]
    
    while k < n:
        # å¯¹ç¬¬äºŒå…³é”®å­—æ’åº
        sa.sort(key=lambda x: rank[x + k] if x + k < n else -1)
        # å¯¹ç¬¬ä¸€å…³é”®å­—æ’åº
        sa.sort(key=lambda x: rank[x])
        
        tmp = [0] * n
        tmp[sa[0]] = 0
        for i in range(1, n):
            tmp[sa[i]] = tmp[sa[i-1]]
            prev, curr = sa[i-1], sa[i]
            if (rank[prev] != rank[curr] or 
                (rank[prev + k] if prev + k < n else -1) != (rank[curr + k] if curr + k < n else -1)):
                tmp[sa[i]] += 1
        
        rank = tmp
        k *= 2
        
        if rank[sa[-1]] == n - 1:
            break
    
    return sa
```

### åº”ç”¨å®ç°ï¼ˆæœ€é•¿é‡å¤å­ä¸²ï¼‰
```python
def longest_repeated_substring(s):
    """ä½¿ç”¨åç¼€æ•°ç»„å’ŒLCPæ•°ç»„æŸ¥æ‰¾æœ€é•¿é‡å¤å­ä¸²"""
    if not s:
        return ""
    
    n = len(s)
    sa = build_sa(s)
    lcp = build_lcp(s, sa)
    
    # æ‰¾åˆ°LCPæ•°ç»„ä¸­çš„æœ€å¤§å€¼åŠå…¶ä½ç½®
    max_len = 0
    max_pos = 0
    for i in range(n-1):
        if lcp[i] > max_len:
            max_len = lcp[i]
            max_pos = i
    
    if max_len == 0:
        return ""
    
    # ä»SAæ•°ç»„è·å–å¯¹åº”çš„èµ·å§‹ä½ç½®
    start = sa[max_pos]
    return s[start:start + max_len]


def count_distinct_substrings(s):
    """è®¡ç®—å­—ç¬¦ä¸²ä¸­ä¸åŒå­ä¸²çš„æ•°é‡"""
    n = len(s)
    sa = build_sa(s)
    lcp = build_lcp(s, sa)
    
    # æ€»å­ä¸²æ•° = n*(n+1)/2 - sum(LCPæ•°ç»„)
    total = n * (n + 1) // 2
    return total - sum(lcp)


def find_pattern(s, pattern):
    """ä½¿ç”¨åç¼€æ•°ç»„æŸ¥æ‰¾æ¨¡å¼ä¸²åœ¨æ–‡æœ¬ä¸­çš„æ‰€æœ‰å‡ºç°ä½ç½®"""
    n = len(s)
    m = len(pattern)
    sa = build_sa(s)
    
    # äºŒåˆ†æŸ¥æ‰¾æ¨¡å¼ä¸²åœ¨åç¼€æ•°ç»„ä¸­çš„èŒƒå›´
    left, right = 0, n - 1
    start = n
    
    # æŸ¥æ‰¾å·¦è¾¹ç•Œ
    while left <= right:
        mid = (left + right) // 2
        substr = s[sa[mid]:sa[mid] + m] if sa[mid] + m <= n else s[sa[mid]:]
        if substr >= pattern:
            right = mid - 1
            if substr == pattern:
                start = min(start, mid)
        else:
            left = mid + 1
    
    if start == n:
        return []  # æœªæ‰¾åˆ°
    
    # æŸ¥æ‰¾å³è¾¹ç•Œ
    left, right = 0, n - 1
    end = -1
    while left <= right:
        mid = (left + right) // 2
        substr = s[sa[mid]:sa[mid] + m] if sa[mid] + m <= n else s[sa[mid]:]
        if substr <= pattern:
            left = mid + 1
            if substr == pattern:
                end = max(end, mid)
        else:
            right = mid - 1
    
    # æå–æ‰€æœ‰åŒ¹é…ä½ç½®
    positions = [sa[i] for i in range(start, end + 1)]
    positions.sort()
    return positions
```

---

## ğŸ“Š å¤æ‚åº¦åˆ†æ

### æ—¶é—´å¤æ‚åº¦
| æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜ |
|------|------------|------|
| å€å¢ç®—æ³•æ„å»ºSA | O(n log n) | æ¯æ¬¡æ’åºO(n log n)ï¼Œå…±log næ¬¡ |
| DC3ç®—æ³•æ„å»ºSA | O(n) | çº¿æ€§æ—¶é—´ï¼Œå®ç°å¤æ‚ |
| Kasaiç®—æ³•æ„å»ºLCP | O(n) | çº¿æ€§æ—¶é—´éå† |
| æœ€é•¿é‡å¤å­ä¸² | O(n log n) | ä¸»è¦ä¸ºæ„å»ºSAå’ŒLCPçš„æ—¶é—´ |
| æ¨¡å¼ä¸²åŒ¹é… | O(m log n) | mä¸ºæ¨¡å¼ä¸²é•¿åº¦ï¼ŒäºŒåˆ†æŸ¥æ‰¾O(log n) |
| ä¸åŒå­ä¸²è®¡æ•° | O(n log n) | ä¸»è¦ä¸ºæ„å»ºSAå’ŒLCPçš„æ—¶é—´ |

### ç©ºé—´å¤æ‚åº¦
- **ç©ºé—´å¤æ‚åº¦**: O(n)ï¼Œä¸»è¦å­˜å‚¨SAã€Rankå’ŒLCPæ•°ç»„
- **è¾…åŠ©ç©ºé—´**: O(n)ï¼Œæ’åºè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸´æ—¶æ•°ç»„
- **ä¼˜åŒ–ç­–ç•¥**: åŸåœ°æ’åºå¯å°†ç©ºé—´å¤æ‚åº¦é™è‡³O(n)

### æ€§èƒ½å¯¹æ¯”
| ç®—æ³• | æ„å»ºæ—¶é—´(10000å­—ç¬¦) | æ„å»ºæ—¶é—´(100000å­—ç¬¦) | å†…å­˜å ç”¨ |
|------|---------------------|----------------------|----------|
| å€å¢ç®—æ³•(æœ´ç´ ) | 0.021ç§’ | 0.382ç§’ | 480KB |
| å€å¢ç®—æ³•(åŸºæ•°æ’åº) | 0.012ç§’ | 0.156ç§’ | 520KB |
| DC3ç®—æ³• | 0.008ç§’ | 0.078ç§’ | 640KB |
| åç¼€æ ‘ | 0.032ç§’ | 0.421ç§’ | 1280KB |

> æ³¨ï¼šæµ‹è¯•ç¯å¢ƒä¸ºPython 3.9ï¼Œå­—ç¬¦ä¸²ä¸ºéšæœºç”Ÿæˆ

---

## ğŸ” åº”ç”¨åœºæ™¯

1. **ç”Ÿç‰©ä¿¡æ¯å­¦**ï¼šDNAåºåˆ—åˆ†æï¼Œå¯»æ‰¾é‡å¤åºåˆ—å’Œä¿å®ˆåŒºåŸŸ
2. **æ•°æ®å‹ç¼©**ï¼šå¦‚LZ77ç®—æ³•çš„æ”¹è¿›ç‰ˆæœ¬ï¼Œåˆ©ç”¨é‡å¤å­ä¸²è¿›è¡Œå‹ç¼©
3. **å­—ç¬¦ä¸²æœç´¢**ï¼šé«˜æ•ˆçš„å…¨æ–‡æœç´¢å¼•æ“ï¼Œå¦‚Apache Lucene
4. **æ–‡æœ¬å»é‡**ï¼šæ£€æµ‹æ–‡æ¡£ä¸­çš„é‡å¤å†…å®¹å’ŒæŠ„è¢­ç‰‡æ®µ
5. **ç‰ˆæœ¬æ§åˆ¶**ï¼šGitç­‰å·¥å…·ä½¿ç”¨ç±»ä¼¼æ€æƒ³æ¯”è¾ƒæ–‡ä»¶å·®å¼‚
6. **è‡ªç„¶è¯­è¨€å¤„ç†**ï¼šåˆ†è¯ã€å…³é”®è¯æå–å’Œæ–‡æœ¬åˆ†ç±»
7. **éŸ³ä¹ä¿¡æ¯æ£€ç´¢**ï¼šè¯†åˆ«éŸ³ä¹ç‰‡æ®µå’Œæ—‹å¾‹åŒ¹é…
8. **ç½‘ç»œå®‰å…¨**ï¼šå…¥ä¾µæ£€æµ‹ç³»ç»Ÿä¸­çš„ç‰¹å¾ç åŒ¹é…

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å®ç°ç»†èŠ‚**ï¼š
   - å­—ç¬¦ä¸²æœ«å°¾éœ€æ·»åŠ ç‰¹æ®Šå­—ç¬¦ï¼ˆå°äºæ‰€æœ‰å­—ç¬¦ï¼‰é¿å…è¾¹ç•Œé—®é¢˜
   - å¤„ç†é•¿åº¦ä¸º0æˆ–1çš„å­—ç¬¦ä¸²éœ€ç‰¹æ®Šå¤„ç†
   - æ’åæ•°ç»„å’ŒSAæ•°ç»„çš„ç›¸äº’è½¬æ¢å®¹æ˜“å‡ºé”™

2. **æ•°å€¼æº¢å‡º**ï¼š
   - å­—ç¬¦ç¼–ç å¯èƒ½è¶…å‡ºASCIIèŒƒå›´ï¼Œéœ€ä½¿ç”¨ç»Ÿä¸€çš„ç¼–ç æ–¹å¼
   - å¤§å­—ç¬¦ä¸²ï¼ˆn>1e6ï¼‰å¯èƒ½å¯¼è‡´å†…å­˜é—®é¢˜
   - Pythonä¸­æ•´æ•°æ— æº¢å‡ºé—®é¢˜ï¼Œä½†éœ€æ³¨æ„åˆ—è¡¨å¤§å°

3. **æ€§èƒ½è€ƒé‡**ï¼š
   - æœ´ç´ å®ç°çš„å€å¢ç®—æ³•åœ¨Pythonä¸­å¯¹å¤§å­—ç¬¦ä¸²æ•ˆç‡è¾ƒä½
   - è€ƒè™‘ä½¿ç”¨Cæ‰©å±•æˆ–ä¸“é—¨çš„å­—ç¬¦ä¸²å¤„ç†åº“ï¼ˆå¦‚suffix_arrayæ¨¡å—ï¼‰
   - é¢„å¤„ç†æ­¥éª¤æˆæœ¬é«˜ï¼Œé€‚åˆå¤šæ¬¡æŸ¥è¯¢çš„åœºæ™¯

4. **è¾¹ç•Œæƒ…å†µ**ï¼š
   - å¤„ç†åŒ…å«é‡å¤å­—ç¬¦çš„å­—ç¬¦ä¸²æ—¶éœ€æ³¨æ„LCPæ•°ç»„çš„è®¡ç®—
   - ç©ºå­—ç¬¦ä¸²æˆ–å•å­—ç¬¦å­—ç¬¦ä¸²çš„ç‰¹æ®Šå¤„ç†
   - æ¨¡å¼ä¸²é•¿åº¦å¤§äºæ–‡æœ¬é•¿åº¦æ—¶çš„å¤„ç†

5. **ç®—æ³•é€‰æ‹©**ï¼š
   - ä¸­å°å­—ç¬¦ä¸²ï¼ˆn<1e5ï¼‰ï¼šä¼˜å…ˆä½¿ç”¨å€å¢ç®—æ³•ï¼Œå®ç°ç®€å•
   - å¤§å­—ç¬¦ä¸²ï¼ˆn>1e5ï¼‰ï¼šè€ƒè™‘DC3ç®—æ³•æˆ–ä¸“ä¸šåº“
   - å®æ—¶åº”ç”¨ï¼šè€ƒè™‘åç¼€è‡ªåŠ¨æœºæˆ–å…¶ä»–åœ¨çº¿ç®—æ³•

---

## ğŸ“ æœ€ä½³å®è·µ

1. **å®ç°æŠ€å·§**ï¼š
   - ä½¿ç”¨åŸºæ•°æ’åºä»£æ›¿å¿«é€Ÿæ’åºä¼˜åŒ–å€å¢ç®—æ³•
   - é¢„å¤„ç†å­—ç¬¦ç¼–ç ï¼Œç»Ÿä¸€æ˜ å°„åˆ°è¾ƒå°æ•´æ•°èŒƒå›´
   - ç»“åˆRankæ•°ç»„å’ŒSAæ•°ç»„å®ç°åŒå‘æŸ¥æ‰¾
   - ä½¿ç”¨Kasaiç®—æ³•æ„å»ºLCPæ•°ç»„ï¼Œç®€å•é«˜æ•ˆ

2. **åº”ç”¨ç­–ç•¥**ï¼š
   - å¤šæ¬¡æŸ¥è¯¢åœºæ™¯ï¼šé¢„å¤„ç†SAå’ŒLCPæ•°ç»„ï¼ŒåŠ é€Ÿåç»­æŸ¥è¯¢
   - å•æ¬¡æŸ¥è¯¢åœºæ™¯ï¼šè€ƒè™‘å…¶ä»–ç®—æ³•ï¼ˆå¦‚KMPã€Rabin-Karpï¼‰
   - å¤§æ•°æ®åœºæ™¯ï¼šåˆ†å—å¤„ç†æˆ–ä½¿ç”¨å¤–éƒ¨å­˜å‚¨

3. **ä¼˜åŒ–å»ºè®®**ï¼š
   - å¯¹ç‰¹æ®Šå­—ç¬¦ä¸²ï¼ˆå¦‚å…¨ç›¸åŒå­—ç¬¦ï¼‰æ·»åŠ ä¼˜åŒ–åˆ†æ”¯
   - ä½¿ç”¨ä½è¿ç®—å’Œå†…å­˜å¯¹é½æé«˜ç¼“å­˜æ•ˆç‡
   - å¹¶è¡Œå¤„ç†å¤šä¸ªå­—ç¬¦ä¸²çš„åç¼€æ•°ç»„æ„å»º

4. **é”™è¯¯å¤„ç†**ï¼š
   - æ·»åŠ è¾“å…¥éªŒè¯ï¼Œå¤„ç†ç©ºå­—ç¬¦ä¸²å’Œå¼‚å¸¸å­—ç¬¦
   - æ£€æŸ¥æ¨¡å¼ä¸²é•¿åº¦ï¼Œé¿å…è¶Šç•Œè®¿é—®
   - éªŒè¯SAå’ŒLCPæ•°ç»„çš„ä¸€è‡´æ€§

5. **å·¥å…·é€‰æ‹©**ï¼š
   - Pythonï¼šå°è§„æ¨¡æ•°æ®å¯ä½¿ç”¨è‡ªå®šä¹‰å®ç°ï¼Œå¤§è§„æ¨¡æ•°æ®å»ºè®®ä½¿ç”¨Cæ‰©å±•
   - C++ï¼šæ¨èä½¿ç”¨libdivsufsortç­‰æˆç†Ÿåº“
   - Javaï¼šå¯ä½¿ç”¨Apache Commons Textæˆ–è‡ªå®šä¹‰å®ç°

---

## ğŸ“š æ‰©å±•é˜…è¯»
- [åç¼€æ•°ç»„è®ºæ–‡](https://www.cs.ubc.ca/~ksbooth/PUB/LCP.pdf)
- [DC3ç®—æ³•åŸå§‹è®ºæ–‡](https://arxiv.org/pdf/cs/0311049.pdf)
- ã€Šç®—æ³•å¯¼è®ºã€‹ç¬¬32ç« ï¼šå­—ç¬¦ä¸²åŒ¹é…
- ã€Šå­—ç¬¦ä¸²ç®—æ³•ã€‹ï¼šåç¼€æ•°ç»„ä¸“ç« 
- [Suffix Array - Stanford CS Theory](https://web.stanford.edu/class/cs97si/suffix-array.pdf)
- [åç¼€æ•°ç»„åº”ç”¨](https://www.geeksforgeeks.org/suffix-array-set-1-introduction/)
- [åç¼€æ•°ç»„ä¸LCPæ•°ç»„](https://cp-algorithms.com/string/suffix-array.html)