# å¹³è¡¡æ ‘

å¹³è¡¡æ ‘ï¼ˆBalanced Treeï¼‰æ˜¯ä¸€ç±»ç‰¹æ®Šçš„äºŒå‰æœç´¢æ ‘ï¼Œå®ƒé€šè¿‡ç‰¹å®šæœºåˆ¶åœ¨æ’å…¥å’Œåˆ é™¤æ“ä½œåè‡ªåŠ¨è°ƒæ•´æ ‘çš„ç»“æ„ï¼Œç¡®ä¿æ ‘çš„é«˜åº¦ä¿æŒåœ¨O(log n)çº§åˆ«ï¼Œä»è€Œä¿è¯æ‰€æœ‰åŸºæœ¬æ“ä½œï¼ˆæ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾ï¼‰çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log n)ã€‚å¸¸è§çš„å¹³è¡¡æ ‘åŒ…æ‹¬AVLæ ‘ã€çº¢é»‘æ ‘ã€Bæ ‘ç­‰ã€‚

---

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| æ•°æ®ç»“æ„ç±»å‹ | è‡ªå¹³è¡¡äºŒå‰æœç´¢æ ‘ |
| å­˜å‚¨ç»“æ„ | é“¾å¼å­˜å‚¨ï¼ˆä¸ºä¸»ï¼‰ |
| æ ¸å¿ƒæ“ä½œ | æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾ã€æ—‹è½¬ã€å¹³è¡¡è°ƒæ•´ |
| æ—¶é—´å¤æ‚åº¦ | æ’å…¥/åˆ é™¤/æŸ¥æ‰¾ï¼šO(log n) |
| ç©ºé—´å¤æ‚åº¦ | O(n) |
| ç‰¹ç‚¹ | é€šè¿‡æ—‹è½¬æˆ–é¢œè‰²è°ƒæ•´ç»´æŒå¹³è¡¡æ€§ï¼Œé«˜åº¦ä¸ºO(log n)ï¼Œä¿è¯æ“ä½œæ•ˆç‡ç¨³å®š |

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

1. **å¹³è¡¡æ¡ä»¶**ï¼šä¸åŒå¹³è¡¡æ ‘æœ‰ä¸åŒçš„å¹³è¡¡æ¡ä»¶
   - AVLæ ‘ï¼šä»»æ„èŠ‚ç‚¹çš„å·¦å³å­æ ‘é«˜åº¦å·®ä¸è¶…è¿‡1
   - çº¢é»‘æ ‘ï¼šé€šè¿‡é¢œè‰²è§„åˆ™å’Œæ—‹è½¬ç»´æŒâ€œé»‘å¹³è¡¡â€
   - Bæ ‘ï¼šå¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘ï¼Œæ‰€æœ‰å¶å­èŠ‚ç‚¹åœ¨åŒä¸€å±‚

2. **è‡ªå¹³è¡¡æœºåˆ¶**ï¼šæ’å…¥åˆ é™¤åé€šè¿‡æ—‹è½¬ï¼ˆå·¦æ—‹ã€å³æ—‹ã€åŒæ—‹ï¼‰æˆ–é¢œè‰²è°ƒæ•´æ¢å¤å¹³è¡¡

3. **ç¨³å®šé«˜æ•ˆ**ï¼šæ— è®ºè¾“å…¥æ•°æ®é¡ºåºå¦‚ä½•ï¼Œéƒ½èƒ½ä¿æŒO(log n)çš„æ“ä½œæ•ˆç‡

4. **å¹³è¡¡ä¸æ€§èƒ½æƒè¡¡**ï¼šä¸¥æ ¼å¹³è¡¡ï¼ˆå¦‚AVLï¼‰æŸ¥è¯¢æ›´å¿«ï¼Œæ¾æ•£å¹³è¡¡ï¼ˆå¦‚çº¢é»‘æ ‘ï¼‰æ’å…¥åˆ é™¤æ›´å¿«

5. **æ‰©å±•æ€§**ï¼šå¯æ‰©å±•ä¸ºå¤šè·¯å¹³è¡¡æ ‘ï¼ˆBæ ‘ã€B+æ ‘ï¼‰ï¼Œé€‚åˆå¤–å­˜å­˜å‚¨

## ğŸ’» ä»£ç å®ç°

### 1. AVLæ ‘å®ç°
```java
public class AVLTree {
    private class Node {
        int val;
        Node left, right;
        int height; // èŠ‚ç‚¹é«˜åº¦

        Node(int val) {
            this.val = val;
            this.height = 1; // æ–°èŠ‚ç‚¹é«˜åº¦ä¸º1
        }
    }

    private Node root;

    // è·å–èŠ‚ç‚¹é«˜åº¦
    private int height(Node node) {
        return node == null ? 0 : node.height;
    }

    // è®¡ç®—å¹³è¡¡å› å­ï¼ˆå·¦å­æ ‘é«˜åº¦ - å³å­æ ‘é«˜åº¦ï¼‰
    private int getBalance(Node node) {
        return node == null ? 0 : height(node.left) - height(node.right);
    }

    // å³æ—‹è½¬
    private Node rightRotate(Node y) {
        Node x = y.left;
        Node T2 = x.right;

        // æ‰§è¡Œæ—‹è½¬
        x.right = y;
        y.left = T2;

        // æ›´æ–°é«˜åº¦
        y.height = Math.max(height(y.left), height(y.right)) + 1;
        x.height = Math.max(height(x.left), height(x.right)) + 1;

        // è¿”å›æ–°æ ¹
        return x;
    }

    // å·¦æ—‹è½¬
    private Node leftRotate(Node x) {
        Node y = x.right;
        Node T2 = y.left;

        // æ‰§è¡Œæ—‹è½¬
        y.left = x;
        x.right = T2;

        // æ›´æ–°é«˜åº¦
        x.height = Math.max(height(x.left), height(x.right)) + 1;
        y.height = Math.max(height(y.left), height(y.right)) + 1;

        // è¿”å›æ–°æ ¹
        return y;
    }

    // æ’å…¥èŠ‚ç‚¹
    public void insert(int val) {
        root = insert(root, val);
    }

    private Node insert(Node node, int val) {
        // 1. æ‰§è¡Œæ ‡å‡†BSTæ’å…¥
        if (node == null) {
            return new Node(val);
        }

        if (val < node.val) {
            node.left = insert(node.left, val);
        } else if (val > node.val) {
            node.right = insert(node.right, val);
        } else { // ä¸å…è®¸é‡å¤å€¼
            return node;
        }

        // 2. æ›´æ–°å½“å‰èŠ‚ç‚¹é«˜åº¦
        node.height = 1 + Math.max(height(node.left), height(node.right));

        // 3. è®¡ç®—å¹³è¡¡å› å­ï¼Œæ£€æŸ¥æ˜¯å¦å¤±è¡¡
        int balance = getBalance(node);

        // 4. å¦‚æœå¤±è¡¡ï¼Œå¤„ç†å››ç§æƒ…å†µ

        // å·¦å·¦æƒ…å†µï¼ˆLLï¼‰- å³æ—‹
        if (balance > 1 && val < node.left.val) {
            return rightRotate(node);
        }

        // å³å³æƒ…å†µï¼ˆRRï¼‰- å·¦æ—‹
        if (balance < -1 && val > node.right.val) {
            return leftRotate(node);
        }

        // å·¦å³æƒ…å†µï¼ˆLRï¼‰- å…ˆå·¦æ—‹åå³æ—‹
        if (balance > 1 && val > node.left.val) {
            node.left = leftRotate(node.left);
            return rightRotate(node);
        }

        // å³å·¦æƒ…å†µï¼ˆRLï¼‰- å…ˆå³æ—‹åå·¦æ—‹
        if (balance < -1 && val < node.right.val) {
            node.right = rightRotate(node.right);
            return leftRotate(node);
        }

        // è¿”å›æœªæ”¹å˜çš„èŠ‚ç‚¹æŒ‡é’ˆ
        return node;
    }

    // åˆ é™¤èŠ‚ç‚¹
    public void delete(int val) {
        root = delete(root, val);
    }

    private Node delete(Node node, int val) {
        // 1. æ‰§è¡Œæ ‡å‡†BSTåˆ é™¤
        if (node == null) {
            return node;
        }

        if (val < node.val) {
            node.left = delete(node.left, val);
        } else if (val > node.val) {
            node.right = delete(node.right, val);
        } else {
            // æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹
            // æƒ…å†µ1ï¼šå¶å­èŠ‚ç‚¹æˆ–åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹
            if (node.left == null || node.right == null) {
                node = (node.left == null) ? node.right : node.left;
            } else {
                // æƒ…å†µ2ï¼šæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹
                // æ‰¾åˆ°ä¸­åºåç»§ï¼ˆå³å­æ ‘æœ€å°å€¼ï¼‰
                node.val = minValue(node.right);
                // åˆ é™¤ä¸­åºåç»§
                node.right = delete(node.right, node.val);
            }
        }

        // å¦‚æœæ ‘ä¸ºç©ºï¼Œè¿”å›
        if (node == null) {
            return node;
        }

        // 2. æ›´æ–°é«˜åº¦
        node.height = 1 + Math.max(height(node.left), height(node.right));

        // 3. è®¡ç®—å¹³è¡¡å› å­
        int balance = getBalance(node);

        // 4. å¦‚æœå¤±è¡¡ï¼Œå¤„ç†å››ç§æƒ…å†µ

        // å·¦å·¦æƒ…å†µï¼ˆLLï¼‰
        if (balance > 1 && getBalance(node.left) >= 0) {
            return rightRotate(node);
        }

        // å·¦å³æƒ…å†µï¼ˆLRï¼‰
        if (balance > 1 && getBalance(node.left) < 0) {
            node.left = leftRotate(node.left);
            return rightRotate(node);
        }

        // å³å³æƒ…å†µï¼ˆRRï¼‰
        if (balance < -1 && getBalance(node.right) <= 0) {
            return leftRotate(node);
        }

        // å³å·¦æƒ…å†µï¼ˆRLï¼‰
        if (balance < -1 && getBalance(node.right) > 0) {
            node.right = rightRotate(node.right);
            return leftRotate(node);
        }

        return node;
    }

    // æŸ¥æ‰¾æœ€å°å€¼
    private int minValue(Node node) {
        int minVal = node.val;
        while (node.left != null) {
            minVal = node.left.val;
            node = node.left;
        }
        return minVal;
    }

    // ä¸­åºéå†
    public void inorder() {
        inorder(root);
        System.out.println();
    }

    private void inorder(Node node) {
        if (node != null) {
            inorder(node.left);
            System.out.print(node.val + " ");
            inorder(node.right);
        }
    }
}
```

### 2. çº¢é»‘æ ‘å®ç°ï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰
```java
public class RedBlackTree {
    private static final boolean RED = true;
    private static final boolean BLACK = false;

    private class Node {
        int val;
        Node left, right, parent;
        boolean color;

        Node(int val) {
            this.val = val;
            this.color = RED; // æ–°èŠ‚ç‚¹é»˜è®¤ä¸ºçº¢è‰²
        }
    }

    private Node root;
    private Node nil; // å“¨å…µèŠ‚ç‚¹

    public RedBlackTree() {
        nil = new Node(0);
        nil.color = BLACK;
        root = nil;
    }

    // å·¦æ—‹è½¬
    private void leftRotate(Node x) {
        Node y = x.right;
        x.right = y.left;

        if (y.left != nil) {
            y.left.parent = x;
        }

        y.parent = x.parent;

        if (x.parent == nil) {
            root = y;
        } else if (x == x.parent.left) {
            x.parent.left = y;
        } else {
            x.parent.right = y;
        }

        y.left = x;
        x.parent = y;
    }

    // å³æ—‹è½¬
    private void rightRotate(Node y) {
        Node x = y.left;
        y.left = x.right;

        if (x.right != nil) {
            x.right.parent = y;
        }

        x.parent = y.parent;

        if (y.parent == nil) {
            root = x;
        } else if (y == y.parent.right) {
            y.parent.right = x;
        } else {
            y.parent.left = x;
        }

        x.right = y;
        y.parent = x;
    }

    // æ’å…¥åä¿®å¤çº¢é»‘æ ‘æ€§è´¨
    private void insertFixup(Node z) {
        while (z.parent.color == RED) {
            if (z.parent == z.parent.parent.left) {
                Node y = z.parent.parent.right; // å”å”èŠ‚ç‚¹

                // æƒ…å†µ1ï¼šå”å”æ˜¯çº¢è‰²
                if (y.color == RED) {
                    z.parent.color = BLACK;
                    y.color = BLACK;
                    z.parent.parent.color = RED;
                    z = z.parent.parent;
                } else {
                    // æƒ…å†µ2ï¼šå”å”æ˜¯é»‘è‰²ï¼Œä¸”zæ˜¯å³å­©å­
                    if (z == z.parent.right) {
                        z = z.parent;
                        leftRotate(z);
                    }
                    // æƒ…å†µ3ï¼šå”å”æ˜¯é»‘è‰²ï¼Œä¸”zæ˜¯å·¦å­©å­
                    z.parent.color = BLACK;
                    z.parent.parent.color = RED;
                    rightRotate(z.parent.parent);
                }
            } else {
                // é•œåƒæƒ…å†µ
                Node y = z.parent.parent.left; // å”å”èŠ‚ç‚¹

                // æƒ…å†µ1ï¼šå”å”æ˜¯çº¢è‰²
                if (y.color == RED) {
                    z.parent.color = BLACK;
                    y.color = BLACK;
                    z.parent.parent.color = RED;
                    z = z.parent.parent;
                } else {
                    // æƒ…å†µ2ï¼šå”å”æ˜¯é»‘è‰²ï¼Œä¸”zæ˜¯å·¦å­©å­
                    if (z == z.parent.left) {
                        z = z.parent;
                        rightRotate(z);
                    }
                    // æƒ…å†µ3ï¼šå”å”æ˜¯é»‘è‰²ï¼Œä¸”zæ˜¯å³å­©å­
                    z.parent.color = BLACK;
                    z.parent.parent.color = RED;
                    leftRotate(z.parent.parent);
                }
            }
        }
        root.color = BLACK; // æ ¹èŠ‚ç‚¹å§‹ç»ˆä¸ºé»‘è‰²
    }

    // æ’å…¥èŠ‚ç‚¹
    public void insert(int val) {
        Node z = new Node(val);
        Node y = nil;
        Node x = root;

        // æ‰¾åˆ°æ’å…¥ä½ç½®
        while (x != nil) {
            y = x;
            if (z.val < x.val) {
                x = x.left;
            } else {
                x = x.right;
            }
        }

        z.parent = y;
        if (y == nil) {
            root = z;
        } else if (z.val < y.val) {
            y.left = z;
        } else {
            y.right = z;
        }

        z.left = nil;
        z.right = nil;
        z.color = RED;

        insertFixup(z); // ä¿®å¤çº¢é»‘æ ‘æ€§è´¨
    }

    // å…¶ä»–æ–¹æ³•ï¼ˆåˆ é™¤ã€æŸ¥æ‰¾ç­‰ï¼‰çœç•¥...
}
```

## ğŸ“Š å¤æ‚åº¦åˆ†æ

| æ“ä½œ | AVLæ ‘ | çº¢é»‘æ ‘ | Bæ ‘ï¼ˆmé˜¶ï¼‰ | ç©ºé—´å¤æ‚åº¦ |
|------|-------|--------|------------|------------|
| æ’å…¥ | O(log n) | O(log n) | O(logâ‚˜ n) | O(n) |
| åˆ é™¤ | O(log n) | O(log n) | O(logâ‚˜ n) | O(n) |
| æŸ¥æ‰¾ | O(log n) | O(log n) | O(logâ‚˜ n) | O(n) |
| æ—‹è½¬æ¬¡æ•° | æœ€å¤š2æ¬¡ | æœ€å¤š3æ¬¡ | O(m) | - |
| å¹³å‡é«˜åº¦ | ~1.44log(n+2)-1.328 | ~2log(n+1) | logâ‚˜/â‚‚((n+1)/2)+1 | - |

> æ³¨ï¼š
> - AVLæ ‘æ˜¯ä¸¥æ ¼å¹³è¡¡ï¼ŒæŸ¥è¯¢æ€§èƒ½ç•¥å¥½
> - çº¢é»‘æ ‘æ˜¯è¿‘ä¼¼å¹³è¡¡ï¼Œæ’å…¥åˆ é™¤æ€§èƒ½ç•¥å¥½
> - Bæ ‘é€‚åˆå¤§æ•°æ®å­˜å‚¨ï¼Œé™ä½I/Oæ¬¡æ•°

## ğŸ” åº”ç”¨åœºæ™¯

1. **ç¼–ç¨‹è¯­è¨€æ ‡å‡†åº“**ï¼š
   - Javaçš„TreeMap/TreeSetåŸºäºçº¢é»‘æ ‘å®ç°
   - C++çš„map/setåŸºäºçº¢é»‘æ ‘å®ç°

2. **æ•°æ®åº“ç´¢å¼•**ï¼š
   - MySQL InnoDBä½¿ç”¨B+æ ‘ä½œä¸ºèšç°‡ç´¢å¼•
   - MongoDBä½¿ç”¨Bæ ‘ä½œä¸ºç´¢å¼•ç»“æ„

3. **å†…å­˜ç®¡ç†**ï¼š
   - Linuxå†…æ ¸çš„å†…å­˜ç®¡ç†ä½¿ç”¨çº¢é»‘æ ‘
   - å †å†…å­˜åˆ†é…ä¸­çš„ç©ºé—²å—ç®¡ç†

4. **ç¼–è¯‘å™¨å®ç°**ï¼š
   - ç¬¦å·è¡¨ç®¡ç†
   - è¯­æ³•æ ‘æ„å»º

5. **ç¼“å­˜å®ç°**ï¼š
   - æŸäº›ç¼“å­˜æ·˜æ±°ç­–ç•¥ä½¿ç”¨å¹³è¡¡æ ‘ç®¡ç†

6. **åŒºé—´æŸ¥è¯¢ç³»ç»Ÿ**ï¼š
   - æ—¶é—´åŒºé—´æŸ¥è¯¢
   - IPè·¯ç”±è¡¨æŸ¥è¯¢

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å®ç°å¤æ‚æ€§**ï¼šå¹³è¡¡æ ‘å®ç°éš¾åº¦é«˜ï¼Œå°¤å…¶æ˜¯çº¢é»‘æ ‘çš„åˆ é™¤æ“ä½œ
2. **é€‰æ‹©åˆé€‚ç±»å‹**ï¼š
   - æŸ¥è¯¢å¯†é›†ï¼šAVLæ ‘
   - æ’å…¥åˆ é™¤å¯†é›†ï¼šçº¢é»‘æ ‘
   - å¤§æ•°æ®å¤–å­˜ï¼šBæ ‘/B+æ ‘
3. **é¿å…é‡å¤é€ è½®å­**ï¼šå®é™…å¼€å‘ä¼˜å…ˆä½¿ç”¨è¯­è¨€å†…ç½®é›†åˆï¼ˆå¦‚Javaçš„TreeMapï¼‰
4. **å¹³è¡¡ä¸æ€§èƒ½æƒè¡¡**ï¼šè¿‡åº¦å¹³è¡¡ä¼šå¢åŠ æ“ä½œå¼€é”€
5. **çº¿ç¨‹å®‰å…¨**ï¼šåŸºæœ¬å®ç°ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒéœ€é¢å¤–åŒæ­¥
6. **å†…å­˜å¼€é”€**ï¼šæ¯ä¸ªèŠ‚ç‚¹éœ€è¦é¢å¤–å­˜å‚¨å¹³è¡¡ä¿¡æ¯ï¼ˆé«˜åº¦æˆ–é¢œè‰²ï¼‰
7. **è‡ªå®šä¹‰æ¯”è¾ƒå™¨**ï¼šå¯¹è±¡ç±»å‹éœ€æä¾›æ¯”è¾ƒå™¨ä»¥ç¡®ä¿æ’åºæ­£ç¡®æ€§

## ğŸ“ æœ€ä½³å®è·µ

1. **ä¼˜å…ˆä½¿ç”¨æ ‡å‡†åº“**ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯­è¨€å†…ç½®çš„å¹³è¡¡æ ‘å®ç°ï¼ˆå¦‚Javaçš„TreeMapï¼‰è¶³å¤Ÿé«˜æ•ˆå¯é 

2. **æ ¹æ®åœºæ™¯é€‰æ‹©**ï¼š
   - å®æ—¶ç³»ç»Ÿï¼šé€‰æ‹©AVLæ ‘ä¿è¯æœ€åæƒ…å†µä¸‹çš„æŸ¥è¯¢æ€§èƒ½
   - é«˜é¢‘æ›´æ–°ç³»ç»Ÿï¼šé€‰æ‹©çº¢é»‘æ ‘å‡å°‘æ—‹è½¬æ“ä½œ
   - ç£ç›˜å­˜å‚¨ç³»ç»Ÿï¼šé€‰æ‹©Bæ ‘/B+æ ‘å‡å°‘I/Oæ“ä½œ

3. **å®ç°æŠ€å·§**ï¼š
   - ä½¿ç”¨å“¨å…µèŠ‚ç‚¹ç®€åŒ–è¾¹ç•Œæ¡ä»¶å¤„ç†
   - æå–æ—‹è½¬æ“ä½œä½œä¸ºç‹¬ç«‹æ–¹æ³•
   - é€’å½’å®ç°ç®€æ´ä½†è¿­ä»£å®ç°æ›´é€‚åˆå¤§æ•°æ®é‡

4. **æµ‹è¯•ç­–ç•¥**ï¼š
   - æµ‹è¯•æç«¯æƒ…å†µï¼ˆæœ‰åºæ’å…¥ã€é€†åºæ’å…¥ï¼‰
   - éªŒè¯å¹³è¡¡æ€§å’Œæ“ä½œæ­£ç¡®æ€§
   - æ€§èƒ½æµ‹è¯•å¯¹æ¯”ä¸åŒå¹³è¡¡æ ‘å®ç°

5. **æ‰©å±•åº”ç”¨**ï¼š
   - åŒºé—´æ ‘ï¼šåŸºäºå¹³è¡¡æ ‘å®ç°åŒºé—´æŸ¥è¯¢
   - çº¿æ®µæ ‘ï¼šç”¨äºèŒƒå›´æŸ¥è¯¢å’Œæ›´æ–°
   - treapï¼šç»“åˆå¹³è¡¡æ ‘å’Œå †çš„ç‰¹æ€§

---

> **å®ŒæˆçŠ¶æ€**ï¼šæœ¬æ–‡æ¡£å·²å®Œå–„å¹³è¡¡æ ‘çš„åŸºæœ¬æ¦‚å¿µã€AVLæ ‘å’Œçº¢é»‘æ ‘çš„Javaå®ç°ä»£ç ã€å¤æ‚åº¦åˆ†æã€åº”ç”¨åœºæ™¯ã€æ³¨æ„äº‹é¡¹åŠæœ€ä½³å®è·µï¼Œæ¶µç›–å¹³è¡¡æ ‘çš„æ ¸å¿ƒåŸç†å’Œå®ç°ç»†èŠ‚ï¼Œå¯ä½œä¸ºå¹³è¡¡æ ‘æ•°æ®ç»“æ„çš„å®Œæ•´å­¦ä¹ å‚è€ƒã€‚