# å †

å †ï¼ˆHeapï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®Œå…¨äºŒå‰æ ‘æ•°æ®ç»“æ„ï¼Œé™¤äº†åŸºæœ¬çš„å †æ“ä½œå¤–ï¼Œåœ¨å®é™…åº”ç”¨ä¸­è¿˜æœ‰è®¸å¤šé«˜çº§ç”¨æ³•å’Œä¼˜åŒ–ç­–ç•¥ã€‚æœ¬æ–‡æ¡£å°†é‡ç‚¹ä»‹ç»å †çš„é«˜çº§åº”ç”¨åœºæ™¯ã€ä¼˜åŒ–æŠ€æœ¯ä»¥åŠåœ¨å¤æ‚é—®é¢˜ä¸­çš„è§£å†³æ–¹æ¡ˆã€‚

---

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| æ•°æ®ç»“æ„ç±»å‹ | å®Œå…¨äºŒå‰æ ‘çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ |
| å­˜å‚¨ç»“æ„ | æ•°ç»„ï¼ˆä¸ºä¸»ï¼‰ |
| æ ¸å¿ƒæ“ä½œ | æ„å»ºå †ã€æ’å…¥ã€åˆ é™¤ã€å †åŒ–ã€åˆå¹¶ |
| æ‰©å±•æ“ä½œ | Top-KæŸ¥è¯¢ã€ä¸­ä½æ•°ç»´æŠ¤ã€åŒºé—´æœ€å€¼æŸ¥è¯¢ |
| æ—¶é—´å¤æ‚åº¦ | æ„å»ºå †ï¼šO(n)ï¼Œæ’å…¥/åˆ é™¤ï¼šO(log n)ï¼ŒTop-Kï¼šO(n log k) |
| ç©ºé—´å¤æ‚åº¦ | O(n) |
| ç‰¹ç‚¹ | é«˜æ•ˆçš„ä¼˜å…ˆçº§ç®¡ç†ï¼Œé€‚åˆå¤„ç†åŠ¨æ€æ•°æ®é›†åˆçš„æœ€å€¼é—®é¢˜ |

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

1. **ä¼˜å…ˆçº§ç®¡ç†**ï¼šèƒ½å¤Ÿå¿«é€Ÿè®¿é—®å’Œåˆ é™¤æœ€å¤§/æœ€å°å€¼ï¼Œé€‚åˆå®ç°ä¼˜å…ˆçº§é˜Ÿåˆ—

2. **éƒ¨åˆ†æ’åº**ï¼šå †æ’åºåªéœ€O(n log n)æ—¶é—´ï¼Œå¯ç”¨äºéœ€è¦éƒ¨åˆ†æœ‰åºç»“æœçš„åœºæ™¯

3. **åŠ¨æ€é›†åˆ**ï¼šæ”¯æŒé«˜æ•ˆæ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œé€‚åˆå¤„ç†æ•°æ®æµ

4. **å†…å­˜æ•ˆç‡**ï¼šæ•°ç»„å®ç°æ— éœ€é¢å¤–æŒ‡é’ˆï¼Œç¼“å­˜å‹å¥½

5. **åˆå¹¶èƒ½åŠ›**ï¼šæŸäº›é«˜çº§å †ç»“æ„ï¼ˆå¦‚æ–æ³¢é‚£å¥‘å †ï¼‰æ”¯æŒé«˜æ•ˆåˆå¹¶æ“ä½œ

6. **ç¨³å®šæ€§**ï¼šåŸºæœ¬å †ç»“æ„ä¸ç¨³å®šï¼Œä½†å¯é€šè¿‡æ‰©å±•å®ç°ç¨³å®šæ’åº

7. **å¹¶è¡Œæ€§**ï¼šå †æ“ä½œå¯å¹¶è¡ŒåŒ–ï¼Œé€‚åˆå¤šæ ¸å¤„ç†ç¯å¢ƒ

## ğŸ’» ä»£ç å®ç°

### 1. Top-Ké—®é¢˜çš„å¤šç§è§£æ³•

#### è§£æ³•ä¸€ï¼šå°é¡¶å †æ³•ï¼ˆé€‚åˆå¤§æ•°æ®é‡ï¼‰
```java
import java.util.PriorityQueue;
import java.util.Comparator;

public class TopKUsingMinHeap {
    public int[] findTopK(int[] nums, int k) {
        if (k <= 0 || nums == null || nums.length == 0) {
            return new int[0];
        }

        // åˆ›å»ºå°é¡¶å †
        PriorityQueue<Integer> minHeap = new PriorityQueue<>(Comparator.naturalOrder());

        // éå†æ•°ç»„ï¼Œç»´æŠ¤å †å¤§å°ä¸ºk
        for (int num : nums) {
            if (minHeap.size() < k) {
                minHeap.offer(num);
            } else if (num > minHeap.peek()) {
                minHeap.poll();
                minHeap.offer(num);
            }
        }

        // æå–ç»“æœ
        int[] result = new int[minHeap.size()];
        int index = 0;
        while (!minHeap.isEmpty()) {
            result[index++] = minHeap.poll();
        }
        return result;
    }
}
```

#### è§£æ³•äºŒï¼šå¤§é¡¶å †æ³•ï¼ˆé€‚åˆå°æ•°æ®é‡ï¼‰
```java
import java.util.PriorityQueue;
import java.util.Comparator;
import java.util.Arrays;

public class TopKUsingMaxHeap {
    public int[] findTopK(int[] nums, int k) {
        if (k <= 0 || nums == null || nums.length == 0) {
            return new int[0];
        }

        // åˆ›å»ºå¤§é¡¶å †
        PriorityQueue<Integer> maxHeap = new PriorityQueue>(Comparator.reverseOrder());

        // æ‰€æœ‰å…ƒç´ å…¥å †
        for (int num : nums) {
            maxHeap.offer(num);
        }

        // æå–å‰kä¸ªå…ƒç´ 
        int size = Math.min(k, maxHeap.size());
        int[] result = new int[size];
        for (int i = 0; i < size; i++) {
            result[i] = maxHeap.poll();
        }
        return result;
    }
}
```

### 2. æ»‘åŠ¨çª—å£æœ€å¤§å€¼
```java
import java.util.PriorityQueue;
import java.util.Comparator;
import java.util.ArrayList;
import java.util.List;

public class SlidingWindowMaximum {
    static class Element {
        int value;
        int index;

        Element(int value, int index) {
            this.value = value;
            this.index = index;
        }
    }

    public int[] maxSlidingWindow(int[] nums, int k) {
        if (nums == null || nums.length == 0 || k <= 0) {
            return new int[0];
        }

        // å¤§é¡¶å †ï¼ŒæŒ‰å€¼æ’åºï¼Œå€¼ç›¸ç­‰åˆ™æŒ‰ç´¢å¼•é™åº
        PriorityQueue<Element> maxHeap = new PriorityQueue>(
            (a, b) -> a.value != b.value ? b.value - a.value : b.index - a.index
        );

        List<Integer> result = new ArrayList>();

        for (int i = 0; i < nums.length; i++) {
            // æ·»åŠ å½“å‰å…ƒç´ 
            maxHeap.offer(new Element(nums[i], i));

            // ç§»é™¤çª—å£å¤–çš„å…ƒç´ 
            while (maxHeap.peek().index <= i - k) {
                maxHeap.poll();
            }

            // çª—å£å½¢æˆåå¼€å§‹è®°å½•ç»“æœ
            if (i >= k - 1) {
                result.add(maxHeap.peek().value);
            }
        }

        // è½¬æ¢ä¸ºæ•°ç»„
        return result.stream().mapToInt(Integer::intValue).toArray();
    }
}
```

### 3. æ•°æ®æµä¸­çš„ä¸­ä½æ•°
```java
import java.util.PriorityQueue;
import java.util.Comparator;

public class MedianFinder {
    private PriorityQueue<Integer> maxHeap; // å­˜å‚¨è¾ƒå°ä¸€åŠå…ƒç´ 
    private PriorityQueue<Integer> minHeap; // å­˜å‚¨è¾ƒå¤§ä¸€åŠå…ƒç´ 

    public MedianFinder() {
        maxHeap = new PriorityQueue<>(Comparator.reverseOrder());
        minHeap = new PriorityQueue<>(Comparator.naturalOrder());
    }

    public void addNum(int num) {
        // ä¿è¯maxHeapå…ƒç´ æ•°é‡å¤§äºç­‰äºminHeap
        if (maxHeap.isEmpty() || num <= maxHeap.peek()) {
            maxHeap.offer(num);
        } else {
            minHeap.offer(num);
        }

        // å¹³è¡¡ä¸¤ä¸ªå †çš„å¤§å°
        if (maxHeap.size() > minHeap.size() + 1) {
            minHeap.offer(maxHeap.poll());
        } else if (minHeap.size() > maxHeap.size()) {
            maxHeap.offer(minHeap.poll());
        }
    }

    public double findMedian() {
        if (maxHeap.size() == minHeap.size()) {
            return (maxHeap.peek() + minHeap.peek()) / 2.0;
        } else {
            return maxHeap.peek();
        }
    }
}
```

## ğŸ“Š å¤æ‚åº¦åˆ†æ

| æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | é€‚ç”¨åœºæ™¯ |
|------|------------|------------|----------|
| Top-Kï¼ˆå°é¡¶å †ï¼‰ | O(n log k) | O(k) | å¤§æ•°æ®é›†ï¼Œkè¾ƒå° |
| Top-Kï¼ˆå¤§é¡¶å †ï¼‰ | O(n + k log n) | O(n) | å°æ•°æ®é›†ï¼Œkè¾ƒå¤§ |
| æ»‘åŠ¨çª—å£æœ€å¤§å€¼ | O(n log k) | O(k) | çª—å£å¤§å°ä¸ºkçš„æ•°æ®æµ |
| ä¸­ä½æ•°ç»´æŠ¤ | O(log n) | O(n) | åŠ¨æ€æ•°æ®æµ |
| å †æ’åº | O(n log n) | O(1) | åŸåœ°æ’åºï¼Œä¸ç¨³å®š |
| ä¼˜å…ˆé˜Ÿåˆ— | O(log n) | O(n) | ä»»åŠ¡è°ƒåº¦ï¼Œäº‹ä»¶é©±åŠ¨ |

> æ³¨ï¼š
> - å°é¡¶å †æ³•æ±‚è§£Top-Ké—®é¢˜åœ¨nå¾ˆå¤§æ—¶ä¼˜åŠ¿æ˜æ˜¾
> - åŒå †æ³•ç»´æŠ¤ä¸­ä½æ•°å®ç°äº†O(log n)çš„æ’å…¥å’ŒO(1)çš„æŸ¥è¯¢
> - æ»‘åŠ¨çª—å£é—®é¢˜ä¸­ï¼Œå †è§£æ³•å¹¶éæœ€ä¼˜ï¼Œå¯ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–è‡³O(n)

## ğŸ” åº”ç”¨åœºæ™¯

1. **æ•°æ®å¤„ç†**ï¼š
   - æµ·é‡æ•°æ®Top-Ké—®é¢˜ï¼ˆçƒ­é—¨å•†å“ã€é«˜é¢‘è¯æ±‡ï¼‰
   - æ•°æ®æµä¸­çš„ä¸­ä½æ•°ã€ç™¾åˆ†ä½æ•°è®¡ç®—
   - å¼‚å¸¸å€¼æ£€æµ‹ï¼ˆåŸºäºåˆ†ä½æ•°ï¼‰

2. **ä»»åŠ¡è°ƒåº¦**ï¼š
   - æ“ä½œç³»ç»Ÿè¿›ç¨‹è°ƒåº¦ï¼ˆä¼˜å…ˆçº§é˜Ÿåˆ—ï¼‰
   - ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿï¼ˆæŒ‰ä¼˜å…ˆçº§æ‰§è¡Œï¼‰
   - å®æ—¶ç³»ç»Ÿä¸­çš„äº‹ä»¶å¤„ç†

3. **å›¾ç®—æ³•**ï¼š
   - Dijkstraæœ€çŸ­è·¯å¾„ç®—æ³•
   - Primæœ€å°ç”Ÿæˆæ ‘ç®—æ³•
   - æœ€å¤§æµé—®é¢˜ä¸­çš„ä¼˜å…ˆç­–ç•¥

4. **æœºå™¨å­¦ä¹ **ï¼š
   - æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ï¼ˆç»´æŠ¤å‚æ•°ä¼˜å…ˆçº§ï¼‰
   - Kè¿‘é‚»ç®—æ³•ï¼ˆé«˜æ•ˆæœç´¢æœ€è¿‘é‚»ï¼‰
   - å†³ç­–æ ‘æ„å»ºï¼ˆç‰¹å¾é€‰æ‹©ï¼‰

5. **ç¼“å­˜ç³»ç»Ÿ**ï¼š
   - ç¼“å­˜æ·˜æ±°ç­–ç•¥ï¼ˆLFU, LRUçš„å˜ç§å®ç°ï¼‰
   - çƒ­ç‚¹æ•°æ®è¯†åˆ«ä¸ç¼“å­˜

6. **æ•°æ®åº“**ï¼š
   - SQLä¸­çš„ORDER BYå’ŒLIMITä¼˜åŒ–
   - èšåˆå‡½æ•°ï¼ˆMAX, MIN, TOP Nï¼‰å®ç°
   - ç´¢å¼•ç»“æ„ä¸­çš„æ’åº

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å †çš„é€‰æ‹©**ï¼š
   - å¤§é¡¶å †é€‚åˆè·å–æœ€å¤§å€¼ï¼Œå°é¡¶å †é€‚åˆè·å–æœ€å°å€¼
   - åŒå †ç»„åˆé€‚åˆä¸­ä½æ•°ç­‰ä¸­é—´å€¼æŸ¥è¯¢
   - é«˜çº§å †ç»“æ„ï¼ˆå¦‚æ–æ³¢é‚£å¥‘å †ï¼‰é€‚åˆé¢‘ç¹åˆå¹¶æ“ä½œ

2. **è¾¹ç•Œå¤„ç†**ï¼š
   - ç©ºå †æ“ä½œä¼šå¯¼è‡´å¼‚å¸¸ï¼Œéœ€æå‰æ£€æŸ¥
   - æ•°æ®æµä¸ºç©ºæ—¶çš„ä¸­ä½æ•°è¿”å›ç­–ç•¥
   - Top-Ké—®é¢˜ä¸­k=0æˆ–kå¤§äºæ•°æ®é‡çš„æƒ…å†µ

3. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - åŸå§‹æ•°ç»„æ„å»ºå †å¯é€šè¿‡heapifyæ“ä½œä¼˜åŒ–è‡³O(n)
   - é¿å…é¢‘ç¹çš„å †å¤§å°è°ƒæ•´
   - å¤§æ•°æ®é‡æ—¶è€ƒè™‘å¹¶è¡Œå †å®ç°

4. **å†…å­˜è€ƒé‡**ï¼š
   - å †æ’åºæ˜¯åŸåœ°æ’åºï¼Œé€‚åˆå†…å­˜å—é™åœºæ™¯
   - ä¼˜å…ˆé˜Ÿåˆ—å®ç°å¯èƒ½éœ€è¦é¢å¤–å†…å­˜
   - æ»‘åŠ¨çª—å£é—®é¢˜ä¸­æ³¨æ„æ¸…ç†è¿‡æœŸå…ƒç´ 

5. **ç¨³å®šæ€§é—®é¢˜**ï¼š
   - å †æ’åºæ˜¯ä¸ç¨³å®šæ’åº
   - å¤„ç†å¯¹è±¡æ’åºæ—¶éœ€æ³¨æ„ç›¸ç­‰å…ƒç´ çš„é¡ºåº

## ğŸ“ æœ€ä½³å®è·µ

1. **é€‰æ‹©åˆé€‚çš„å®ç°**ï¼š
   - Javaä¸­ä¼˜å…ˆä½¿ç”¨`PriorityQueue`ï¼Œè€Œéæ‰‹åŠ¨å®ç°
   - å¤§æ•°æ®é‡Top-Ké—®é¢˜ä¼˜å…ˆä½¿ç”¨å°é¡¶å †æ³•
   - æ»‘åŠ¨çª—å£æœ€å¤§å€¼è€ƒè™‘ä½¿ç”¨å•è°ƒé˜Ÿåˆ—æ›¿ä»£å †

2. **æ€§èƒ½è°ƒä¼˜**ï¼š
   - é¢„åˆ†é…å †å®¹é‡å‡å°‘æ‰©å®¹å¼€é”€
   - è‡ªå®šä¹‰æ¯”è¾ƒå™¨æ—¶ä¼˜åŒ–æ¯”è¾ƒé€»è¾‘
   - æ‰¹é‡æ“ä½œæ—¶è€ƒè™‘å…ˆæ’åºåå¤„ç†

3. **é«˜çº§åº”ç”¨æŠ€å·§**ï¼š
   - ä½¿ç”¨å»¶è¿Ÿåˆ é™¤ç­–ç•¥å¤„ç†å †ä¸­çš„æ— æ•ˆå…ƒç´ 
   - ç»“åˆå“ˆå¸Œè¡¨å¿«é€ŸæŸ¥æ‰¾å †ä¸­å…ƒç´ 
   - å¤šçº§å †ç»“æ„å¤„ç†å¤æ‚ä¼˜å…ˆçº§åœºæ™¯

4. **çº¿ç¨‹å®‰å…¨**ï¼š
   - å¤šçº¿ç¨‹ç¯å¢ƒä½¿ç”¨`PriorityBlockingQueue`
   - æˆ–ä½¿ç”¨é”æœºåˆ¶ä¿æŠ¤æ™®é€šå †æ“ä½œ

5. **ç®—æ³•é€‰æ‹©æŒ‡å—**ï¼š
   - é™æ€æ•°æ®æ’åºï¼šä¼˜å…ˆè€ƒè™‘å¿«é€Ÿæ’åº
   - åŠ¨æ€æ•°æ®æœ€å€¼ï¼šå¿…é¡»ä½¿ç”¨å †æˆ–ä¼˜å…ˆé˜Ÿåˆ—
   - æµ·é‡æ•°æ®å¤„ç†ï¼šç»“åˆå¤–éƒ¨æ’åºå’Œå †

---

> **å®ŒæˆçŠ¶æ€**ï¼šæœ¬æ–‡æ¡£å·²å®Œå–„å †çš„é«˜çº§åº”ç”¨å†…å®¹ï¼ŒåŒ…æ‹¬Top-Ké—®é¢˜çš„å¤šç§è§£æ³•ã€æ»‘åŠ¨çª—å£æœ€å¤§å€¼ã€æ•°æ®æµä¸­ä½æ•°ç­‰æ ¸å¿ƒåº”ç”¨åœºæ™¯çš„å®ç°ä»£ç ä¸åˆ†æï¼Œæ¶µç›–å †åœ¨æ•°æ®å¤„ç†ã€ä»»åŠ¡è°ƒåº¦ã€ç®—æ³•ä¼˜åŒ–ç­‰é¢†åŸŸçš„å®è·µï¼Œå¯ä½œä¸ºå †æ•°æ®ç»“æ„é«˜çº§åº”ç”¨çš„å®Œæ•´å­¦ä¹ å‚è€ƒã€‚