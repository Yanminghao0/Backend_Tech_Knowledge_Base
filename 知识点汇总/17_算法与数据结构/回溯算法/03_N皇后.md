# Nçš‡åé—®é¢˜

> Nçš‡åé—®é¢˜æ˜¯å›æº¯ç®—æ³•çš„ç»å…¸æ¡ˆä¾‹ï¼Œè¦æ±‚åœ¨NÃ—Nçš„æ£‹ç›˜ä¸Šæ”¾ç½®Nä¸ªçš‡åï¼Œä½¿å¾—å®ƒä»¬ä¸èƒ½äº’ç›¸æ”»å‡»ã€‚å³ä»»æ„ä¸¤ä¸ªçš‡åä¸èƒ½å¤„äºåŒä¸€è¡Œã€åŒä¸€åˆ—æˆ–åŒä¸€æ–œçº¿ä¸Šã€‚è¯¥é—®é¢˜æœ€æ—©ç”±å¾·å›½æ•°å­¦å®¶é«˜æ–¯äº1848å¹´æå‡ºã€‚

---

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯
- **ç±»åˆ«**ï¼šå›æº¯ç®—æ³•ã€æ£‹ç›˜é—®é¢˜ã€çŠ¶æ€ç©ºé—´æœç´¢
- **éš¾åº¦**ï¼šå›°éš¾
- **æ ¸å¿ƒæ€æƒ³**ï¼šé€šè¿‡å›æº¯å°è¯•åœ¨æ¯è¡Œæ”¾ç½®çš‡åï¼Œå¹¶ä½¿ç”¨å‰ªæé¿å…æ— æ•ˆä½ç½®
- **æ—¶é—´å¤æ‚åº¦**ï¼šO(N!)ï¼ˆæœ€åæƒ…å†µï¼‰
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(N)ï¼ˆé€’å½’æ ˆå’ŒçŠ¶æ€è®°å½•ï¼‰
- **å…³é”®è¯**ï¼šå›æº¯ã€å‰ªæã€çŠ¶æ€å‹ç¼©ã€æ£‹ç›˜é—®é¢˜ã€é€’å½’

## ğŸ¯ é—®é¢˜åˆ†æ
Nçš‡åé—®é¢˜çš„æœ¬è´¨æ˜¯åœ¨ä¸€ä¸ªNÃ—Nçš„ç½‘æ ¼ä¸­å¯»æ‰¾Nä¸ªä½ç½®ï¼Œæ»¡è¶³ä»¥ä¸‹çº¦æŸæ¡ä»¶ï¼š
1. æ¯è¡Œæ°å¥½æœ‰ä¸€ä¸ªçš‡å
2. æ¯åˆ—æ°å¥½æœ‰ä¸€ä¸ªçš‡å
3. æ¯æ¡å¯¹è§’çº¿ä¸Šæœ€å¤šæœ‰ä¸€ä¸ªçš‡å

è§£å†³Nçš‡åé—®é¢˜çš„å…³é”®æŒ‘æˆ˜ï¼š
- **å†²çªæ£€æµ‹**ï¼šå¦‚ä½•é«˜æ•ˆåˆ¤æ–­ä¸€ä¸ªä½ç½®æ˜¯å¦ä¸å·²æ”¾ç½®çš„çš‡åå†²çª
- **æœç´¢æ•ˆç‡**ï¼šå¦‚ä½•é€šè¿‡å‰ªæå‡å°‘æ— æ•ˆæœç´¢
- **çŠ¶æ€è¡¨ç¤º**ï¼šå¦‚ä½•é«˜æ•ˆè¡¨ç¤ºæ£‹ç›˜çŠ¶æ€

ç»å…¸è§£é¢˜æ€è·¯ï¼š
1. **æŒ‰è¡Œæ”¾ç½®**ï¼šä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œé€è¡Œæ”¾ç½®çš‡å
2. **åˆ—ä¸å¯¹è§’çº¿æ£€æŸ¥**ï¼šå¯¹æ¯ä¸€è¡Œï¼Œå°è¯•åœ¨ä¸åŒåˆ—æ”¾ç½®çš‡åï¼Œæ£€æŸ¥æ˜¯å¦ä¸å·²æ”¾ç½®çš„çš‡åå†²çª
3. **å›æº¯æ¢ç´¢**ï¼šå¦‚æœå½“å‰ä½ç½®æœ‰æ•ˆåˆ™ç»§ç»­ä¸‹ä¸€è¡Œï¼Œå¦åˆ™å›æº¯åˆ°ä¸Šä¸€è¡Œå°è¯•å…¶ä»–ä½ç½®
4. **ç»“æœæ”¶é›†**ï¼šå½“æˆåŠŸæ”¾ç½®Nä¸ªçš‡åæ—¶ï¼Œè®°å½•å½“å‰æ£‹ç›˜çŠ¶æ€

## ğŸ’» ä»£ç å®ç°
### Javaå®ç°ï¼ˆNçš‡åç»å…¸è§£æ³•ï¼‰
#### 1. åŸºç¡€å›æº¯å®ç°
```java
import java.util.*;

public class NQueens {
    public List<List<String>> solveNQueens(int n) {
        List<List<String>> result = new ArrayList<>();
        // è®°å½•æ¯è¡Œçš‡åçš„åˆ—ä½ç½®
        int[] queens = new int[n];
        Arrays.fill(queens, -1);
        // è®°å½•åˆ—æ˜¯å¦è¢«å ç”¨
        boolean[] columns = new boolean[n];
        // è®°å½•ä¸»å¯¹è§’çº¿æ˜¯å¦è¢«å ç”¨ï¼ˆè¡Œ-åˆ—=å¸¸æ•°ï¼‰
        boolean[] mainDiagonals = new boolean[2 * n - 1];
        // è®°å½•æ¬¡å¯¹è§’çº¿æ˜¯å¦è¢«å ç”¨ï¼ˆè¡Œ+åˆ—=å¸¸æ•°ï¼‰
        boolean[] antiDiagonals = new boolean[2 * n - 1];
        backtrack(result, queens, n, 0, columns, mainDiagonals, antiDiagonals);
        return result;
    }

    private void backtrack(List<List<String>> result, int[] queens, int n, int row, 
                          boolean[] columns, boolean[] mainDiagonals, boolean[] antiDiagonals) {
        // ç»ˆæ­¢æ¡ä»¶ï¼šæ‰€æœ‰è¡Œéƒ½å·²æ”¾ç½®çš‡å
        if (row == n) {
            result.add(generateBoard(queens, n));
            return;
        }

        // å°è¯•åœ¨å½“å‰è¡Œçš„æ¯ä¸€åˆ—æ”¾ç½®çš‡å
        for (int col = 0; col < n; col++) {
            // è®¡ç®—å¯¹è§’çº¿ç´¢å¼•
            int mainDiagonalIdx = row - col + n - 1;
            int antiDiagonalIdx = row + col;

            // æ£€æŸ¥å†²çª
            if (columns[col] || mainDiagonals[mainDiagonalIdx] || antiDiagonals[antiDiagonalIdx]) {
                continue;
            }

            // æ”¾ç½®çš‡å
            queens[row] = col;
            columns[col] = true;
            mainDiagonals[mainDiagonalIdx] = true;
            antiDiagonals[antiDiagonalIdx] = true;

            // é€’å½’å¤„ç†ä¸‹ä¸€è¡Œ
            backtrack(result, queens, n, row + 1, columns, mainDiagonals, antiDiagonals);

            // å›æº¯ï¼šæ’¤é”€é€‰æ‹©
            queens[row] = -1;
            columns[col] = false;
            mainDiagonals[mainDiagonalIdx] = false;
            antiDiagonals[antiDiagonalIdx] = false;
        }
    }

    // ç”Ÿæˆæ£‹ç›˜è¡¨ç¤º
    private List<String> generateBoard(int[] queens, int n) {
        List<String> board = new ArrayList<>();
        for (int i = 0; i < n; i++) {
            char[] row = new char[n];
            Arrays.fill(row, '.');
            row[queens[i]] = 'Q';
            board.add(new String(row));
        }
        return board;
    }

    public static void main(String[] args) {
        NQueens solution = new NQueens();
        List<List<String>> result = solution.solveNQueens(4);
        System.out.println("4çš‡åé—®é¢˜çš„è§£å…±æœ‰" + result.size() + "ç§ï¼š");
        for (List<String> board : result) {
            System.out.println("\nè§£å†³æ–¹æ¡ˆï¼š");
            for (String row : board) {
                System.out.println(row);
            }
        }
    }
}
```

#### 2. ä½è¿ç®—ä¼˜åŒ–å®ç°
```java
import java.util.*;

public class NQueensBitOptimization {
    public List<List<String>> solveNQueens(int n) {
        List<List<String>> result = new ArrayList<>();
        // ä½¿ç”¨ä½è¿ç®—è®°å½•åˆ—ã€ä¸»å¯¹è§’çº¿å’Œæ¬¡å¯¹è§’çº¿çš„å ç”¨æƒ…å†µ
        backtrack(result, new int[n], n, 0, 0, 0, 0);
        return result;
    }

    private void backtrack(List<List<String>> result, int[] queens, int n, int row, 
                          int columnMask, int mainDiagonalMask, int antiDiagonalMask) {
        if (row == n) {
            result.add(generateBoard(queens, n));
            return;
        }

        // è®¡ç®—å¯ç”¨åˆ—ï¼ˆä½ä¸º1è¡¨ç¤ºå¯ç”¨ï¼‰
        int availableColumns = ((1 << n) - 1) & (~(columnMask | mainDiagonalMask | antiDiagonalMask));

        while (availableColumns != 0) {
            // å–å‡ºæœ€å³è¾¹çš„1
            int position = availableColumns & (-availableColumns);
            // æ¸…é™¤æœ€å³è¾¹çš„1
            availableColumns ^= position;
            // è®¡ç®—åˆ—ç´¢å¼•
            int col = Integer.bitCount(position - 1);

            queens[row] = col;
            // é€’å½’å¤„ç†ä¸‹ä¸€è¡Œ
            backtrack(result, queens, n, row + 1,
                    columnMask | position,
                    (mainDiagonalMask | position) << 1,
                    (antiDiagonalMask | position) >> 1);
            queens[row] = -1;
        }
    }

    private List<String> generateBoard(int[] queens, int n) {
        List<String> board = new ArrayList<>();
        for (int i = 0; i < n; i++) {
            char[] row = new char[n];
            Arrays.fill(row, '.');
            row[queens[i]] = 'Q';
            board.add(new String(row));
        }
        return board;
    }
}
```

## ğŸ“Š å‰ªæç­–ç•¥
Nçš‡åé—®é¢˜çš„å‰ªæç­–ç•¥ç›´æ¥å½±å“ç®—æ³•æ•ˆç‡ï¼Œå¸¸ç”¨ä¼˜åŒ–æ–¹æ³•åŒ…æ‹¬ï¼š

### 1. çŠ¶æ€æ ‡è®°å‰ªæ
- **åŸç†**ï¼šä½¿ç”¨æ•°ç»„æˆ–ä½è¿ç®—è®°å½•å·²å ç”¨çš„åˆ—å’Œå¯¹è§’çº¿
- **å®ç°**ï¼š
  ```java
  // åˆ—å†²çªæ£€æŸ¥
  if (columns[col]) continue;
  // ä¸»å¯¹è§’çº¿å†²çªæ£€æŸ¥ï¼ˆè¡Œ-åˆ—=å¸¸æ•°ï¼‰
  if (mainDiagonals[row - col + n - 1]) continue;
  // æ¬¡å¯¹è§’çº¿å†²çªæ£€æŸ¥ï¼ˆè¡Œ+åˆ—=å¸¸æ•°ï¼‰
  if (antiDiagonals[row + col]) continue;
  ```
- **æ•ˆæœ**ï¼šå°†å†²çªæ£€æŸ¥ä»O(n)é™ä¸ºO(1)

### 2. ä½è¿ç®—ä¼˜åŒ–
- **åŸç†**ï¼šä½¿ç”¨æ•´æ•°çš„äºŒè¿›åˆ¶ä½è¡¨ç¤ºçŠ¶æ€ï¼Œå¤§å¹…å‡å°‘å†…å­˜å ç”¨å¹¶æé«˜è¿ç®—é€Ÿåº¦
- **å…³é”®æ“ä½œ**ï¼š
  - è®¡ç®—å¯ç”¨åˆ—ï¼š`availableColumns = ((1 << n) - 1) & (~(columnMask | mainDiagonalMask | antiDiagonalMask))`
  - å–å‡ºæœ€å³å¯ç”¨åˆ—ï¼š`position = availableColumns & (-availableColumns)`
  - æ›´æ–°å¯¹è§’çº¿æ©ç ï¼šä¸»å¯¹è§’çº¿å·¦ç§»1ä½ï¼Œæ¬¡å¯¹è§’çº¿å³ç§»1ä½
- **ä¼˜åŠ¿**ï¼šä½è¿ç®—æ¯”æ•°ç»„æ“ä½œæ›´å¿«ï¼Œä»£ç æ›´ç®€æ´

### 3. å¯¹ç§°å‰ªæ
- **åŸç†**ï¼šåˆ©ç”¨æ£‹ç›˜çš„å¯¹ç§°æ€§å‡å°‘é‡å¤æœç´¢
- **å®ç°**ï¼šåªæœç´¢å‰åŠåˆ—ï¼Œæ ¹æ®å¯¹ç§°æ€§ç”Ÿæˆå…¶ä»–è§£
- **é€‚ç”¨åœºæ™¯**ï¼šå½“nä¸ºå¶æ•°æ—¶å¯å‡å°‘ä¸€åŠæœç´¢é‡

### 4. å¯å‘å¼æ’åº
- **åŸç†**ï¼šä¼˜å…ˆå°è¯•å†²çªè¾ƒå°‘çš„åˆ—
- **å®ç°**ï¼šæ ¹æ®åˆ—çš„å†²çªå¯èƒ½æ€§æ’åºï¼Œä¼˜å…ˆå°è¯•ä¸­é—´åˆ—
- **æ•ˆæœ**ï¼šåœ¨æŸäº›æƒ…å†µä¸‹å¯æ˜¾è‘—åŠ å¿«æ‰¾åˆ°ç¬¬ä¸€ä¸ªè§£çš„é€Ÿåº¦

## ğŸ” ç»å…¸é¢˜ç›®
| é¢˜ç›® | éš¾åº¦ | è€ƒç‚¹ | é“¾æ¥ |
|------|------|------|------|
| Nçš‡å | å›°éš¾ | åŸºç¡€å›æº¯å®ç° | [LeetCode 51](https://leetcode-cn.com/problems/n-queens/) |
| Nçš‡å II | å›°éš¾ | è®¡æ•°é—®é¢˜ã€ä½è¿ç®—ä¼˜åŒ– | [LeetCode 52](https://leetcode-cn.com/problems/n-queens-ii/) |
| è§£æ•°ç‹¬ | å›°éš¾ | æ‰©å±•åº”ç”¨ã€å¤šçº¦æŸå›æº¯ | [LeetCode 37](https://leetcode-cn.com/problems/sudoku-solver/) |
| å…«çš‡åæ‹¼å›¾ | ä¸­ç­‰ | å±€éƒ¨æœç´¢ã€å¯å‘å¼ç®—æ³• | [LeetCode é¢è¯•é¢˜ 17.22](https://leetcode-cn.com/problems/word-transformer-lcci/) |
| çŸ©é˜µä¸­çš„æœ€é•¿é€’å¢è·¯å¾„ | å›°éš¾ | å›æº¯ä¸åŠ¨æ€è§„åˆ’ç»“åˆ | [LeetCode 329](https://leetcode-cn.com/problems/longest-increasing-path-in-a-matrix/) |

## âš ï¸ æ³¨æ„äº‹é¡¹
1. **å¯¹è§’çº¿è¡¨ç¤º**ï¼šä¸»å¯¹è§’çº¿ï¼ˆå·¦ä¸Šåˆ°å³ä¸‹ï¼‰å¯ç”¨row-colè¡¨ç¤ºï¼Œæ¬¡å¯¹è§’çº¿ï¼ˆå³ä¸Šåˆ°å·¦ä¸‹ï¼‰å¯ç”¨row+colè¡¨ç¤º
2. **æ•°ç»„åˆå§‹åŒ–**ï¼šç¡®ä¿çš‡åä½ç½®æ•°ç»„åˆå§‹åŒ–ä¸º-1æˆ–å…¶ä»–æ— æ•ˆå€¼
3. **ä½è¿ç®—è¾¹ç•Œ**ï¼šä½è¿ç®—å®ç°æ—¶æ³¨æ„æ•´æ•°æº¢å‡ºé—®é¢˜ï¼Œné€šå¸¸ä¸è¶…è¿‡32
4. **æ£‹ç›˜ç”Ÿæˆ**ï¼šè½¬æ¢çš‡åä½ç½®æ•°ç»„ä¸ºæ£‹ç›˜å­—ç¬¦ä¸²è¡¨ç¤ºæ—¶æ³¨æ„æ ¼å¼æ­£ç¡®
5. **é€’å½’ç»ˆæ­¢æ¡ä»¶**ï¼šå½“row == næ—¶è¡¨ç¤ºæˆåŠŸæ”¾ç½®æ‰€æœ‰çš‡å
6. **å›æº¯çŠ¶æ€æ¢å¤**ï¼šä½¿ç”¨æ•°ç»„å®ç°æ—¶ï¼Œå›æº¯åè¦æ¸…é™¤ä¹‹å‰çš„çŠ¶æ€æ ‡è®°
7. **æ—¶é—´å¤æ‚åº¦**ï¼šNçš‡åé—®é¢˜çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N!)ï¼Œn=12æ—¶çº¦4790ä¸‡ç§å¯èƒ½
8. **ç©ºé—´ä¼˜åŒ–**ï¼šä¸éœ€è¦å­˜å‚¨å®Œæ•´æ£‹ç›˜ï¼Œåªéœ€è®°å½•æ¯è¡Œçš‡åçš„åˆ—ä½ç½®

## ğŸ“ æœ€ä½³å®è·µ
- **ç†è§£å†²çªæ£€æµ‹**ï¼šæŒæ¡è¡Œã€åˆ—ã€å¯¹è§’çº¿å†²çªçš„æ•°å­¦è¡¨ç¤º
- **ä½è¿ç®—æŒæ¡**ï¼šå­¦ä¼šä½¿ç”¨ä½è¿ç®—ä¼˜åŒ–å›æº¯ç®—æ³•
- **çŠ¶æ€è¡¨ç¤ºä¼˜åŒ–**ï¼šé€‰æ‹©åˆé€‚çš„çŠ¶æ€è¡¨ç¤ºæ–¹æ³•ï¼Œå¹³è¡¡å¯è¯»æ€§å’Œæ•ˆç‡
- **é€’å½’æ ‘å¯è§†åŒ–**ï¼šç”»å‡ºNçš‡åé—®é¢˜çš„é€’å½’æ ‘ï¼Œç†è§£å›æº¯è¿‡ç¨‹
- **æ¸è¿›å¼ç¼–ç¨‹**ï¼šå…ˆå®ç°åŸºç¡€ç‰ˆæœ¬ï¼Œå†é€æ­¥ä¼˜åŒ–
- **è¾¹ç•Œæƒ…å†µå¤„ç†**ï¼šæ³¨æ„n=0ã€n=1ç­‰ç‰¹æ®Šæƒ…å†µçš„å¤„ç†
- **å¤šç§è§£æ³•å¯¹æ¯”**ï¼šæ¯”è¾ƒä¸åŒå®ç°æ–¹æ³•çš„æ—¶é—´å’Œç©ºé—´æ•ˆç‡
- **æ‰©å±•åº”ç”¨**ï¼šå°†Nçš‡åçš„å›æº¯æ€æƒ³åº”ç”¨åˆ°å…¶ä»–æ£‹ç›˜é—®é¢˜

---