# DFSæ·±åº¦ä¼˜å…ˆæœç´¢

æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDepth-First Search, DFSï¼‰æ˜¯ä¸€ç§å›¾éå†ç®—æ³•ï¼Œå®ƒæ²¿ç€æ ‘çš„æ·±åº¦ä¼˜å…ˆéå†æ ‘çš„èŠ‚ç‚¹ï¼Œå°½å¯èƒ½æ·±åœ°æœç´¢æ ‘çš„åˆ†æ”¯ã€‚å½“èŠ‚ç‚¹vçš„æ‰€æœ‰è¾¹éƒ½å·²è¢«æ¢å¯»è¿‡ï¼Œæœç´¢å°†å›æº¯åˆ°å‘ç°èŠ‚ç‚¹vçš„é‚£æ¡è¾¹çš„èµ·å§‹èŠ‚ç‚¹ã€‚DFSæ˜¯ä¸€ç§é‡è¦çš„å›¾ç®—æ³•ï¼Œå¹¿æ³›åº”ç”¨äºè·¯å¾„æŸ¥æ‰¾ã€æ‹“æ‰‘æ’åºã€è¿é€šæ€§åˆ†æç­‰é¢†åŸŸã€‚

---

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯
- **å®šä¹‰**ï¼šä¸€ç§æ²¿ç€å›¾çš„æ·±åº¦ä¼˜å…ˆéå†èŠ‚ç‚¹çš„æœç´¢ç®—æ³•
- **æ ¸å¿ƒæ€æƒ³**ï¼šå°½å¯èƒ½æ·±åœ°æœç´¢å½“å‰è·¯å¾„ï¼Œç›´åˆ°æ— æ³•ç»§ç»­å†å›æº¯
- **å®ç°æ–¹å¼**ï¼šé€’å½’å®ç°ï¼ˆéšå¼æ ˆï¼‰ã€è¿­ä»£å®ç°ï¼ˆæ˜¾å¼æ ˆï¼‰
- **æ•°æ®ç»“æ„**ï¼šæ ˆï¼ˆStackï¼‰
- **æ—¶é—´å¤æ‚åº¦**ï¼šO(V + E)ï¼Œå…¶ä¸­Væ˜¯é¡¶ç‚¹æ•°ï¼ŒEæ˜¯è¾¹æ•°
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(V)ï¼Œç”¨äºå­˜å‚¨è®¿é—®æ ‡è®°å’Œé€’å½’æ ˆ/æ˜¾å¼æ ˆ
- **ç‰¹ç‚¹**ï¼šä¸ä¿è¯æ‰¾åˆ°æœ€çŸ­è·¯å¾„ï¼Œä½†ç©ºé—´æ•ˆç‡é€šå¸¸é«˜äºBFS
- **ç›¸å…³ç®—æ³•**ï¼šBFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰ã€DFSå˜ç§ï¼ˆå‰åºã€ä¸­åºã€ååºéå†ï¼‰

## ğŸ¯ ç®—æ³•åŸç†

### åŸºæœ¬æµç¨‹
1. ä»èµ·å§‹èŠ‚ç‚¹å¼€å§‹ï¼Œå°†å…¶æ ‡è®°ä¸ºå·²è®¿é—®
2. é€‰æ‹©ä¸€ä¸ªæœªè®¿é—®çš„é‚»æ¥èŠ‚ç‚¹ï¼Œé€’å½’åœ°è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢
3. å¦‚æœå½“å‰èŠ‚ç‚¹æ²¡æœ‰æœªè®¿é—®çš„é‚»æ¥èŠ‚ç‚¹ï¼Œåˆ™å›æº¯åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹
4. é‡å¤æ­¥éª¤2-3ï¼Œç›´åˆ°æ‰€æœ‰å¯è¾¾èŠ‚ç‚¹éƒ½è¢«è®¿é—®

### é€’å½’å®ç°åŸç†
- åˆ©ç”¨å‡½æ•°è°ƒç”¨æ ˆä½œä¸ºéšå¼æ ˆ
- æ¯è®¿é—®ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç«‹å³é€’å½’è®¿é—®å…¶æœªè®¿é—®çš„é‚»æ¥èŠ‚ç‚¹
- é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼šå½“å‰èŠ‚ç‚¹æ²¡æœ‰æœªè®¿é—®çš„é‚»æ¥èŠ‚ç‚¹

### è¿­ä»£å®ç°åŸç†
- ä½¿ç”¨æ˜¾å¼æ ˆæ•°æ®ç»“æ„
- å°†èµ·å§‹èŠ‚ç‚¹å…¥æ ˆå¹¶æ ‡è®°ä¸ºå·²è®¿é—®
- å½“æ ˆä¸ä¸ºç©ºæ—¶ï¼Œå¼¹å‡ºæ ˆé¡¶èŠ‚ç‚¹å¹¶è®¿é—®å…¶æ‰€æœ‰æœªè®¿é—®çš„é‚»æ¥èŠ‚ç‚¹
- å°†æœªè®¿é—®çš„é‚»æ¥èŠ‚ç‚¹å…¥æ ˆå¹¶æ ‡è®°ä¸ºå·²è®¿é—®

### å›¾çš„è¡¨ç¤ºæ–¹å¼
- **é‚»æ¥çŸ©é˜µ**ï¼šäºŒç»´æ•°ç»„è¡¨ç¤ºå›¾ï¼Œé€‚ç”¨äºç¨ å¯†å›¾
- **é‚»æ¥è¡¨**ï¼šæ•°ç»„+é“¾è¡¨è¡¨ç¤ºå›¾ï¼Œé€‚ç”¨äºç¨€ç–å›¾
- **é‚»æ¥é›†**ï¼šæ•°ç»„+é›†åˆè¡¨ç¤ºå›¾ï¼Œä¾¿äºå¿«é€ŸæŸ¥æ‰¾é‚»æ¥èŠ‚ç‚¹

## ğŸ’» ä»£ç å®ç°

### é‚»æ¥è¡¨è¡¨ç¤ºçš„å›¾ç»“æ„
```python
class Graph:
    def __init__(self, num_vertices):
        self.V = num_vertices  # é¡¶ç‚¹æ•°é‡
        self.adj = [[] for _ in range(num_vertices)]  # é‚»æ¥è¡¨

    def add_edge(self, u, v):
        """æ·»åŠ æ— å‘å›¾çš„è¾¹"""
        self.adj[u].append(v)
        self.adj[v].append(u)

    def add_directed_edge(self, u, v):
        """æ·»åŠ æœ‰å‘å›¾çš„è¾¹"""
        self.adj[u].append(v)
```

### é€’å½’å®ç°DFS
```python
def dfs_recursive(graph, start, visited=None):
    """é€’å½’å®ç°çš„DFSéå†"
    if visited is None:
        visited = set()
    visited.add(start)
    print(start, end=' ')

    # éå†æ‰€æœ‰æœªè®¿é—®çš„é‚»æ¥èŠ‚ç‚¹
    for neighbor in graph.adj[start]:
        if neighbor not in visited:
            dfs_recursive(graph, neighbor, visited)
    return visited
```

### è¿­ä»£å®ç°DFS
```python
def dfs_iterative(graph, start):
    """è¿­ä»£å®ç°çš„DFSéå†"
    visited = set()
    stack = [start]
    visited.add(start)

    while stack:
        # å¼¹å‡ºæ ˆé¡¶èŠ‚ç‚¹
        vertex = stack.pop()
        print(vertex, end=' ')

        # å°†æœªè®¿é—®çš„é‚»æ¥èŠ‚ç‚¹å…¥æ ˆ
        # é€†åºæ·»åŠ ï¼Œç¡®ä¿æŒ‰é¡ºåºè®¿é—®
        for neighbor in reversed(graph.adj[vertex]):
            if neighbor not in visited:
                visited.add(neighbor)
                stack.append(neighbor)
    return visited
```

### åº”ç”¨ï¼šåˆ¤æ–­å›¾çš„è¿é€šæ€§
```python
def is_connected(graph):
    """åˆ¤æ–­æ— å‘å›¾æ˜¯å¦è¿é€š"
    if graph.V == 0:
        return True
    visited = dfs_recursive(graph, 0)
    return len(visited) == graph.V
```

### åº”ç”¨ï¼šå¯»æ‰¾ä¸¤ç‚¹é—´çš„è·¯å¾„
```python
def find_path_dfs(graph, start, end, path=None):
    """å¯»æ‰¾ä¸¤ç‚¹é—´çš„ä¸€æ¡è·¯å¾„"
    if path is None:
        path = []
    path.append(start)

    if start == end:
        return path

    for neighbor in graph.adj[start]:
        if neighbor not in path:
            new_path = find_path_dfs(graph, neighbor, end, path.copy())
            if new_path:
                return new_path
    return None  # æ²¡æœ‰æ‰¾åˆ°è·¯å¾„
```

### åº”ç”¨ï¼šæ‹“æ‰‘æ’åºï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰
```python
def topological_sort(graph):
    """å¯¹æœ‰å‘æ— ç¯å›¾è¿›è¡Œæ‹“æ‰‘æ’åº"
    visited = set()
    stack = []

    def dfs_topo(v):
        visited.add(v)
        for neighbor in graph.adj[v]:
            if neighbor not in visited:
                dfs_topo(neighbor)
        stack.append(v)

    for v in range(graph.V):
        if v not in visited:
            dfs_topo(v)
    return stack[::-1]  # åè½¬æ ˆå¾—åˆ°æ‹“æ‰‘æ’åºç»“æœ
```

## ğŸ“Š å¤æ‚åº¦åˆ†æ

| å®ç°æ–¹å¼ | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|----------|------------|------------|------|------|
| é€’å½’DFS | O(V + E) | O(V) | ä»£ç ç®€æ´ï¼Œå®ç°ç®€å• | å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºï¼Œä¸é€‚ç”¨äºå¤§è§„æ¨¡å›¾ |
| è¿­ä»£DFS | O(V + E) | O(V) | é¿å…æ ˆæº¢å‡ºï¼Œé€‚ç”¨äºå¤§è§„æ¨¡å›¾ | ä»£ç ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦æ˜¾å¼ç®¡ç†æ ˆ |

## ğŸ” åº”ç”¨åœºæ™¯
- **è¿é€šæ€§åˆ†æ**ï¼šåˆ¤æ–­å›¾æ˜¯å¦è¿é€šï¼ŒæŸ¥æ‰¾è¿é€šåˆ†é‡
- **æ‹“æ‰‘æ’åº**ï¼šä»»åŠ¡è°ƒåº¦ã€è¯¾ç¨‹å®‰æ’ã€ä¾èµ–å…³ç³»åˆ†æ
- **è·¯å¾„æŸ¥æ‰¾**ï¼šè¿·å®«æ±‚è§£ã€æ‹¼å›¾æ¸¸æˆ
- **ç¯è·¯æ£€æµ‹**ï¼šåˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨ç¯è·¯
- **æœç´¢å¼•æ“**ï¼šç½‘ç«™çˆ¬è™«ï¼ˆæ·±åº¦ä¼˜å…ˆçˆ¬å–ï¼‰
- **äººå·¥æ™ºèƒ½**ï¼šåšå¼ˆè®ºä¸­çš„çŠ¶æ€ç©ºé—´æœç´¢
- **ç½‘ç»œå®‰å…¨**ï¼šæ¼æ´æ‰«æã€ç½‘ç»œæ‹“æ‰‘å‘ç°
- **ç¼–è¯‘å™¨**ï¼šè¯­æ³•åˆ†æä¸­çš„é€’å½’ä¸‹é™åˆ†æ
- **å›¾åƒå¤„ç†**ï¼šåŒºåŸŸå¡«å……ã€è½®å»“æå–
- **æ•°æ®åº“**ï¼šäº‹åŠ¡ä¾èµ–åˆ†æ

## âš ï¸ æ³¨æ„äº‹é¡¹
- **æ ˆæº¢å‡ºé£é™©**ï¼šé€’å½’å®ç°å¯èƒ½åœ¨æ·±åº¦è¿‡å¤§æ—¶å¯¼è‡´æ ˆæº¢å‡º
- **è®¿é—®æ ‡è®°**ï¼šå¿…é¡»æ­£ç¡®ç»´æŠ¤visitedé›†åˆï¼Œé¿å…é‡å¤è®¿é—®å’Œæ— é™å¾ªç¯
- **æœ‰å‘å›¾å¤„ç†**ï¼šé‚»æ¥è¡¨éœ€åŒºåˆ†æœ‰å‘å’Œæ— å‘å›¾
- **éè¿é€šå›¾**ï¼šéœ€å¯¹æ‰€æœ‰æœªè®¿é—®èŠ‚ç‚¹æ‰§è¡ŒDFS
- **å†…å­˜å ç”¨**ï¼šå¯¹äºå¤§å‹å›¾ï¼Œéœ€è€ƒè™‘ç©ºé—´ä¼˜åŒ–
- **è·¯å¾„å®Œæ•´æ€§**ï¼šDFSä¸ä¿è¯æ‰¾åˆ°æœ€çŸ­è·¯å¾„
- **é€’å½’æ·±åº¦é™åˆ¶**ï¼šPythoné»˜è®¤é€’å½’æ·±åº¦é™åˆ¶çº¦ä¸º1000ï¼Œå¯é€šè¿‡sys.setrecursionlimitè°ƒæ•´

## ğŸ“ æœ€ä½³å®è·µ

### å®ç°é€‰æ‹©
- **å°è§„æ¨¡å›¾æˆ–æ ‘**ï¼šä¼˜å…ˆä½¿ç”¨é€’å½’å®ç°ï¼Œä»£ç æ›´ç®€æ´
- **å¤§è§„æ¨¡å›¾**ï¼šä½¿ç”¨è¿­ä»£å®ç°ï¼Œé¿å…æ ˆæº¢å‡º
- **Pythonç¯å¢ƒ**ï¼šé€’å½’æ·±åº¦è¶…è¿‡1000æ—¶å¿…é¡»ä½¿ç”¨è¿­ä»£å®ç°

### æ€§èƒ½ä¼˜åŒ–
- **é‚»æ¥è¡¨è¡¨ç¤º**ï¼šå¯¹äºç¨€ç–å›¾ï¼Œæ¯”é‚»æ¥çŸ©é˜µæ›´èŠ‚çœç©ºé—´
- **éé€’å½’å®ç°**ï¼šä½¿ç”¨æ˜¾å¼æ ˆæ—¶ï¼Œå¯é€šè¿‡é€‚å½“çš„èŠ‚ç‚¹æ’åºå‡å°‘ç¼“å­˜å¤±æ•ˆ
- **å‰ªææ“ä½œ**ï¼šåœ¨æœç´¢è¿‡ç¨‹ä¸­æå‰æ’é™¤ä¸å¯èƒ½çš„è·¯å¾„

### ä»£ç ç¤ºä¾‹ï¼šä¼˜åŒ–çš„è¿­ä»£DFS
```python
def optimized_dfs(graph, start):
    """ä¼˜åŒ–çš„è¿­ä»£DFSå®ç°ï¼Œä½¿ç”¨ç”Ÿæˆå™¨è¿”å›èŠ‚ç‚¹"
    visited = set()
    stack = [(start, False)]
    while stack:
        vertex, processed = stack.pop()
        if processed:
            yield vertex
            continue
        if vertex in visited:
            continue
        visited.add(vertex)
        stack.append((vertex, True))
        # é€†åºæ·»åŠ é‚»æ¥èŠ‚ç‚¹ï¼Œä¿æŒä¸é€’å½’DFSç›¸åŒçš„éå†é¡ºåº
        for neighbor in reversed(graph.adj[vertex]):
            if neighbor not in visited:
                stack.append((neighbor, False))
```

### å¸¸è§é”™è¯¯å¤„ç†
- **æœªåˆå§‹åŒ–visitedé›†åˆ**ï¼šå¯¼è‡´æ— é™å¾ªç¯
- **é”™è¯¯çš„é‚»æ¥å…³ç³»è¡¨ç¤º**ï¼šç‰¹åˆ«æ˜¯æœ‰å‘å›¾ä¸­æ–¹å‘é”™è¯¯
- **å¿½ç•¥éè¿é€šå›¾**ï¼šåªå¤„ç†äº†éƒ¨åˆ†èŠ‚ç‚¹
- **é€’å½’æ·±åº¦è¶…é™**ï¼šæœªè€ƒè™‘Pythonçš„é€’å½’é™åˆ¶

---

> **ç›¸å…³é“¾æ¥**ï¼š
> - [æ·±åº¦ä¼˜å…ˆæœç´¢](https://zh.wikipedia.org/wiki/æ·±åº¦ä¼˜å…ˆæœç´¢)
> - [å›¾è®º](https://zh.wikipedia.org/wiki/å›¾è®º)
> - [æ‹“æ‰‘æ’åº](https://zh.wikipedia.org/wiki/æ‹“æ‰‘æ’åº)