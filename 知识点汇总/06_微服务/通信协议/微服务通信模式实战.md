# å¾®æœåŠ¡é€šä¿¡æ¨¡å¼å®æˆ˜

> æ„å»ºé«˜æ•ˆå¯é çš„æœåŠ¡é—´é€šä¿¡ä½“ç³»

## ğŸ“‹ ç›®å½•

1. [å¾®æœåŠ¡é€šä¿¡æ¦‚è¿°](#1-å¾®æœåŠ¡é€šä¿¡æ¦‚è¿°)
2. [åŒæ­¥é€šä¿¡æ¨¡å¼](#2-åŒæ­¥é€šä¿¡æ¨¡å¼)
3. [å¼‚æ­¥é€šä¿¡æ¨¡å¼](#3-å¼‚æ­¥é€šä¿¡æ¨¡å¼)
4. [é€šä¿¡åè®®è¯¦è§£](#4-é€šä¿¡åè®®è¯¦è§£)
5. [æœåŠ¡ç½‘æ ¼é€šä¿¡ç®¡ç†](#5-æœåŠ¡ç½‘æ ¼é€šä¿¡ç®¡ç†)
6. [é€šä¿¡å®‰å…¨ç­–ç•¥](#6-é€šä¿¡å®‰å…¨ç­–ç•¥)
7. [é€šä¿¡å¯é æ€§ä¿éšœ](#7-é€šä¿¡å¯é æ€§ä¿éšœ)
8. [æ€§èƒ½ä¼˜åŒ–å®è·µ](#8-æ€§èƒ½ä¼˜åŒ–å®è·µ)
9. [è·¨è¯­è¨€é€šä¿¡æ–¹æ¡ˆ](#9-è·¨è¯­è¨€é€šä¿¡æ–¹æ¡ˆ)
10. [æ¡ˆä¾‹åˆ†æä¸æœ€ä½³å®è·µ](#10-æ¡ˆä¾‹åˆ†æä¸æœ€ä½³å®è·µ)

---

## 1. å¾®æœåŠ¡é€šä¿¡æ¦‚è¿°

### 1.1 é€šä¿¡æŒ‘æˆ˜ä¸éœ€æ±‚

å¾®æœåŠ¡æ¶æ„ä¸‹ï¼ŒæœåŠ¡é—´é€šä¿¡é¢ä¸´ç‹¬ç‰¹æŒ‘æˆ˜ï¼š
- **æœåŠ¡å‘ç°**ï¼šåŠ¨æ€å®šä½æœåŠ¡å®ä¾‹
- **è´Ÿè½½å‡è¡¡**ï¼šåœ¨å¤šä¸ªæœåŠ¡å®ä¾‹é—´åˆ†é…è¯·æ±‚
- **å¯é æ€§**ï¼šå¤„ç†ç½‘ç»œæ•…éšœå’ŒæœåŠ¡ä¸å¯ç”¨
- **å®‰å…¨æ€§**ï¼šç¡®ä¿é€šä¿¡å†…å®¹æœºå¯†æ€§å’Œå®Œæ•´æ€§
- **å¯è§‚æµ‹æ€§**ï¼šç›‘æ§å’Œè¿½è¸ªæœåŠ¡é—´é€šä¿¡
- **æ€§èƒ½**ï¼šä½å»¶è¿Ÿå’Œé«˜ååé‡
- **å…¼å®¹æ€§**ï¼šæ”¯æŒä¸åŒæŠ€æœ¯æ ˆå’Œç‰ˆæœ¬

### 1.2 é€šä¿¡æ¨¡å¼åˆ†ç±»

![é€šä¿¡æ¨¡å¼åˆ†ç±»](https://i.imgur.com/communication_patterns.png)

| åˆ†ç±»ç»´åº¦ | ä¸»è¦ç±»å‹ |
|---------|---------|
| é€šä¿¡æ–¹å¼ | åŒæ­¥é€šä¿¡ã€å¼‚æ­¥é€šä¿¡ |
| æ•°æ®æ ¼å¼ | JSONã€XMLã€Protocol Buffersã€Avro |
| é€šä¿¡åè®® | HTTP/HTTPSã€gRPCã€WebSocketã€AMQPã€Kafka |
| é€šä¿¡æ–¹å‘ | è¯·æ±‚-å“åº”ã€å‘å¸ƒ-è®¢é˜…ã€å•å‘é€šçŸ¥ |
| é€šä¿¡èŒƒå›´ | ç‚¹å¯¹ç‚¹ã€å¹¿æ’­ã€ç»„æ’­ |

### 1.3 é€šä¿¡æ¨¡å¼é€‰æ‹©å› ç´ 

é€‰æ‹©åˆé€‚é€šä¿¡æ¨¡å¼éœ€è€ƒè™‘ï¼š
- **ä¸šåŠ¡éœ€æ±‚**ï¼šæ˜¯å¦éœ€è¦å³æ—¶å“åº”
- **æ•°æ®é‡**ï¼šå°æ•°æ®é‡ vs å¤§æ•°æ®é‡ä¼ è¾“
- **å¯é æ€§è¦æ±‚**ï¼šæ˜¯å¦å®¹å¿æ¶ˆæ¯ä¸¢å¤±
- **å»¶è¿Ÿè¦æ±‚**ï¼šæ¯«ç§’çº§å“åº” vs æœ€ç»ˆä¸€è‡´æ€§
- **ç³»ç»Ÿè´Ÿè½½**ï¼šå³°å€¼å¤„ç†èƒ½åŠ›éœ€æ±‚
- **æŠ€æœ¯æ ˆ**ï¼šç°æœ‰æŠ€æœ¯æ ˆå…¼å®¹æ€§
- **å›¢é˜Ÿç†Ÿæ‚‰åº¦**ï¼šå¼€å‘å›¢é˜ŸæŠ€æœ¯èƒŒæ™¯

---

## 2. åŒæ­¥é€šä¿¡æ¨¡å¼

### 2.1 REST APIé€šä¿¡

**åŸºæœ¬å®ç°**ï¼š
```java
@RestController
@RequestMapping("/api/orders")
public class OrderController {
    private final OrderService orderService;
    private final RestTemplate restTemplate;

    @Autowired
    public OrderController(OrderService orderService, RestTemplate restTemplate) {
        this.orderService = orderService;
        this.restTemplate = restTemplate;
    }

    @PostMapping
    public ResponseEntity<OrderDTO> createOrder(@RequestBody @Valid OrderRequest request) {
        // è°ƒç”¨åº“å­˜æœåŠ¡
        InventoryRequest inventoryRequest = new InventoryRequest(request.getItems());
        InventoryResponse inventoryResponse = restTemplate.postForObject(
            "http://inventory-service/api/inventory/check",
            inventoryRequest,
            InventoryResponse.class
        );

        if (inventoryResponse != null && inventoryResponse.isAvailable()) {
            OrderDTO order = orderService.createOrder(request);
            return ResponseEntity.status(HttpStatus.CREATED).body(order);
        } else {
            return ResponseEntity.status(HttpStatus.BAD_REQUEST)
                .body(new OrderDTO(null, "Insufficient inventory", null));
        }
    }

    @GetMapping("/{id}")
    public ResponseEntity<OrderDTO> getOrder(@PathVariable Long id) {
        return orderService.findById(id)
            .map(ResponseEntity::ok)
            .orElse(ResponseEntity.notFound().build());
    }
}
```

**RESTæ¨¡æ¿é…ç½®**ï¼š
```java
@Configuration
public class RestTemplateConfig {
    @Bean
    public RestTemplate restTemplate(RestTemplateBuilder builder) {
        return builder
            .setConnectTimeout(Duration.ofSeconds(3))
            .setReadTimeout(Duration.ofSeconds(3))
            .interceptors(new LoggingInterceptor())
            .errorHandler(new CustomResponseErrorHandler())
            .build();
    }
}
```

### 2.2 gRPCé€šä¿¡

**å®šä¹‰æœåŠ¡å¥‘çº¦**ï¼š
```protobuf
syntax = "proto3";

package com.example.order;

option java_multiple_files = true;
option java_package = "com.example.order.grpc";
option java_outer_classname = "OrderServiceProto";

service OrderService {
  rpc CreateOrder (CreateOrderRequest) returns (OrderResponse);
  rpc GetOrder (GetOrderRequest) returns (OrderResponse);
  rpc SearchOrders (SearchOrdersRequest) returns (stream OrderResponse);
}

message CreateOrderRequest {
  int64 user_id = 1;
  repeated OrderItem items = 2;
}

message OrderItem {
  int64 product_id = 1;
  int32 quantity = 2;
}

message GetOrderRequest {
  int64 order_id = 1;
}

message SearchOrdersRequest {
  int64 user_id = 1;
  OrderStatus status = 2;
}

message OrderResponse {
  int64 id = 1;
  int64 user_id = 2;
  OrderStatus status = 3;
  repeated OrderItem items = 4;
  double total_amount = 5;
  string created_at = 6;
}

enum OrderStatus {
  CREATED = 0;
  PAID = 1;
  SHIPPED = 2;
  DELIVERED = 3;
  CANCELLED = 4;
}
```

**æœåŠ¡å®ç°**ï¼š
```java
@GrpcService
public class OrderGrpcService extends OrderServiceImplBase {
    private final OrderService orderService;

    @Autowired
    public OrderGrpcService(OrderService orderService) {
        this.orderService = orderService;
    }

    @Override
    public void createOrder(CreateOrderRequest request, StreamObserver<OrderResponse> responseObserver) {
        try {
            OrderRequest orderRequest = convertToOrderRequest(request);
            OrderDTO order = orderService.createOrder(orderRequest);
            responseObserver.onNext(convertToOrderResponse(order));
            responseObserver.onCompleted();
        } catch (Exception e) {
            responseObserver.onError(e);
        }
    }

    @Override
    public void getOrder(GetOrderRequest request, StreamObserver<OrderResponse> responseObserver) {
        // å®ç°è·å–è®¢å•é€»è¾‘
    }

    @Override
    public void searchOrders(SearchOrdersRequest request, StreamObserver<OrderResponse> responseObserver) {
        // å®ç°æœç´¢è®¢å•é€»è¾‘ï¼Œæ”¯æŒæµå¼å“åº”
    }

    // è½¬æ¢æ–¹æ³•çœç•¥...
}
```

**å®¢æˆ·ç«¯è°ƒç”¨**ï¼š
```java
@Service
public class OrderGrpcClient {
    private final ManagedChannel channel;
    private final OrderServiceGrpc.OrderServiceBlockingStub blockingStub;
    private final OrderServiceGrpc.OrderServiceStub asyncStub;

    @Autowired
    public OrderGrpcClient(@Value("${grpc.order-service.host}") String host,
                          @Value("${grpc.order-service.port}") int port) {
        this.channel = ManagedChannelBuilder.forAddress(host, port)
            .usePlaintext()
            .build();
        this.blockingStub = OrderServiceGrpc.newBlockingStub(channel);
        this.asyncStub = OrderServiceGrpc.newStub(channel);
    }

    public OrderResponse createOrder(OrderRequest request) {
        CreateOrderRequest grpcRequest = convertToGrpcRequest(request);
        return blockingStub.createOrder(grpcRequest);
    }

    public void searchOrders(SearchOrdersRequest request, StreamObserver<OrderResponse> observer) {
        asyncStub.searchOrders(convertToGrpcSearchRequest(request), observer);
    }

    @PreDestroy
    public void shutdown() {
        channel.shutdown();
    }
}
```

### 2.3 GraphQL APIé€šä¿¡

**Schemaå®šä¹‰**ï¼š
```graphql
type Order {
    id: ID!
    userId: ID!
    status: OrderStatus!
    items: [OrderItem!]!
    totalAmount: Float!
    createdAt: String!
}

enum OrderStatus {
    CREATED
    PAID
    SHIPPED
    DELIVERED
    CANCELLED
}

type OrderItem {
    productId: ID!
    name: String!
    quantity: Int!
    price: Float!
}

input OrderItemInput {
    productId: ID!
    quantity: Int!
}

input CreateOrderInput {
    userId: ID!
    items: [OrderItemInput!]!
}

type OrderResponse {
    success: Boolean!
    message: String
    order: Order
}

type Query {
    getOrder(id: ID!): Order
    getUserOrders(userId: ID!): [Order!]!
}

type Mutation {
    createOrder(input: CreateOrderInput!): OrderResponse
    cancelOrder(id: ID!): OrderResponse
}
```

**Resolverå®ç°**ï¼š
```java
@Component
public class OrderResolver implements GraphQLQueryResolver, GraphQLMutationResolver {
    private final OrderService orderService;
    private final InventoryClient inventoryClient;

    @Autowired
    public OrderResolver(OrderService orderService, InventoryClient inventoryClient) {
        this.orderService = orderService;
        this.inventoryClient = inventoryClient;
    }

    public Order getOrder(String id) {
        return orderService.findById(Long.valueOf(id))
            .map(this::convertToGraphQLOrder)
            .orElse(null);
    }

    public List<Order> getUserOrders(String userId) {
        return orderService.findByUserId(Long.valueOf(userId))
            .stream()
            .map(this::convertToGraphQLOrder)
            .collect(Collectors.toList());
    }

    public OrderResponse createOrder(CreateOrderInput input) {
        // è°ƒç”¨åº“å­˜æœåŠ¡
        boolean inventoryAvailable = inventoryClient.checkInventory(
            input.getItems().stream()
                .map(item -> new InventoryItem(Long.valueOf(item.getProductId()), item.getQuantity()))
                .collect(Collectors.toList())
        );

        if (inventoryAvailable) {
            OrderDTO order = orderService.createOrder(convertToOrderRequest(input));
            return new OrderResponse(true, "Order created successfully", convertToGraphQLOrder(order));
        } else {
            return new OrderResponse(false, "Insufficient inventory", null);
        }
    }

    // è½¬æ¢æ–¹æ³•çœç•¥...
}
```

**å®¢æˆ·ç«¯æŸ¥è¯¢ç¤ºä¾‹**ï¼š
```graphql
# åˆ›å»ºè®¢å•
mutation CreateOrder($input: CreateOrderInput!) {
    createOrder(input: $input) {
        success
        message
        order {
            id
            status
            totalAmount
            items {
                productId
                name
                quantity
            }
        }
    }
}

# æŸ¥è¯¢è®¢å•
query GetOrder($id: ID!) {
    getOrder(id: $id) {
        id
        userId
        status
        items {
            productId
            name
            quantity
            price
        }
        totalAmount
        createdAt
    }
}
```

### 2.4 åŒæ­¥é€šä¿¡æœ€ä½³å®è·µ

1. **APIç‰ˆæœ¬æ§åˆ¶**ï¼š
   ```
   /api/v1/orders
   ```

2. **è¶…æ—¶æ§åˆ¶**ï¼šè®¾ç½®åˆç†çš„è¿æ¥å’Œè¯»å–è¶…æ—¶

3. **é‡è¯•æœºåˆ¶**ï¼šå®ç°æŒ‡æ•°é€€é¿é‡è¯•ç­–ç•¥

4. **ç†”æ–­ä¿æŠ¤**ï¼šé˜²æ­¢çº§è”å¤±è´¥

5. **è´Ÿè½½å‡è¡¡**ï¼šå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡

6. **è¯·æ±‚å‹ç¼©**ï¼šå‡å°‘ç½‘ç»œä¼ è¾“é‡

7. **è®¤è¯æˆæƒ**ï¼šAPIè®¿é—®æ§åˆ¶

8. **è¯·æ±‚é™æµ**ï¼šä¿æŠ¤æœåŠ¡ç¨³å®šæ€§

9. **APIæ–‡æ¡£**ï¼šä½¿ç”¨Swagger/OpenAPI

10. **ç›‘æ§ä¸è¿½è¸ª**ï¼šè®°å½•é€šä¿¡æŒ‡æ ‡å’Œé“¾è·¯

---

## 3. å¼‚æ­¥é€šä¿¡æ¨¡å¼

### 3.1 æ¶ˆæ¯é˜Ÿåˆ—é€šä¿¡

**RabbitMQå®ç°**ï¼š
```java
@Service
public class OrderEventProducer {
    private static final Logger logger = LoggerFactory.getLogger(OrderEventProducer.class);
    private static final String ORDER_EXCHANGE = "order.exchange";
    private static final String ORDER_CREATED_ROUTING_KEY = "order.created";

    private final RabbitTemplate rabbitTemplate;

    @Autowired
    public OrderEventProducer(RabbitTemplate rabbitTemplate) {
        this.rabbitTemplate = rabbitTemplate;
    }

    public void publishOrderCreatedEvent(OrderDTO order) {
        try {
            OrderCreatedEvent event = new OrderCreatedEvent(
                order.getId(),
                order.getUserId(),
                order.getStatus().name(),
                order.getItems(),
                order.getTotalAmount(),
                LocalDateTime.now()
            );

            rabbitTemplate.convertAndSend(
                ORDER_EXCHANGE,
                ORDER_CREATED_ROUTING_KEY,
                event,
                message -> {
                    message.getMessageProperties().setContentType(MessageProperties.CONTENT_TYPE_JSON);
                    message.getMessageProperties().setHeader("eventId", UUID.randomUUID().toString());
                    return message;
                }
            );

            logger.info("Order created event published: {}", order.getId());
        } catch (Exception e) {
            logger.error("Failed to publish order created event", e);
            // å¯ä»¥å®ç°é‡è¯•æˆ–ä¿å­˜åˆ°æœ¬åœ°æ¶ˆæ¯è¡¨
        }
    }
}
```

**æ¶ˆè´¹è€…å®ç°**ï¼š
```java
@Service
public class OrderEventConsumer {
    private static final Logger logger = LoggerFactory.getLogger(OrderEventConsumer.class);
    private static final String ORDER_QUEUE = "order.processing.queue";

    private final OrderService orderService;
    private final InventoryService inventoryService;
    private final PaymentService paymentService;

    @Autowired
    public OrderEventConsumer(OrderService orderService, InventoryService inventoryService, PaymentService paymentService) {
        this.orderService = orderService;
        this.inventoryService = inventoryService;
        this.paymentService = paymentService;
    }

    @RabbitListener(queues = ORDER_QUEUE)
    public void processOrderCreatedEvent(@Payload OrderCreatedEvent event, @Headers Map<String, Object> headers) {
        logger.info("Received order created event: {}, eventId: {}",
            event.getOrderId(), headers.get("eventId"));

        try {
            // å¤„ç†è®¢å•é€»è¾‘
            boolean inventoryReserved = inventoryService.reserveInventory(
                event.getOrderId(), event.getItems());

            if (inventoryReserved) {
                // è°ƒç”¨æ”¯ä»˜æœåŠ¡
                PaymentResult result = paymentService.processPayment(
                    event.getOrderId(), event.getUserId(), event.getTotalAmount());

                if (result.isSuccess()) {
                    orderService.updateOrderStatus(event.getOrderId(), OrderStatus.PAID);
                    // å‘å¸ƒè®¢å•å·²æ”¯ä»˜äº‹ä»¶
                } else {
                    orderService.updateOrderStatus(event.getOrderId(), OrderStatus.PAYMENT_FAILED);
                    inventoryService.releaseInventory(event.getOrderId());
                }
            } else {
                orderService.updateOrderStatus(event.getOrderId(), OrderStatus.INVENTORY_FAILED);
            }
        } catch (Exception e) {
            logger.error("Error processing order event", e);
            // å¤„ç†å¤±è´¥é€»è¾‘ï¼Œå¯èƒ½éœ€è¦äººå·¥å¹²é¢„
        }
    }
}
```

**RabbitMQé…ç½®**ï¼š
```java
@Configuration
public class RabbitMQConfig {
    @Bean
    public TopicExchange orderExchange() {
        return ExchangeBuilder.topicExchange("order.exchange").durable(true).build();
    }

    @Bean
    public Queue orderProcessingQueue() {
        return QueueBuilder.durable("order.processing.queue")
            .withArgument("x-dead-letter-exchange", "order.dlq.exchange")
            .withArgument("x-dead-letter-routing-key", "order.dlq")
            .withArgument("x-message-ttl", 60000)
            .build();
    }

    @Bean
    public Binding orderProcessingBinding(TopicExchange orderExchange, Queue orderProcessingQueue) {
        return BindingBuilder.bind(orderProcessingQueue)
            .to(orderExchange)
            .with("order.created");
    }

    @Bean
    public Queue orderDlqQueue() {
        return QueueBuilder.durable("order.dlq.queue").build();
    }

    @Bean
    public TopicExchange orderDlqExchange() {
        return ExchangeBuilder.topicExchange("order.dlq.exchange").durable(true).build();
    }

    @Bean
    public Binding orderDlqBinding(TopicExchange orderDlqExchange, Queue orderDlqQueue) {
        return BindingBuilder.bind(orderDlqQueue)
            .to(orderDlqExchange)
            .with("order.dlq");
    }
}
```

### 3.2 å‘å¸ƒ-è®¢é˜…æ¨¡å¼

**Kafkaå®ç°**ï¼š
```java
@Service
public class KafkaOrderEventProducer {
    private static final Logger logger = LoggerFactory.getLogger(KafkaOrderEventProducer.class);
    private static final String ORDER_TOPIC = "order-events";

    private final KafkaTemplate<String, Object> kafkaTemplate;
    private final ObjectMapper objectMapper;

    @Autowired
    public KafkaOrderEventProducer(KafkaTemplate<String, Object> kafkaTemplate, ObjectMapper objectMapper) {
        this.kafkaTemplate = kafkaTemplate;
        this.objectMapper = objectMapper;
    }

    public void publishOrderEvent(OrderDTO order, String eventType) {
        try {
            OrderEvent event = new OrderEvent(
                UUID.randomUUID().toString(),
                eventType,
                order.getId().toString(),
                order.getUserId().toString(),
                objectMapper.writeValueAsString(order),
                LocalDateTime.now().toString()
            );

            // ä½¿ç”¨è®¢å•IDä½œä¸ºkeyï¼Œç¡®ä¿åŒä¸€è®¢å•çš„äº‹ä»¶æœ‰åº
            ListenableFuture<SendResult<String, Object>> future = kafkaTemplate.send(
                ORDER_TOPIC,
                order.getId().toString(),
                event
            );

            future.addCallback(
                result -> logger.info("Order event published: {}, eventId: {}", order.getId(), event.getEventId()),
                ex -> logger.error("Failed to publish order event", ex)
            );
        } catch (Exception e) {
            logger.error("Error creating order event", e);
        }
    }
}
```

**Kafkaæ¶ˆè´¹è€…**ï¼š
```java
@Service
public class KafkaOrderEventConsumer {
    private static final Logger logger = LoggerFactory.getLogger(KafkaOrderEventConsumer.class);
    private static final String ORDER_TOPIC = "order-events";
    private static final String CONSUMER_GROUP = "inventory-service-group";

    private final InventoryService inventoryService;
    private final ObjectMapper objectMapper;

    @Autowired
    public KafkaOrderEventConsumer(InventoryService inventoryService, ObjectMapper objectMapper) {
        this.inventoryService = inventoryService;
        this.objectMapper = objectMapper;
    }

    @KafkaListener(topics = ORDER_TOPIC, groupId = CONSUMER_GROUP)
    public void consumeOrderEvent(@Payload String message, @Header(KafkaHeaders.RECEIVED_KEY) String key,
                                 @Header(KafkaHeaders.RECEIVED_PARTITION) int partition,
                                 @Header(KafkaHeaders.OFFSET) long offset) {
        logger.info("Received order event: key={}, partition={}, offset={}", key, partition, offset);

        try {
            OrderEvent event = objectMapper.readValue(message, OrderEvent.class);

            if ("ORDER_CREATED".equals(event.getEventType())) {
                OrderDTO order = objectMapper.readValue(event.getPayload(), OrderDTO.class);
                inventoryService.reserveInventory(order.getId(), order.getItems());
            } else if ("ORDER_CANCELLED".equals(event.getEventType())) {
                OrderDTO order = objectMapper.readValue(event.getPayload(), OrderDTO.class);
                inventoryService.releaseInventory(order.getId());
            }
        } catch (Exception e) {
            logger.error("Error processing order event", e);
            // å¤„ç†å¼‚å¸¸ï¼Œå¯ä»¥è€ƒè™‘å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—
        }
    }
}
```

**Kafkaé…ç½®**ï¼š
```java
@Configuration
public class KafkaConfig {
    @Value("${spring.kafka.bootstrap-servers}")
    private String bootstrapServers;

    @Value("${spring.kafka.consumer.group-id}")
    private String groupId;

    @Bean
    public ProducerFactory<String, Object> producerFactory() {
        Map<String, Object> configProps = new HashMap<>();
        configProps.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);
        configProps.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
        configProps.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, JsonSerializer.class);
        configProps.put(ProducerConfig.ACKS_CONFIG, "all");
        configProps.put(ProducerConfig.RETRIES_CONFIG, 3);
        return new DefaultKafkaProducerFactory<>(configProps);
    }

    @Bean
    public KafkaTemplate<String, Object> kafkaTemplate() {
        return new KafkaTemplate<>(producerFactory());
    }

    @Bean
    public ConsumerFactory<String, Object> consumerFactory() {
        Map<String, Object> props = new HashMap<>();
        props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);
        props.put(ConsumerConfig.GROUP_ID_CONFIG, groupId);
        props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
        props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, JsonDeserializer.class);
        props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, "earliest");
        props.put(ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, false);
        return new DefaultKafkaConsumerFactory<>(props);
    }

    @Bean
    public ConcurrentKafkaListenerContainerFactory<String, Object> kafkaListenerContainerFactory() {
        ConcurrentKafkaListenerContainerFactory<String, Object> factory = new ConcurrentKafkaListenerContainerFactory<>();
        factory.setConsumerFactory(consumerFactory());
        factory.setConcurrency(3);
        factory.getContainerProperties().setPollTimeout(3000);
        factory.getContainerProperties().setAckMode(AckMode.MANUAL_IMMEDIATE);
        return factory;
    }
}
```

### 3.3 å¼‚æ­¥é€šä¿¡æœ€ä½³å®è·µ

1. **æ¶ˆæ¯æŒä¹…åŒ–**ï¼šç¡®ä¿æ¶ˆæ¯ä¸ä¸¢å¤±
2. **æ¶ˆæ¯å¹‚ç­‰æ€§**ï¼šè®¾è®¡æ”¯æŒé‡å¤æ¶ˆè´¹çš„æ¶ˆè´¹è€…
3. **æ¶ˆæ¯é¡ºåº**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚ä¿è¯æ¶ˆæ¯é¡ºåº
4. **æ­»ä¿¡é˜Ÿåˆ—**ï¼šå¤„ç†æ¶ˆè´¹å¤±è´¥çš„æ¶ˆæ¯
5. **æ¶ˆæ¯ç§¯å‹ç›‘æ§**ï¼šç›‘æ§é˜Ÿåˆ—é•¿åº¦ï¼ŒåŠæ—¶å‘ç°é—®é¢˜
6. **æ¶ˆæ¯é™æµ**ï¼šä¿æŠ¤ä¸‹æ¸¸æœåŠ¡
7. **æ¶ˆæ¯å‹ç¼©**ï¼šå‡å°‘ç½‘ç»œä¼ è¾“å’Œå­˜å‚¨å¼€é”€
8. **æ¶ˆæ¯è¿½è¸ª**ï¼šå®ç°æ¶ˆæ¯å…¨é“¾è·¯è¿½è¸ª
9. **å¼‚æ­¥å¤„ç†çŠ¶æ€ç®¡ç†**ï¼šè®°å½•å¼‚æ­¥å¤„ç†çŠ¶æ€
10. **é™çº§ç­–ç•¥**ï¼šæ¶ˆæ¯ç³»ç»Ÿä¸å¯ç”¨æ—¶çš„é™çº§æ–¹æ¡ˆ

---

## 4. é€šä¿¡åè®®è¯¦è§£

### 4.1 HTTP/HTTPSåè®®

**ç‰¹ç‚¹**ï¼š
- æ— çŠ¶æ€ã€åº”ç”¨å±‚åè®®
- ç®€å•æ˜“ç”¨ï¼Œå¹¿æ³›æ”¯æŒ
- åŸºäºè¯·æ±‚-å“åº”æ¨¡å‹
- æ”¯æŒå¤šç§æ•°æ®æ ¼å¼
- å¯é€šè¿‡HTTPSåŠ å¯†

**é€‚ç”¨åœºæ™¯**ï¼š
- REST APIé€šä¿¡
- æµè§ˆå™¨ä¸æœåŠ¡å™¨é€šä¿¡
- è·¨åŸŸæœåŠ¡é€šä¿¡
- å¯¹å®æ—¶æ€§è¦æ±‚ä¸é«˜çš„åœºæ™¯

**æ€§èƒ½ä¼˜åŒ–**ï¼š
- å¯ç”¨HTTP/2ï¼Œæ”¯æŒå¤šè·¯å¤ç”¨
- å®ç°è¿æ¥æ± å¤ç”¨TCPè¿æ¥
- å¯ç”¨GZIPå‹ç¼©
- ä½¿ç”¨CDNåŠ é€Ÿé™æ€èµ„æº
- åˆç†è®¾ç½®ç¼“å­˜ç­–ç•¥

### 4.2 gRPCåè®®

**ç‰¹ç‚¹**ï¼š
- åŸºäºHTTP/2çš„é«˜æ€§èƒ½RPCæ¡†æ¶
- ä½¿ç”¨Protocol Buffersåºåˆ—åŒ–
- æ”¯æŒåŒå‘æµå’Œå¼‚æ­¥é€šä¿¡
- å¼ºç±»å‹æ¥å£å®šä¹‰
- å†…ç½®è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å‘ç°

**æ€§èƒ½ä¼˜åŠ¿**ï¼š
- äºŒè¿›åˆ¶åè®®ï¼Œåºåˆ—åŒ–æ•ˆç‡é«˜
- å¤šè·¯å¤ç”¨ï¼Œå‡å°‘è¿æ¥å¼€é”€
- å¤´éƒ¨å‹ç¼©ï¼Œå‡å°‘ä¼ è¾“é‡
- å¼‚æ­¥æµå¼å¤„ç†

**é€‚ç”¨åœºæ™¯**ï¼š
- æœåŠ¡é—´é«˜é¢‘é€šä¿¡
- ä½å»¶è¿Ÿã€é«˜ååé‡éœ€æ±‚
- å¤šè¯­è¨€æœåŠ¡é€šä¿¡
- éœ€è¦æµå¼é€šä¿¡çš„åœºæ™¯

### 4.3 AMQPåè®®

**ç‰¹ç‚¹**ï¼š
- é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®
- æ”¯æŒå¤æ‚è·¯ç”±æ¨¡å¼
- æ¶ˆæ¯ç¡®è®¤æœºåˆ¶
- äº‹åŠ¡æ”¯æŒ
- æŒä¹…åŒ–æ¶ˆæ¯

**æ ¸å¿ƒç»„ä»¶**ï¼š
- äº¤æ¢æœº(Exchange)ï¼šè·¯ç”±æ¶ˆæ¯åˆ°é˜Ÿåˆ—
- é˜Ÿåˆ—(Queue)ï¼šå­˜å‚¨æ¶ˆæ¯
- ç»‘å®š(Binding)ï¼šè¿æ¥äº¤æ¢æœºå’Œé˜Ÿåˆ—
- è™šæ‹Ÿä¸»æœº(Virtual Host)ï¼šæä¾›éš”ç¦»

**é€‚ç”¨åœºæ™¯**ï¼š
- ä¼ä¸šçº§æ¶ˆæ¯é€šä¿¡
- éœ€è¦å¯é æ¶ˆæ¯ä¼ é€’çš„åœºæ™¯
- å¤æ‚è·¯ç”±éœ€æ±‚
- å¼‚æ­¥å¤„ç†å’Œè§£è€¦

### 4.4 WebSocketåè®®

**ç‰¹ç‚¹**ï¼š
- å…¨åŒå·¥é€šä¿¡åè®®
- æŒä¹…è¿æ¥
- ä½å»¶è¿Ÿ
- åŸºäºTCPçš„åº”ç”¨å±‚åè®®
- é€‚åˆå®æ—¶é€šä¿¡

**å®ç°ç¤ºä¾‹**ï¼š
```java
@Configuration
@EnableWebSocket
public class WebSocketConfig implements WebSocketConfigurer {
    @Override
    public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {
        registry.addHandler(orderStatusWebSocketHandler(), "/ws/order-status")
            .setAllowedOrigins("*").withSockJS();
    }

    @Bean
    public WebSocketHandler orderStatusWebSocketHandler() {
        return new OrderStatusWebSocketHandler();
    }
}

@Component
public class OrderStatusWebSocketHandler extends TextWebSocketHandler {
    private static final Logger logger = LoggerFactory.getLogger(OrderStatusWebSocketHandler.class);
    private final Set<WebSocketSession> sessions = Collections.synchronizedSet(new HashSet<>());
    private final ObjectMapper objectMapper;

    @Autowired
    public OrderStatusWebSocketHandler(ObjectMapper objectMapper) {
        this.objectMapper = objectMapper;
    }

    @Override
    public void afterConnectionEstablished(WebSocketSession session) throws Exception {
        logger.info("WebSocket connection established: {}", session.getId());
        sessions.add(session);

        // å¯ä»¥ä»sessionå‚æ•°ä¸­è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œè¿›è¡Œæƒé™éªŒè¯
        Map<String, Object> attributes = session.getAttributes();
        // ...
    }

    @Override
    protected void handleTextMessage(WebSocketSession session, TextMessage message) throws Exception {
        // å¤„ç†å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯
        String payload = message.getPayload();
        logger.info("Received message from client: {}", payload);

        // å¯ä»¥è§£ææ¶ˆæ¯ï¼Œè¿›è¡Œç›¸åº”å¤„ç†
        // ...

        // å‘é€å“åº”
        session.sendMessage(new TextMessage("Message received: " + payload));
    }

    @Override
    public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception {
        logger.info("WebSocket connection closed: {}, status: {}", session.getId(), status);
        sessions.remove(session);
    }

    public void broadcastOrderStatusUpdate(OrderStatusUpdate update) {
        try {
            String message = objectMapper.writeValueAsString(update);
            TextMessage textMessage = new TextMessage(message);

            // éå†æ‰€æœ‰è¿æ¥ï¼Œå‘é€æ›´æ–°
            for (WebSocketSession session : sessions) {
                if (session.isOpen()) {
                    // å¯ä»¥æ ¹æ®sessionä¸­çš„ç”¨æˆ·ä¿¡æ¯ï¼Œåªå‘é€ç»™ç›¸å…³ç”¨æˆ·
                    session.sendMessage(textMessage);
                }
            }
        } catch (Exception e) {
            logger.error("Failed to broadcast order status update", e);
        }
    }
}
```

**é€‚ç”¨åœºæ™¯**ï¼š
- å®æ—¶é€šçŸ¥
- åœ¨çº¿èŠå¤©
- å®æ—¶ä»ªè¡¨ç›˜
- å¤šäººåä½œå·¥å…·
- æ¸¸æˆå®æ—¶äº¤äº’

---

## 5. æœåŠ¡ç½‘æ ¼é€šä¿¡ç®¡ç†

### 5.1 IstioæœåŠ¡ç½‘æ ¼

**æ ¸å¿ƒç»„ä»¶**ï¼š
- **Pilot**ï¼šæœåŠ¡å‘ç°å’Œæµé‡ç®¡ç†
- **Mixer**ï¼šç­–ç•¥æ‰§è¡Œå’Œé¥æµ‹æ”¶é›†
- **Citadel**ï¼šè¯ä¹¦ç®¡ç†å’Œå®‰å…¨é€šä¿¡
- **Envoy**ï¼šæ•°æ®å¹³é¢ä»£ç†
- **Galley**ï¼šé…ç½®éªŒè¯å’Œåˆ†å‘

**Istioå®‰è£…ä¸é…ç½®**ï¼š
```bash
# ä¸‹è½½Istio
curl -L https://istio.io/downloadIstio | sh -
cd istio-1.14.1
 export PATH=$PWD/bin:$PATH

# å®‰è£…Istio
istioctl install --set profile=demo -y

# ä¸ºå‘½åç©ºé—´å¯ç”¨è‡ªåŠ¨æ³¨å…¥
kubectl label namespace default istio-injection=enabled
```

**æµé‡è·¯ç”±é…ç½®**ï¼š
```yaml
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: order-service
  namespace: default
spec:
  hosts:
  - order-service
  http:
  - match:
    - headers:
        user-agent:
          regex: ".*Chrome.*"
    route:
    - destination:
        host: order-service
        subset: v2
  - route:
    - destination:
        host: order-service
        subset: v1
---
apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: order-service
  namespace: default
spec:
  host: order-service
  subsets:
  - name: v1
    labels:
      version: v1
  - name: v2
    labels:
      version: v2
```

### 5.2 æµé‡ç®¡ç†åŠŸèƒ½

**ç†”æ–­é…ç½®**ï¼š
```yaml
apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: inventory-service
  namespace: default
spec:
  host: inventory-service
  trafficPolicy:
    connectionPool:
      tcp:
        maxConnections: 100
      http:
        http1MaxPendingRequests: 100
        maxRequestsPerConnection: 10
    outlierDetection:
      consecutiveErrors: 5
      interval: 30s
      baseEjectionTime: 30s
```

**è¶…æ—¶å’Œé‡è¯•é…ç½®**ï¼š
```yaml
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: inventory-service
  namespace: default
spec:
  hosts:
  - inventory-service
  http:
  - route:
    - destination:
        host: inventory-service
    retries:
      attempts: 3
      perTryTimeout: 2s
      retryOn: 5xx,connect-failure,refused-stream
    timeout: 5s
```

**æµé‡é•œåƒ**ï¼š
```yaml
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: payment-service
  namespace: default
spec:
  hosts:
  - payment-service
  http:
  - route:
    - destination:
        host: payment-service
        subset: v1
      weight: 100
    mirror:
      host: payment-service
      subset: v2
    mirrorPercentage:
      value: 10.0
```

### 5.3 æœåŠ¡ç½‘æ ¼ç›‘æ§

**Prometheuså’ŒGrafanaé…ç½®**ï¼š
```yaml
# å®‰è£…Prometheuså’ŒGrafana
kubectl apply -f samples/addons/prometheus.yaml
kubectl apply -f samples/addons/grafana.yaml

# ç«¯å£è½¬å‘è®¿é—®Grafana
kubectl -n istio-system port-forward svc/grafana 3000:3000
```

**å¸¸ç”¨ç›‘æ§é¢æ¿**ï¼š
- Istio Service Dashboardï¼šæœåŠ¡çº§ç›‘æ§
- Istio Workload Dashboardï¼šå·¥ä½œè´Ÿè½½ç›‘æ§
- Istio Performance Dashboardï¼šæ€§èƒ½ç›‘æ§
- Istio Mesh Dashboardï¼šç½‘æ ¼æ•´ä½“ç›‘æ§

---

## 6. é€šä¿¡å®‰å…¨ç­–ç•¥

### 6.1 ä¼ è¾“å±‚å®‰å…¨

**HTTPSé…ç½®**ï¼š
```yaml
# application.yaml
server:
  port: 8443
  ssl:
    enabled: true
    key-store: classpath:keystore.p12
    key-store-password: password
    key-store-type: PKCS12
    key-alias: order-service
    protocol: TLSv1.3
    enabled-protocols: TLSv1.2, TLSv1.3
    ciphers: TLS_AES_256_GCM_SHA384,TLS_CHACHA20_POLY1305_SHA256,TLS_AES_128_GCM_SHA256
```

**è¯ä¹¦è‡ªåŠ¨æ›´æ–°**ï¼š
ä½¿ç”¨Let's Encryptå’ŒCertbotè‡ªåŠ¨ç®¡ç†è¯ä¹¦ï¼š
```bash
# å®‰è£…Certbot
apt-get install certbot python3-certbot-nginx

# è·å–è¯ä¹¦
certbot --nginx -d api.example.com

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ
certbot renew --dry-run
```

### 6.2 è®¤è¯ä¸æˆæƒ

**OAuth2.0 + JWTè®¤è¯**ï¼š
```java
@Configuration
@EnableResourceServer
public class ResourceServerConfig extends ResourceServerConfigurerAdapter {
    @Value("${security.oauth2.resource.jwk.key-set-uri}")
    private String jwkSetUri;

    @Override
    public void configure(ResourceServerSecurityConfigurer resources) {
        resources
            .resourceId("order-service")
            .tokenStore(tokenStore());
    }

    @Override
    public void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests()
                .antMatchers("/api/public/**").permitAll()
                .antMatchers("/api/orders/**").hasRole("USER")
                .antMatchers("/api/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
            .and()
            .cors()
            .and()
            .csrf().disable();
    }

    @Bean
    public TokenStore tokenStore() {
        return new JwkTokenStore(jwkSetUri);
    }
}
```

**APIå¯†é’¥è®¤è¯**ï¼š
```java
@Component
public class ApiKeyAuthenticationFilter extends OncePerRequestFilter {
    private static final String API_KEY_HEADER = "X-API-Key";
    private final String validApiKey;

    public ApiKeyAuthenticationFilter(@Value("${api.key}") String validApiKey) {
        this.validApiKey = validApiKey;
    }

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response,
                                    FilterChain filterChain) throws ServletException, IOException {
        String apiKey = request.getHeader(API_KEY_HEADER);

        if (apiKey == null || !apiKey.equals(validApiKey)) {
            response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);
            response.getWriter().write("Invalid or missing API key");
            return;
        }

        filterChain.doFilter(request, response);
    }
}
```

### 6.3 æœåŠ¡é—´è®¤è¯

**IstioåŒå‘TLS**ï¼š
```yaml
# ä¸ºå‘½åç©ºé—´å¯ç”¨ä¸¥æ ¼çš„åŒå‘TLS
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
  namespace: default
spec:
  mtls:
    mode: STRICT
---
# é…ç½®ç›®æ ‡è§„åˆ™
apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: default
  namespace: default
spec:
  host: "*.default.svc.cluster.local"
  trafficPolicy:
    tls:
      mode: ISTIO_MUTUAL
```

---

## 7. é€šä¿¡å¯é æ€§ä¿éšœ

### 7.1 é‡è¯•æœºåˆ¶

**Spring Retryå®ç°**ï¼š
```java
@Configuration
@EnableRetry
public class RetryConfig {
    @Bean
    public RetryTemplate retryTemplate() {
        RetryTemplate retryTemplate = new RetryTemplate();

        // é‡è¯•ç­–ç•¥ï¼šæœ€å¤šé‡è¯•3æ¬¡
        SimpleRetryPolicy retryPolicy = new SimpleRetryPolicy();
        retryPolicy.setMaxAttempts(3);

        // é€€é¿ç­–ç•¥ï¼šæŒ‡æ•°é€€é¿
        ExponentialBackOffPolicy backOffPolicy = new ExponentialBackOffPolicy();
        backOffPolicy.setInitialInterval(1000); // åˆå§‹å»¶è¿Ÿ1ç§’
        backOffPolicy.setMultiplier(2); // å€æ•°
        backOffPolicy.setMaxInterval(5000); // æœ€å¤§å»¶è¿Ÿ5ç§’

        retryTemplate.setRetryPolicy(retryPolicy);
        retryTemplate.setBackOffPolicy(backOffPolicy);

        return retryTemplate;
    }
}
```

**ä½¿ç”¨é‡è¯•æ¨¡æ¿**ï¼š
```java
@Service
public class InventoryServiceClient {
    private final RestTemplate restTemplate;
    private final RetryTemplate retryTemplate;
    private static final Logger logger = LoggerFactory.getLogger(InventoryServiceClient.class);

    @Autowired
    public InventoryServiceClient(RestTemplate restTemplate, RetryTemplate retryTemplate) {
        this.restTemplate = restTemplate;
        this.retryTemplate = retryTemplate;
    }

    public InventoryResponse checkInventory(InventoryRequest request) {
        return retryTemplate.execute(
            retryContext -> {
                logger.info("Checking inventory, attempt: {}", retryContext.getRetryCount() + 1);
                return restTemplate.postForObject(
                    "http://inventory-service/api/inventory/check",
                    request,
                    InventoryResponse.class
                );
            },
            retryContext -> {
                // é‡è¯•è€—å°½åçš„é™çº§å¤„ç†
                logger.warn("All retry attempts failed, returning default response");
                return new InventoryResponse(false, Collections.emptyList());
            },
            // åªå¯¹ç‰¹å®šå¼‚å¸¸é‡è¯•
            new SimpleRetryPolicy() {{ 
                setRetryableExceptions(
                    Collections.singletonMap(ResourceAccessException.class, true),
                    Collections.singletonMap(HttpServerErrorException.class, true)
                );
            }}
        );
    }
}
```

### 7.2 ç†”æ–­å™¨æ¨¡å¼

**Resilience4jå®ç°**ï¼š
```java
@Configuration
public class CircuitBreakerConfig {
    @Bean
    public io.github.resilience4j.circuitbreaker.CircuitBreakerRegistry circuitBreakerRegistry() {
        CircuitBreakerConfig config = CircuitBreakerConfig.custom()
            .failureRateThreshold(50) // å¤±è´¥ç‡é˜ˆå€¼ï¼Œè¶…è¿‡æ­¤å€¼å°†æ‰“å¼€ç†”æ–­å™¨
            .slidingWindowSize(20) // æ»‘åŠ¨çª—å£å¤§å°
            .minimumNumberOfCalls(5) // æœ€å°è°ƒç”¨æ¬¡æ•°
            .waitDurationInOpenState(Duration.ofSeconds(60)) // ç†”æ–­å™¨æ‰“å¼€çŠ¶æ€æŒç»­æ—¶é—´
            .permittedNumberOfCallsInHalfOpenState(3) // åŠå¼€çŠ¶æ€å…è®¸çš„è°ƒç”¨æ¬¡æ•°
            .recordExceptions(IOException.class, TimeoutException.class, HttpServerErrorException.class)
            .ignoreExceptions(IllegalArgumentException.class)
            .build();

        return CircuitBreakerRegistry.of(config);
    }
}
```

**ä½¿ç”¨ç†”æ–­å™¨**ï¼š
```java
@Service
public class PaymentServiceClient {
    private final RestTemplate restTemplate;
    private final CircuitBreakerRegistry circuitBreakerRegistry;
    private static final Logger logger = LoggerFactory.getLogger(PaymentServiceClient.class);

    @Autowired
    public PaymentServiceClient(RestTemplate restTemplate, CircuitBreakerRegistry circuitBreakerRegistry) {
        this.restTemplate = restTemplate;
        this.circuitBreakerRegistry = circuitBreakerRegistry;
    }

    public PaymentResponse processPayment(PaymentRequest request) {
        CircuitBreaker circuitBreaker = circuitBreakerRegistry.circuitBreaker("paymentService");

        return Try.ofSupplier(CircuitBreaker.decorateSupplier(circuitBreaker, () -> {
            logger.info("Processing payment: {}", request.getOrderId());
            return restTemplate.postForObject(
                "http://payment-service/api/payments/process",
                request,
                PaymentResponse.class
            );
        }))
        .recover(Exception.class, e -> {
            logger.error("Payment processing failed", e);
            return new PaymentResponse(
                request.getOrderId(),
                PaymentStatus.FAILED,
                "Payment service unavailable",
                null
            );
        })
        .get();
    }
}
```

### 7.3 è¶…æ—¶æ§åˆ¶

**å…¨å±€è¶…æ—¶é…ç½®**ï¼š
```java
@Configuration
public class RestTemplateConfig {
    @Bean
    public RestTemplate restTemplate() {
        HttpComponentsClientHttpRequestFactory requestFactory = new HttpComponentsClientHttpRequestFactory();
        // è¿æ¥è¶…æ—¶
        requestFactory.setConnectTimeout(3000);
        // è¯»å–è¶…æ—¶
        requestFactory.setReadTimeout(5000);
        // è¿æ¥æ± æœ€å¤§è¿æ¥æ•°
        requestFactory.setHttpClient(HttpClients.custom()
            .setMaxConnTotal(200)
            .setMaxConnPerRoute(50)
            .build());

        return new RestTemplate(requestFactory);
    }
}
```

**Feignå®¢æˆ·ç«¯è¶…æ—¶**ï¼š
```yaml
# application.yaml
feign:
  client:
    config:
      default:
        connectTimeout: 3000
        readTimeout: 5000
        loggerLevel: basic
      payment-service:
        connectTimeout: 2000
        readTimeout: 4000
```

### 7.4 èˆ±å£æ¨¡å¼

**çº¿ç¨‹æ± éš”ç¦»**ï¼š
```java
@Configuration
public class ThreadPoolConfig {
    @Bean(name = "inventoryServiceExecutor")
    public Executor inventoryServiceExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.setMaxPoolSize(10);
        executor.setQueueCapacity(20);
        executor.setThreadNamePrefix("inventory-");
        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());
        executor.initialize();
        return executor;
    }

    @Bean(name = "paymentServiceExecutor")
    public Executor paymentServiceExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.setMaxPoolSize(10);
        executor.setQueueCapacity(20);
        executor.setThreadNamePrefix("payment-");
        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());
        executor.initialize();
        return executor;
    }
}
```

**ä½¿ç”¨éš”ç¦»çº¿ç¨‹æ± **ï¼š
```java
@Service
public class OrderProcessingService {
    private final InventoryServiceClient inventoryServiceClient;
    private final PaymentServiceClient paymentServiceClient;
    private final OrderRepository orderRepository;

    @Autowired
    public OrderProcessingService(InventoryServiceClient inventoryServiceClient,
                                 PaymentServiceClient paymentServiceClient,
                                 OrderRepository orderRepository) {
        this.inventoryServiceClient = inventoryServiceClient;
        this.paymentServiceClient = paymentServiceClient;
        this.orderRepository = orderRepository;
    }

    @Async("inventoryServiceExecutor")
    public CompletableFuture<InventoryResponse> checkInventoryAsync(OrderRequest request) {
        return CompletableFuture.supplyAsync(() ->
            inventoryServiceClient.checkInventory(buildInventoryRequest(request))
        );
    }

    @Async("paymentServiceExecutor")
    public CompletableFuture<PaymentResponse> processPaymentAsync(OrderDTO order) {
        return CompletableFuture.supplyAsync(() ->
            paymentServiceClient.processPayment(buildPaymentRequest(order))
        );
    }

    public CompletableFuture<OrderDTO> processOrderAsync(OrderRequest request) {
        return checkInventoryAsync(request)
            .thenCompose(inventoryResponse -> {
                if (inventoryResponse.isAvailable()) {
                    OrderDTO order = createOrder(request);
                    return processPaymentAsync(order)
                        .thenApply(paymentResponse -> {
                            updateOrderStatus(order, paymentResponse);
                            return order;
                        });
                } else {
                    return CompletableFuture.failedFuture(
                        new InsufficientInventoryException("Inventory not available")
                    );
                }
            });
    }

    // å…¶ä»–è¾…åŠ©æ–¹æ³•çœç•¥...
}
```

---

## 8. æ€§èƒ½ä¼˜åŒ–å®è·µ

### 8.1 è¿æ¥æ± ä¼˜åŒ–

**æ•°æ®åº“è¿æ¥æ± é…ç½®**ï¼š
```yaml
# application.yaml
spring:
  datasource:
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      idle-timeout: 300000
      connection-timeout: 20000
      max-lifetime: 1800000
      connection-test-query: SELECT 1
      pool-name: OrderServiceHikariCP
```

**HTTPè¿æ¥æ± é…ç½®**ï¼š
```java
@Configuration
public class HttpClientConfig {
    @Bean
    public CloseableHttpClient httpClient() {
        PoolingHttpClientConnectionManager connectionManager = new PoolingHttpClientConnectionManager();
        // æœ€å¤§è¿æ¥æ•°
        connectionManager.setMaxTotal(200);
        // æ¯ä¸ªè·¯ç”±æœ€å¤§è¿æ¥æ•°
        connectionManager.setDefaultMaxPerRoute(50);
        // è®¾ç½®è¿æ¥è¶…æ—¶
        RequestConfig requestConfig = RequestConfig.custom()
            .setConnectTimeout(3000)
            .setSocketTimeout(5000)
            .setConnectionRequestTimeout(2000)
            .build();

        return HttpClients.custom()
            .setConnectionManager(connectionManager)
            .setDefaultRequestConfig(requestConfig)
            .setRetryHandler(new DefaultHttpRequestRetryHandler(3, true))
            .build();
    }

    @Bean
    public RestTemplate restTemplate() {
        return new RestTemplate(new HttpComponentsClientHttpRequestFactory(httpClient()));
    }
}
```

### 8.2 æ•°æ®åºåˆ—åŒ–ä¼˜åŒ–

**Protocol Buffersä½¿ç”¨**ï¼š
```protobuf
syntax = "proto3";

package com.example.order;

message Order {
    int64 id = 1;
    int64 user_id = 2;
    OrderStatus status = 3;
    repeated OrderItem items = 4;
    double total_amount = 5;
    string created_at = 6;
}

enum OrderStatus {
    CREATED = 0;
    PAID = 1;
    SHIPPED = 2;
    DELIVERED = 3;
    CANCELLED = 4;
}

message OrderItem {
    int64 product_id = 1;
    string name = 2;
    int32 quantity = 3;
    double price = 4;
}

message OrderRequest {
    int64 user_id = 1;
    repeated OrderItem items = 2;
}

message OrderResponse {
    bool success = 1;
    string message = 2;
    Order order = 3;
}
```

**Javaä¸­ä½¿ç”¨Protobuf**ï¼š
```java
@Service
public class ProtobufOrderService {
    public byte[] serializeOrder(OrderDTO order) {
        OrderProto.Order.Builder orderBuilder = OrderProto.Order.newBuilder()
            .setId(order.getId())
            .setUserId(order.getUserId())
            .setStatus(convertStatus(order.getStatus()))
            .setTotalAmount(order.getTotalAmount())
            .setCreatedAt(order.getCreatedAt().toString());

        for (OrderItemDTO item : order.getItems()) {
            OrderProto.OrderItem itemProto = OrderProto.OrderItem.newBuilder()
                .setProductId(item.getProductId())
                .setName(item.getName())
                .setQuantity(item.getQuantity())
                .setPrice(item.getPrice())
                .build();
            orderBuilder.addItems(itemProto);
        }

        return orderBuilder.build().toByteArray();
    }

    public OrderDTO deserializeOrder(byte[] data) {
        try {
            OrderProto.Order orderProto = OrderProto.Order.parseFrom(data);
            // è½¬æ¢ä¸ºOrderDTO
            // ...
        } catch (InvalidProtocolBufferException e) {
            throw new RuntimeException("Failed to deserialize order", e);
        }
    }

    private OrderProto.OrderStatus convertStatus(OrderStatus status) {
        switch (status) {
            case CREATED: return OrderProto.OrderStatus.CREATED;
            case PAID: return OrderProto.OrderStatus.PAID;
            case SHIPPED: return OrderProto.OrderStatus.SHIPPED;
            case DELIVERED: return OrderProto.OrderStatus.DELIVERED;
            case CANCELLED: return OrderProto.OrderStatus.CANCELLED;
            default: throw new IllegalArgumentException("Unknown status: " + status);
        }
    }
}
```

### 8.3 ç¼“å­˜ç­–ç•¥

**å¤šçº§ç¼“å­˜å®ç°**ï¼š
```java
@Configuration
@EnableCaching
public class CacheConfig {
    @Bean
    public CacheManager cacheManager(RedisConnectionFactory redisConnectionFactory) {
        // æœ¬åœ°ç¼“å­˜é…ç½®
        CaffeineCacheManager caffeineCacheManager = new CaffeineCacheManager();
        caffeineCacheManager.setCaffeine(Caffeine.newBuilder()
            .expireAfterWrite(5, TimeUnit.MINUTES)
            .maximumSize(10_000));

        // Redisç¼“å­˜é…ç½®
        RedisCacheConfiguration redisCacheConfig = RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofMinutes(30))
            .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(new StringRedisSerializer()))
            .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer()));

        RedisCacheManager redisCacheManager = RedisCacheManager.builder(redisConnectionFactory)
            .cacheDefaults(redisCacheConfig)
            .withCacheConfiguration("products",
                RedisCacheConfiguration.defaultCacheConfig().entryTtl(Duration.ofHours(24)))
            .withCacheConfiguration("orders",
                RedisCacheConfiguration.defaultCacheConfig().entryTtl(Duration.ofMinutes(10)))
            .build();

        // å¤šçº§ç¼“å­˜ç®¡ç†å™¨
        CompositeCacheManager compositeCacheManager = new CompositeCacheManager(caffeineCacheManager, redisCacheManager);
        compositeCacheManager.setFallbackToNoOpCache(false);

        return compositeCacheManager;
    }
}
```

**ä½¿ç”¨ç¼“å­˜**ï¼š
```java
@Service
public class ProductServiceImpl implements ProductService {
    private final ProductRepository productRepository;

    @Autowired
    public ProductServiceImpl(ProductRepository productRepository) {
        this.productRepository = productRepository;
    }

    @Cacheable(value = "products", key = "#id")
    @Override
    public ProductDTO findById(Long id) {
        return productRepository.findById(id)
            .map(this::convertToDTO)
            .orElseThrow(() -> new ProductNotFoundException(id));
    }

    @Cacheable(value = "products", key = "#category")
    @Override
    public List<ProductDTO> findByCategory(String category) {
        return productRepository.findByCategory(category)
            .stream()
            .map(this::convertToDTO)
            .collect(Collectors.toList());
    }

    @CacheEvict(value = "products", key = "#product.id")
    @Override
    public ProductDTO updateProduct(ProductDTO product) {
        // æ›´æ–°äº§å“é€»è¾‘
    }

    @CachePut(value = "products", key = "#result.id")
    @Override
    public ProductDTO createProduct(ProductCreateRequest request) {
        // åˆ›å»ºäº§å“é€»è¾‘
    }

    @Caching(evict = {
        @CacheEvict(value = "products", key = "#id"),
        @CacheEvict(value = "products", allEntries = true, condition = "#category != null")
    })
    @Override
    public void deleteProduct(Long id, String category) {
        productRepository.deleteById(id);
    }
}
```

---

## 9. è·¨è¯­è¨€é€šä¿¡æ–¹æ¡ˆ

### 9.1 å¤šè¯­è¨€æœåŠ¡é€šä¿¡

**é€šä¿¡ç­–ç•¥**ï¼š
- ä½¿ç”¨è¯­è¨€æ— å…³çš„åè®®ï¼ˆHTTP/gRPCï¼‰
- å®šä¹‰æ˜ç¡®çš„APIå¥‘çº¦
- ä½¿ç”¨æ ‡å‡†åŒ–çš„æ•°æ®æ ¼å¼
- å®ç°è·¨è¯­è¨€æœåŠ¡å‘ç°
- å»ºç«‹ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶

**è·¨è¯­è¨€é€šä¿¡ç¤ºä¾‹**ï¼š
- JavaæœåŠ¡ä½¿ç”¨Spring Boot
- Node.jsæœåŠ¡ä½¿ç”¨Express
- PythonæœåŠ¡ä½¿ç”¨Django/Flask
- GoæœåŠ¡ä½¿ç”¨æ ‡å‡†åº“
- .NETæœåŠ¡ä½¿ç”¨ASP.NET Core

### 9.2 APIå¥‘çº¦æµ‹è¯•

**ä½¿ç”¨Pactè¿›è¡Œè·¨è¯­è¨€å¥‘çº¦æµ‹è¯•**ï¼š

**æ¶ˆè´¹è€…ç«¯ï¼ˆNode.jsï¼‰**ï¼š
```javascript
const { Pact } = require('@pact-foundation/pact');
const { ProductClient } = require('../client/productClient');
const { expect } = require('chai');

describe('Product Service Client', () => {
  const provider = new Pact({
    consumer: 'OrderService',
    provider: 'ProductService',
    port: 8888
  });

  beforeAll(() => provider.setup());
  afterAll(() => provider.finalize());

  describe('get product', () => {
    beforeEach(() => {
      return provider.addInteraction({
        state: 'a product with ID 1 exists',
        uponReceiving: 'a request for product by ID',
        withRequest: {
          method: 'GET',
          path: '/api/products/1'
        },
        willRespondWith: {
          status: 200,
          headers: { 'Content-Type': 'application/json' },
          body: {
            id: 1,
            name: 'Test Product',
            price: 99.99,
            category: 'Test Category'
          }
        }
      });
    });

    it('should return the product', async () => {
      const client = new ProductClient(provider.mockService.baseUrl);
      const product = await client.getProduct(1);
      expect(product.id).to.equal(1);
      expect(product.name).to.equal('Test Product');
    });
  });
});
```

**ç”Ÿäº§è€…ç«¯ï¼ˆJavaï¼‰**ï¼š
```java
@SpringBootTest
@AutoConfigureMockMvc
@PactBroker(host = "pact-broker", port = 80)
@PactVerification(fragment = "productServicePact")
public class ProductServiceContractTest {
    @Autowired
    private MockMvc mockMvc;
    @MockBean
    private ProductRepository productRepository;

    @BeforeEach
    void setUp() {
        Product product = new Product(1L, "Test Product", new BigDecimal("99.99"), "Test Category");
        when(productRepository.findById(1L)).thenReturn(Optional.of(product));
    }

    @Test
    @PactVerifyProvider("a product with ID 1 exists")
    public void verifyProductExists() throws Exception {
        mockMvc.perform(get("/api/products/1")
                .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.id").value(1))
                .andExpect(jsonPath("$.name").value("Test Product"))
                .andExpect(jsonPath("$.price").value(99.99))
                .andExpect(jsonPath("$.category").value("Test Category"));
    }

    @PactFragment("productServicePact")
    public PactFragment createFragment(ConsumerPactBuilder.PactDslWithProvider builder) {
        return builder
            .given("a product with ID 1 exists")
            .uponReceiving("a request for product by ID")
            .path("/api/products/1")
            .method("GET")
            .willRespondWith()
            .status(200)
            .headers(headers)
            .body(new PactDslJsonBody()
                .integerType("id", 1)
                .stringType("name", "Test Product")
                .decimalType("price", 99.99)
                .stringType("category", "Test Category"))
            .toFragment();
    }
}
```

### 9.3 å¤šè¯­è¨€æœåŠ¡å‘ç°

**ä½¿ç”¨Consulå®ç°è·¨è¯­è¨€æœåŠ¡å‘ç°**ï¼š

**JavaæœåŠ¡æ³¨å†Œ**ï¼š
```yaml
# application.yaml
spring:
  cloud:
    consul:
      host: consul-server
      port: 8500
      discovery:
        service-name: order-service
        instance-id: ${spring.application.name}:${vcap.application.instance_id:${spring.application.instance_id:${random.value}}}
        port: ${server.port}
        prefer-ip-address: true
        tags: version=1.0,environment=production
        health-check-path: /actuator/health
        health-check-interval: 10s
        health-check-timeout: 5s
```

**Node.jsæœåŠ¡æ³¨å†Œ**ï¼š
```javascript
const Consul = require('consul');
const express = require('express');

const app = express();
const port = process.env.PORT || 3000;

// åˆ›å»ºConsulå®¢æˆ·ç«¯
const consul = new Consul({
  host: 'consul-server',
  port: 8500,
  promisify: true
});

// å¥åº·æ£€æŸ¥ç«¯ç‚¹
app.get('/health', (req, res) => {
  res.status(200).json({ status: 'UP' });
});

// æ³¨å†ŒæœåŠ¡
async function registerService() {
  try {
    await consul.agent.service.register({
      name: 'payment-service',
      id: `payment-service-${port}`,
      address: require('os').hostname(),
      port: port,
      tags: ['version=1.0', 'environment=production', 'nodejs'],
      check: {
        http: `http://${require('os').hostname()}:${port}/health`,
        interval: '10s',
        timeout: '5s'
      }
    });
    console.log('Service registered with Consul');
  } catch (err) {
    console.error('Error registering service with Consul', err);
  }
}

// å¯åŠ¨æœåŠ¡å™¨
app.listen(port, () => {
  console.log(`Payment service listening at http://localhost:${port}`);
  registerService();
});

// é€€å‡ºæ—¶æ³¨é”€æœåŠ¡
process.on('SIGINT', async () => {
  try {
    await consul.agent.service.deregister(`payment-service-${port}`);
    console.log('Service deregistered from Consul');
    process.exit(0);
  } catch (err) {
    console.error('Error deregistering service', err);
    process.exit(1);
  }
});
```

---

## 10. æ¡ˆä¾‹åˆ†æä¸æœ€ä½³å®è·µ

### 10.1 ç”µå•†å¹³å°é€šä¿¡æ¶æ„æ¡ˆä¾‹

**æŒ‘æˆ˜**ï¼š
- é«˜å¹¶å‘è®¢å•å¤„ç†
- å¤æ‚åº“å­˜ç®¡ç†
- åˆ†å¸ƒå¼äº‹åŠ¡
- å¤šè¯­è¨€æœåŠ¡æ¶æ„

**è§£å†³æ–¹æ¡ˆ**ï¼š
- é‡‡ç”¨æ··åˆé€šä¿¡æ¨¡å¼ï¼šåŒæ­¥å¤„ç†æ ¸å¿ƒæµç¨‹ï¼Œå¼‚æ­¥å¤„ç†éå…³é”®æµç¨‹
- ä½¿ç”¨Kafkaå®ç°äº‹ä»¶é©±åŠ¨æ¶æ„
- å¼•å…¥æœåŠ¡ç½‘æ ¼ç®¡ç†æœåŠ¡é€šä¿¡
- å®ç°å¤šçº§ç¼“å­˜å‡è½»æ•°æ®åº“å‹åŠ›
- é‡‡ç”¨CQRSæ¨¡å¼åˆ†ç¦»è¯»å†™æ“ä½œ

**æ¶æ„å›¾**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Webå‰ç«¯    â”‚â”€â”€â”€â”€â–¶â”‚ API Gateway â”‚â”€â”€â”€â”€â–¶â”‚å¾®æœåŠ¡é›†ç¾¤   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â–¼                       â–¼                       â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ è®¢å•æœåŠ¡    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ åº“å­˜æœåŠ¡    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ æ”¯ä»˜æœåŠ¡    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                       â”‚                       â”‚
                       â–¼                       â–¼                       â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Kafkaé›†ç¾¤   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ é€šçŸ¥æœåŠ¡    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ åˆ†ææœåŠ¡    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 é‡‘èæœåŠ¡é€šä¿¡å®‰å…¨æ¡ˆä¾‹

**æŒ‘æˆ˜**ï¼š
- ä¸¥æ ¼çš„å®‰å…¨åˆè§„è¦æ±‚
- é«˜å¯é æ€§äº¤æ˜“å¤„ç†
- æ•æ„Ÿæ•°æ®ä¿æŠ¤
- é˜²æ”»å‡»èƒ½åŠ›

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å…¨é“¾è·¯TLSåŠ å¯†
- åŸºäºOAuth2.0+JWTçš„è®¤è¯æˆæƒ
- APIç½‘å…³å®ç°è¯·æ±‚è¿‡æ»¤å’Œé™æµ
- æœåŠ¡é—´é€šä¿¡é‡‡ç”¨åŒå‘è®¤è¯
- å®ç°å®Œæ•´çš„å®¡è®¡æ—¥å¿—

### 10.3 é€šä¿¡æ¨¡å¼é€‰æ‹©æœ€ä½³å®è·µ

1. **æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©**ï¼š
   - ç®€å•æŸ¥è¯¢ï¼šREST API
   - é«˜é¢‘å†…éƒ¨è°ƒç”¨ï¼šgRPC
   - å®æ—¶æ›´æ–°ï¼šWebSocket
   - å¼‚æ­¥å¤„ç†ï¼šæ¶ˆæ¯é˜Ÿåˆ—
   - å¤æ‚æ•°æ®æŸ¥è¯¢ï¼šGraphQL

2. **æ··åˆé€šä¿¡ç­–ç•¥**ï¼š
   - æ ¸å¿ƒæµç¨‹ï¼šåŒæ­¥é€šä¿¡ä¿è¯å³æ—¶æ€§
   - éæ ¸å¿ƒæµç¨‹ï¼šå¼‚æ­¥é€šä¿¡æé«˜ååé‡
   - é€šçŸ¥ç±»åŠŸèƒ½ï¼šå‘å¸ƒ-è®¢é˜…æ¨¡å¼

3. **æ¼”è¿›å¼æ¶æ„**ï¼š
   - åˆæœŸï¼šå•ä½“åº”ç”¨+REST API
   - ä¸­æœŸï¼šå¾®æœåŠ¡+æ¶ˆæ¯é˜Ÿåˆ—
   - æˆç†ŸæœŸï¼šæœåŠ¡ç½‘æ ¼+äº‹ä»¶é©±åŠ¨

4. **æ€§èƒ½ä¸å¯é æ€§å¹³è¡¡**ï¼š
   - å…³é”®ä¸šåŠ¡ï¼šä¼˜å…ˆä¿è¯å¯é æ€§
   - éå…³é”®ä¸šåŠ¡ï¼šä¼˜å…ˆä¿è¯æ€§èƒ½
   - æ‰¹é‡å¤„ç†ï¼šé‡‡ç”¨å¼‚æ­¥+é‡è¯•æœºåˆ¶

---

## ğŸ“š å‚è€ƒèµ„æº

1. [Microservices Patterns](https://microservices.io/patterns/index.html) - Chris Richardson
2. [Building Microservices](https://www.oreilly.com/library/view/building-microservices/9781491950357/) - Sam Newman
3. [gRPCå®˜æ–¹æ–‡æ¡£](https://grpc.io/docs/)
4. [Spring Cloudæ–‡æ¡£](https://spring.io/projects/spring-cloud)
5. [IstioæœåŠ¡ç½‘æ ¼æ–‡æ¡£](https://istio.io/docs/)
6. [Kafkaæ–‡æ¡£](https://kafka.apache.org/documentation/)
7. [Resilience4jæ–‡æ¡£](https://resilience4j.readme.io/docs)
8. [GraphQLæ–‡æ¡£](https://graphql.org/learn/)