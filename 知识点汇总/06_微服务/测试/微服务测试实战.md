# å¾®æœåŠ¡æµ‹è¯•å®æˆ˜

> æ„å»ºå…¨é¢çš„å¾®æœåŠ¡è´¨é‡ä¿éšœä½“ç³»

## ğŸ“‹ ç›®å½•

1. [å¾®æœåŠ¡æµ‹è¯•æ¦‚è¿°](#1-å¾®æœåŠ¡æµ‹è¯•æ¦‚è¿°)
2. [å•å…ƒæµ‹è¯•ç­–ç•¥](#2-å•å…ƒæµ‹è¯•ç­–ç•¥)
3. [é›†æˆæµ‹è¯•å®æˆ˜](#3-é›†æˆæµ‹è¯•å®æˆ˜)
4. [å¥‘çº¦æµ‹è¯•ä¸æ¶ˆè´¹è€…é©±åŠ¨å¼€å‘](#4-å¥‘çº¦æµ‹è¯•ä¸æ¶ˆè´¹è€…é©±åŠ¨å¼€å‘)
5. [ç«¯åˆ°ç«¯æµ‹è¯•è®¾è®¡](#5-ç«¯åˆ°ç«¯æµ‹è¯•è®¾è®¡)
6. [æ€§èƒ½ä¸è´Ÿè½½æµ‹è¯•](#6-æ€§èƒ½ä¸è´Ÿè½½æµ‹è¯•)
7. [æ··æ²Œå·¥ç¨‹å®è·µ](#7-æ··æ²Œå·¥ç¨‹å®è·µ)
8. [æµ‹è¯•è‡ªåŠ¨åŒ–ä¸CI/CDé›†æˆ](#8-æµ‹è¯•è‡ªåŠ¨åŒ–ä¸cicdé›†æˆ)
9. [æµ‹è¯•ç¯å¢ƒç®¡ç†](#9-æµ‹è¯•ç¯å¢ƒç®¡ç†)
10. [æœ€ä½³å®è·µä¸æ¡ˆä¾‹åˆ†æ](#10-æœ€ä½³å®è·µä¸æ¡ˆä¾‹åˆ†æ)

---

## 1. å¾®æœåŠ¡æµ‹è¯•æ¦‚è¿°

### 1.1 å¾®æœåŠ¡æµ‹è¯•æŒ‘æˆ˜

å¾®æœåŠ¡æ¶æ„å¼•å…¥äº†ç‹¬ç‰¹çš„æµ‹è¯•æŒ‘æˆ˜ï¼š

- **åˆ†å¸ƒå¼ç³»ç»Ÿå¤æ‚æ€§**ï¼šæœåŠ¡é—´ä¾èµ–å…³ç³»å¤æ‚
- **æœåŠ¡ç‰ˆæœ¬ç®¡ç†**ï¼šä¸åŒæœåŠ¡æœ‰ç‹¬ç«‹ç‰ˆæœ¬å‘¨æœŸ
- **æ•°æ®ä¸€è‡´æ€§**ï¼šè·¨æœåŠ¡äº‹åŠ¡éš¾ä»¥æµ‹è¯•
- **æµ‹è¯•ç¯å¢ƒ**ï¼šç»´æŠ¤å¤šä¸ªæœåŠ¡çš„æµ‹è¯•ç¯å¢ƒæˆæœ¬é«˜
- **æ•…éšœåœºæ™¯**ï¼šæ¨¡æ‹Ÿåˆ†å¸ƒå¼æ•…éšœå¤æ‚

### 1.2 æµ‹è¯•é‡‘å­—å¡”æ‰©å±•

åœ¨ä¼ ç»Ÿæµ‹è¯•é‡‘å­—å¡”åŸºç¡€ä¸Šï¼Œå¾®æœåŠ¡æµ‹è¯•å¢åŠ äº†æ›´å¤šå±‚æ¬¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç«¯åˆ°ç«¯æµ‹è¯•     â”‚ â† éªŒè¯æ•´ä¸ªç³»ç»Ÿæµç¨‹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é›†æˆæµ‹è¯•       â”‚ â† éªŒè¯æœåŠ¡é—´äº¤äº’
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¥‘çº¦æµ‹è¯•       â”‚ â† éªŒè¯æœåŠ¡æ¥å£å…¼å®¹æ€§
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç»„ä»¶æµ‹è¯•       â”‚ â† éªŒè¯æœåŠ¡å†…éƒ¨åŠŸèƒ½
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å•å…ƒæµ‹è¯•       â”‚ â† éªŒè¯ç‹¬ç«‹åŠŸèƒ½å•å…ƒ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 æµ‹è¯•ç­–ç•¥çŸ©é˜µ

| æµ‹è¯•ç±»å‹ | å·¥å…· | è‡ªåŠ¨åŒ–ç¨‹åº¦ | æ‰§è¡Œé¢‘ç‡ | ä¸»è¦ç›®æ ‡ |
|---------|------|-----------|---------|---------|
| å•å…ƒæµ‹è¯• | JUnit, Mockito | 100% | æ¯æ¬¡æäº¤ | ä»£ç æ­£ç¡®æ€§ |
| ç»„ä»¶æµ‹è¯• | Spring Boot Test | 100% | æ¯æ¬¡æ„å»º | æœåŠ¡ç‹¬ç«‹åŠŸèƒ½ |
| å¥‘çº¦æµ‹è¯• | Pact, Spring Cloud Contract | 100% | æ¯æ¬¡æäº¤ | æ¥å£å…¼å®¹æ€§ |
| é›†æˆæµ‹è¯• | TestContainers, RestAssured | 100% | æ¯æ—¥æ„å»º | æœåŠ¡é—´åä½œ |
| ç«¯åˆ°ç«¯æµ‹è¯• | Selenium, Cypress | 90% | å¤œé—´æ„å»º | ç”¨æˆ·æµç¨‹ |
| æ€§èƒ½æµ‹è¯• | JMeter, Gatling | 80% | æ¯å‘¨æ„å»º | ç³»ç»Ÿå“åº”èƒ½åŠ› |
| æ··æ²Œæµ‹è¯• | Chaos Monkey, Litmus | 50% | å®šæœŸæ‰§è¡Œ | ç³»ç»Ÿå¼¹æ€§ |

---

## 2. å•å…ƒæµ‹è¯•ç­–ç•¥

### 2.1 æœåŠ¡å±‚å•å…ƒæµ‹è¯•

ä¸“æ³¨äºæµ‹è¯•æœåŠ¡å±‚ä¸šåŠ¡é€»è¾‘ï¼Œæ¨¡æ‹Ÿå¤–éƒ¨ä¾èµ–ï¼š

```java
@ExtendWith(MockitoExtension.class)
class OrderServiceTest {
    @Mock
    private OrderRepository orderRepository;
    @Mock
    private InventoryClient inventoryClient;
    @InjectMocks
    private OrderServiceImpl orderService;

    @Test
    void shouldCreateOrderWhenInventoryAvailable() {
        // å‡†å¤‡æµ‹è¯•æ•°æ®
        OrderRequest request = new OrderRequest(1L, Arrays.asList(new OrderItem(101L, 2)));
        Order savedOrder = new Order(1L, 1L, OrderStatus.CREATED, request.getItems(), new BigDecimal("99.98"));
        when(orderRepository.save(any(Order.class))).thenReturn(savedOrder);
        when(inventoryClient.checkAndReserve(any(InventoryRequest.class)))
            .thenReturn(new InventoryResponse(true, Collections.emptyList()));

        // æ‰§è¡Œæµ‹è¯•
        OrderDTO result = orderService.createOrder(request);

        // éªŒè¯ç»“æœ
        assertNotNull(result);
        assertEquals(OrderStatus.CREATED, result.getStatus());
        assertEquals(1L, result.getUserId());
        verify(orderRepository).save(any(Order.class));
        verify(inventoryClient).checkAndReserve(any(InventoryRequest.class));
    }

    @Test
    void shouldRejectOrderWhenInventoryUnavailable() {
        // å‡†å¤‡æµ‹è¯•æ•°æ®
        OrderRequest request = new OrderRequest(1L, Arrays.asList(new OrderItem(101L, 2)));
        when(inventoryClient.checkAndReserve(any(InventoryRequest.class)))
            .thenReturn(new InventoryResponse(false, Arrays.asList(101L)));

        // æ‰§è¡Œæµ‹è¯•å¹¶éªŒè¯å¼‚å¸¸
        assertThrows(InsufficientInventoryException.class, () -> {
            orderService.createOrder(request);
        });

        // éªŒè¯åº“å­˜æœåŠ¡è¢«è°ƒç”¨ï¼Œä½†è®¢å•æœªä¿å­˜
        verify(inventoryClient).checkAndReserve(any(InventoryRequest.class));
        verify(orderRepository, never()).save(any(Order.class));
    }
}
```

### 2.2 æ§åˆ¶å™¨å±‚æµ‹è¯•

æµ‹è¯•APIå¥‘çº¦å’Œè¯·æ±‚å¤„ç†ï¼š

```java
@WebMvcTest(OrderController.class)
class OrderControllerTest {
    @Autowired
    private MockMvc mockMvc;
    @MockBean
    private OrderService orderService;
    @Autowired
    private ObjectMapper objectMapper;

    @Test
    void shouldReturnCreatedOrder() throws Exception {
        // å‡†å¤‡æµ‹è¯•æ•°æ®
        OrderRequest request = new OrderRequest(1L, Arrays.asList(new OrderItem(101L, 2)));
        OrderDTO response = new OrderDTO(1L, 1L, OrderStatus.CREATED, request.getItems(), new BigDecimal("99.98"));
        when(orderService.createOrder(any(OrderRequest.class))).thenReturn(response);

        // æ‰§è¡Œæµ‹è¯•
        mockMvc.perform(post("/api/orders")
                .contentType(MediaType.APPLICATION_JSON)
                .content(objectMapper.writeValueAsString(request)))
                .andExpect(status().isCreated())
                .andExpect(jsonPath("$.id").value(1L))
                .andExpect(jsonPath("$.status").value("CREATED"))
                .andExpect(jsonPath("$.userId").value(1L));

        verify(orderService).createOrder(any(OrderRequest.class));
    }
}
```

### 2.3 å•å…ƒæµ‹è¯•æœ€ä½³å®è·µ

- **æµ‹è¯•éš”ç¦»**ï¼šæ¯ä¸ªæµ‹è¯•ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¾èµ–å¤–éƒ¨èµ„æº
- **æ¨¡æ‹Ÿå¤–éƒ¨ä¾èµ–**ï¼šä½¿ç”¨Mockitoæ¨¡æ‹Ÿæ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œå…¶ä»–æœåŠ¡
- **å…³æ³¨ä¸šåŠ¡é€»è¾‘**ï¼šé‡ç‚¹æµ‹è¯•å¤æ‚ä¸šåŠ¡è§„åˆ™å’Œè¾¹ç•Œæ¡ä»¶
- **ä¿æŒæµ‹è¯•å¿«é€Ÿ**ï¼šå•å…ƒæµ‹è¯•åº”åœ¨æ¯«ç§’çº§å®Œæˆ
- **é«˜è¦†ç›–ç‡ä½†ä¸ç›²ç›®è¿½æ±‚**ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘äº‰å–>80%è¦†ç›–ç‡
- **æµ‹è¯•è¡Œä¸ºè€Œéå®ç°**ï¼šå…³æ³¨è¾“å‡ºç»“æœè€Œéå†…éƒ¨æ–¹æ³•è°ƒç”¨

---

## 3. é›†æˆæµ‹è¯•å®æˆ˜

### 3.1 æ•°æ®åº“é›†æˆæµ‹è¯•

ä½¿ç”¨TestContainersè¿›è¡ŒçœŸå®æ•°æ®åº“æµ‹è¯•ï¼š

```java
@SpringBootTest
@Testcontainers
class OrderRepositoryIntegrationTest {
    @Container
    static PostgreSQLContainer<?> postgres = new PostgreSQLContainer<>("postgres:13")
            .withDatabaseName("testdb")
            .withUsername("test")
            .withPassword("test");

    @DynamicPropertySource
    static void registerProperties(DynamicPropertyRegistry registry) {
        registry.add("spring.datasource.url", postgres::getJdbcUrl);
        registry.add("spring.datasource.username", postgres::getUsername);
        registry.add("spring.datasource.password", postgres::getPassword);
    }

    @Autowired
    private OrderRepository orderRepository;
    @Autowired
    private JdbcTemplate jdbcTemplate;

    @BeforeEach
    void setUp() {
        // åˆå§‹åŒ–æµ‹è¯•æ•°æ®
        jdbcTemplate.execute("TRUNCATE TABLE orders CASCADE");
        jdbcTemplate.execute("INSERT INTO orders (id, user_id, status, total_amount) VALUES (1, 1, 'CREATED', 99.98)");
    }

    @Test
    void shouldFindOrderById() {
        Optional<Order> order = orderRepository.findById(1L);
        assertTrue(order.isPresent());
        assertEquals(1L, order.get().getUserId());
        assertEquals(OrderStatus.CREATED, order.get().getStatus());
    }
}
```

### 3.2 æœåŠ¡é—´é›†æˆæµ‹è¯•

æµ‹è¯•å¤šä¸ªæœåŠ¡åä½œï¼š

```java
@SpringBootTest
@AutoConfigureMockMvc
class OrderServiceIntegrationTest {
    @Autowired
    private MockMvc mockMvc;
    @Autowired
    private ObjectMapper objectMapper;
    @MockBean
    private PaymentService paymentService;
    @TestConfiguration
    static class TestConfig {
        @Bean
        public InventoryClient inventoryClient() {
            // ä½¿ç”¨WireMockæ¨¡æ‹Ÿåº“å­˜æœåŠ¡
            return new InventoryClient("http://localhost:${wiremock.server.port}");
        }
    }

    @Rule
    public WireMockRule wireMockRule = new WireMockRule(wireMockConfig().dynamicPort());

    @Test
    void shouldCreateOrderWhenAllServicesAvailable() throws Exception {
        // é…ç½®WireMockæ¨¡æ‹Ÿåº“å­˜æœåŠ¡å“åº”
        stubFor(post(urlEqualTo("/inventory/check"))
                .willReturn(aResponse()
                        .withStatus(200)
                        .withHeader("Content-Type", "application/json")
                        .withBody("{\"available\": true, \"unavailableItems\": []}")));

        // æ¨¡æ‹Ÿæ”¯ä»˜æœåŠ¡
        when(paymentService.processPayment(any(PaymentRequest.class)))
                .thenReturn(new PaymentResponse("PAY123", PaymentStatus.COMPLETED));

        // æ‰§è¡ŒAPIæµ‹è¯•
        OrderRequest request = new OrderRequest(1L, Arrays.asList(new OrderItem(101L, 2)));
        mockMvc.perform(post("/api/orders")
                .contentType(MediaType.APPLICATION_JSON)
                .content(objectMapper.writeValueAsString(request)))
                .andExpect(status().isCreated())
                .andExpect(jsonPath("$.status").value("PAID"));

        // éªŒè¯WireMockäº¤äº’
        verify(postRequestedFor(urlEqualTo("/inventory/check"))
                .withRequestBody(matchingJsonPath("$.orderItems[0].productId", equalTo(101)))
                .withRequestBody(matchingJsonPath("$.orderItems[0].quantity", equalTo(2))));
    }
}
```

### 3.3 é›†æˆæµ‹è¯•æœ€ä½³å®è·µ

- **ä½¿ç”¨çœŸå®ä¾èµ–**ï¼šå°½å¯èƒ½ä½¿ç”¨çœŸå®æœåŠ¡è€Œéæ¨¡æ‹Ÿ
- **æ§åˆ¶æµ‹è¯•ç¯å¢ƒ**ï¼šä½¿ç”¨Dockerå®¹å™¨ç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§
- **æµ‹è¯•å…³é”®è·¯å¾„**ï¼šä¸“æ³¨äºæ ¸å¿ƒä¸šåŠ¡æµç¨‹
- **æ•°æ®éš”ç¦»**ï¼šæ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹æ•°æ®é›†
- **æ¸…ç†èµ„æº**ï¼šæµ‹è¯•åæ¸…ç†æ•°æ®åº“å’Œå¤–éƒ¨èµ„æº
- **å¹¶è¡Œæ‰§è¡Œ**ï¼šåˆç†ç»„ç»‡æµ‹è¯•ä»¥æ”¯æŒå¹¶è¡Œè¿è¡Œ

---

## 4. å¥‘çº¦æµ‹è¯•ä¸æ¶ˆè´¹è€…é©±åŠ¨å¼€å‘

### 4.1 Spring Cloud Contractå®æˆ˜

**ç”Ÿäº§è€…ç«¯é…ç½®**ï¼š

```java
@SpringBootTest
@AutoConfigureStubRunner(ids = "com.example:inventory-service:+:stubs:8090")
class OrderServiceContractTest {
    @Autowired
    private OrderService orderService;

    @Test
    void shouldReserveInventory() {
        // æµ‹è¯•å°†ä½¿ç”¨InventoryæœåŠ¡çš„å­˜æ ¹
        InventoryRequest request = new InventoryRequest(Arrays.asList(new InventoryItem(101L, 2)));
        InventoryResponse response = orderService.checkAndReserveInventory(request);
        assertTrue(response.isAvailable());
    }
}
```

**å¥‘çº¦å®šä¹‰**ï¼š

```groovy
contractsDslDir = file("src/test/resources/contracts")

contracts {
    packageWithBaseClasses = 'com.example.inventory.contract'
    baseClassForTests = 'InventoryContractBaseClass'
}

// å¥‘çº¦æ–‡ä»¶ src/test/resources/contracts/checkInventory.groovy
import org.springframework.cloud.contract.spec.Contract

Contract.make {
    description "should check inventory availability"

    request {
        method POST()
        url "/inventory/check"
        headers {
            contentType applicationJson()
        }
        body(
            orderItems: [
                [productId: 101L, quantity: 2]
            ]
        )
    }

    response {
        status 200
        headers {
            contentType applicationJson()
        }
        body(
            available: true,
            unavailableItems: []
        )
    }
}
```

### 4.2 Pactå¥‘çº¦æµ‹è¯•

**æ¶ˆè´¹è€…æµ‹è¯•**ï¼š

```java
@ExtendWith(PactConsumerTestExt.class)
class OrderServicePactTest {
    @Pact(consumer = "OrderService", provider = "InventoryService")
    public RequestResponsePact createPact(PactDslWithProvider builder) {
        return builder
            .given("inventory is available")
            .uponReceiving("a request to check inventory")
            .path("/inventory/check")
            .method("POST")
            .headers(Map.of("Content-Type", "application/json"))
            .body(PactDslJsonBody()
                .array("orderItems")
                    .object()
                        .numberType("productId", 101L)
                        .numberType("quantity", 2)
                    .closeObject()
                .closeArray())
            .willRespondWith()
            .status(200)
            .headers(Map.of("Content-Type", "application/json"))
            .body(PactDslJsonBody()
                .booleanType("available", true)
                .array("unavailableItems")
                .closeArray())
            .toPact();
    }

    @Test
    @PactTestFor(pactMethod = "createPact")
    void testInventoryCheck(MockServer mockServer) {
        InventoryClient client = new InventoryClient(mockServer.getUrl());
        InventoryResponse response = client.checkInventory(
            new InventoryRequest(Arrays.asList(new InventoryItem(101L, 2))));

        assertTrue(response.isAvailable());
        assertTrue(response.getUnavailableItems().isEmpty());
    }
}
```

### 4.3 å¥‘çº¦æµ‹è¯•æœ€ä½³å®è·µ

- **å¥‘çº¦å³æ–‡æ¡£**ï¼šç¡®ä¿å¥‘çº¦æ¸…æ™°åæ˜ APIè§„èŒƒ
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šå¦¥å–„ç®¡ç†å¥‘çº¦ç‰ˆæœ¬
- **è‡ªåŠ¨åŒ–éªŒè¯**ï¼šé›†æˆåˆ°CI/CDæµç¨‹
- **é¿å…è¿‡åº¦æŒ‡å®š**ï¼šä¸“æ³¨äºå…³é”®å“åº”å­—æ®µ
- **å®šæœŸåŒæ­¥**ï¼šä¿æŒæ¶ˆè´¹è€…å’Œç”Ÿäº§è€…å¥‘çº¦ä¸€è‡´
- **å¥‘çº¦åå•†**ï¼šå»ºç«‹å›¢é˜Ÿé—´å¥‘çº¦å˜æ›´æ²Ÿé€šæœºåˆ¶

---

## 5. ç«¯åˆ°ç«¯æµ‹è¯•è®¾è®¡

### 5.1 Selenium WebDriveræµ‹è¯•

```java
public class OrderFlowE2ETest {
    private WebDriver driver;
    private OrderPage orderPage;
    private ProductPage productPage;
    private CheckoutPage checkoutPage;

    @BeforeEach
    void setUp() {
        // åˆå§‹åŒ–æµè§ˆå™¨é©±åŠ¨
        driver = new ChromeDriver();
        driver.manage().window().maximize();
        driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));

        // åˆå§‹åŒ–é¡µé¢å¯¹è±¡
        orderPage = new OrderPage(driver);
        productPage = new ProductPage(driver);
        checkoutPage = new CheckoutPage(driver);

        // å‡†å¤‡æµ‹è¯•æ•°æ®
        TestDataGenerator.createTestUser();
    }

    @AfterEach
    void tearDown() {
        driver.quit();
        // æ¸…ç†æµ‹è¯•æ•°æ®
        TestDataGenerator.cleanupTestData();
    }

    @Test
    void shouldCompleteOrderFromProductSelectionToCheckout() {
        // ç™»å½•ç³»ç»Ÿ
        LoginPage loginPage = new LoginPage(driver);
        loginPage.navigateTo();
        loginPage.login("testuser", "password");

        // æµè§ˆäº§å“å¹¶æ·»åŠ åˆ°è´­ç‰©è½¦
        productPage.navigateTo();
        productPage.searchProduct("Wireless Headphones");
        productPage.addToCart(1);

        // æŸ¥çœ‹è´­ç‰©è½¦å¹¶ä¸‹å•
        orderPage.navigateToCart();
        orderPage.verifyProductInCart("Wireless Headphones");
        orderPage.proceedToCheckout();

        // å¡«å†™é…é€ä¿¡æ¯
        checkoutPage.enterShippingAddress(
            "John Doe", "123 Test St", "Test City", "12345");
        checkoutPage.chooseShippingMethod("Standard");
        checkoutPage.proceedToPayment();

        // å®Œæˆæ”¯ä»˜
        checkoutPage.enterPaymentDetails(
            "4111111111111111", "12/25", "123");
        checkoutPage.placeOrder();

        // éªŒè¯è®¢å•æˆåŠŸ
        assertTrue(checkoutPage.isOrderSuccess());
        String orderNumber = checkoutPage.getOrderNumber();
        assertNotNull(orderNumber);

        // éªŒè¯è®¢å•çŠ¶æ€
        orderPage.navigateToOrderHistory();
        assertTrue(orderPage.isOrderInHistory(orderNumber));
        assertEquals("Processing", orderPage.getOrderStatus(orderNumber));
    }
}
```

### 5.2 Cypresså‰ç«¯æµ‹è¯•

```javascript
// cypress/integration/order_flow.spec.js
describe('Order Flow', () => {
  beforeEach(() => {
    // è®¾ç½®æµ‹è¯•æ•°æ®
    cy.intercept('GET', '/api/products/*', {
      id: 101,
      name: 'Wireless Headphones',
      price: 99.99,
      stock: 10
    }).as('getProduct');

    // ç™»å½•
    cy.login('testuser', 'password');
  });

  it('should complete order from product selection to checkout', () => {
    // æµè§ˆäº§å“
    cy.visit('/products');
    cy.contains('Wireless Headphones').click();
    cy.url().should('include', '/products/101');

    // æ·»åŠ åˆ°è´­ç‰©è½¦
    cy.get('[data-testid="add-to-cart"]').click();
    cy.get('[data-testid="cart-count"]').should('contain', '1');

    // æŸ¥çœ‹è´­ç‰©è½¦
    cy.get('[data-testid="cart-icon"]').click();
    cy.contains('Wireless Headphones').should('be.visible');
    cy.get('[data-testid="checkout-button"]').click();

    // å¡«å†™é…é€ä¿¡æ¯
    cy.get('[data-testid="shipping-form"]').within(() => {
      cy.get('[name="name"]').type('John Doe');
      cy.get('[name="address"]').type('123 Test St');
      cy.get('[name="city"]').type('Test City');
      cy.get('[name="zip"]').type('12345');
      cy.get('[type="submit"]').click();
    });

    // é€‰æ‹©é…é€æ–¹å¼
    cy.get('[data-testid="shipping-method-standard"]').click();
    cy.get('[data-testid="continue-to-payment"]').click();

    // å¡«å†™æ”¯ä»˜ä¿¡æ¯
    cy.get('[data-testid="payment-form"]').within(() => {
      cy.get('[name="cardNumber"]').type('4111111111111111');
      cy.get('[name="expiry"]').type('1225');
      cy.get('[name="cvc"]').type('123');
      cy.get('[type="submit"]').click();
    });

    // éªŒè¯è®¢å•æˆåŠŸ
    cy.url().should('include', '/order-confirmation');
    cy.contains('Thank you for your order!').should('be.visible');
    cy.get('[data-testid="order-number"]').should('exist');
  });
});
```

### 5.3 ç«¯åˆ°ç«¯æµ‹è¯•æœ€ä½³å®è·µ

- **å…³æ³¨æ ¸å¿ƒæµç¨‹**ï¼šä¼˜å…ˆæµ‹è¯•å…³é”®ä¸šåŠ¡æµç¨‹
- **æ¨¡æ‹Ÿå¤–éƒ¨ä¾èµ–**ï¼šä½¿ç”¨æœåŠ¡è™šæ‹ŸåŒ–å‡å°‘ç¯å¢ƒå¤æ‚æ€§
- **æ•°æ®ç®¡ç†**ï¼šå»ºç«‹å¯é çš„æµ‹è¯•æ•°æ®åˆ›å»ºå’Œæ¸…ç†æœºåˆ¶
- **å¹¶è¡Œæ‰§è¡Œ**ï¼šå‡å°‘ç«¯åˆ°ç«¯æµ‹è¯•å¥—ä»¶æ‰§è¡Œæ—¶é—´
- **æ™ºèƒ½ç­‰å¾…**ï¼šä½¿ç”¨æ˜¾å¼ç­‰å¾…è€Œéå›ºå®šå»¶è¿Ÿ
- **é”™è¯¯æˆªå›¾**ï¼šå¤±è´¥æ—¶è‡ªåŠ¨æ•è·å±å¹•æˆªå›¾
- **ç¯å¢ƒéš”ç¦»**ï¼šä¸“ç”¨E2Eæµ‹è¯•ç¯å¢ƒï¼Œé¿å…ä¸å¼€å‘å†²çª

---

## 6. æ€§èƒ½ä¸è´Ÿè½½æµ‹è¯•

### 6.1 JMeteræµ‹è¯•è®¡åˆ’

åˆ›å»ºJMeteræµ‹è¯•è®¡åˆ’è¯„ä¼°è®¢å•æœåŠ¡æ€§èƒ½ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2" properties="5.0" jmeter="5.4.3">
  <hashTree>
    <TestPlan guiclass="TestPlanGui" testclass="TestPlan" testname="Order Service Performance Test" enabled="true">
      <stringProp name="TestPlan.comments"></stringProp>
      <boolProp name="TestPlan.functional_mode">false</boolProp>
      <boolProp name="TestPlan.tearDown_on_shutdown">true</boolProp>
      <boolProp name="TestPlan.serialize_threadgroups">false</boolProp>
      <elementProp name="TestPlan.user_defined_variables" elementType="Arguments" guiclass="ArgumentsPanel" testclass="Arguments" testname="User Defined Variables" enabled="true">
        <collectionProp name="Arguments.arguments"/>
      </elementProp>
      <stringProp name="TestPlan.user_define_classpath"></stringProp>
    </TestPlan>
    <hashTree>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="Order Load Test" enabled="true">
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller" enabled="true">
          <boolProp name="LoopController.continue_forever">false</boolProp>
          <stringProp name="LoopController.loops">10</stringProp>
        </elementProp>
        <stringProp name="ThreadGroup.num_threads">50</stringProp>
        <stringProp name="ThreadGroup.ramp_time">10</stringProp>
        <boolProp name="ThreadGroup.scheduler">false</boolProp>
        <stringProp name="ThreadGroup.duration"></stringProp>
        <stringProp name="ThreadGroup.delay"></stringProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">true</boolProp>
      </ThreadGroup>
      <hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Order" enabled="true">
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <textProp name="HTTPSampler.domain">localhost</textProp>
          <textProp name="HTTPSampler.port">8080</textProp>
          <textProp name="HTTPSampler.protocol">http</textProp>
          <textProp name="HTTPSampler.contentEncoding"></textProp>
          <textProp name="HTTPSampler.path">/api/orders</textProp>
          <textProp name="HTTPSampler.method">POST</textProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <boolProp name="HTTPSampler.auto_redirects">false</boolProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.DO_MULTIPART_POST">false</boolProp>
          <stringProp name="HTTPSampler.embedded_url_re"></stringProp>
          <stringProp name="HTTPSampler.connect_timeout"></stringProp>
          <stringProp name="HTTPSampler.response_timeout"></stringProp>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name=