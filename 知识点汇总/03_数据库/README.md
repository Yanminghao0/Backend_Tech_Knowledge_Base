# 数据库核心机制详解

> 深入理解关系型数据库的核心原理、存储引擎、查询优化等内容

---

## 📋 文档列表

### 1. MySQL核心机制详解
📄 [MySQL核心机制详解.md](./MySQL核心机制详解.md)

**核心内容**：
- ✅ **事务机制**：ACID特性、MVCC多版本并发控制
- ✅ **存储结构**：Buffer Pool、Redo Log、Undo Log、Binlog
- ✅ **数据流转**：commit前后数据在内存和磁盘的位置
- ✅ **并发控制**：ReadView机制、隔离级别实现
- ✅ **完整流程图**：Mermaid可视化事务执行流程

**适合场景**：
- 理解MySQL事务原理
- 排查事务并发问题
- 优化数据库性能
- 面试准备（高频考点）

---

### 2. MySQL查询核心机制详解 ⭐ 推荐
📄 [MySQL查询核心机制详解.md](./MySQL查询核心机制详解.md)

**核心内容**：
- ✅ **查询执行流程**：连接器→解析器→优化器→执行器
- ✅ **优化器原理**：RBO规则优化 + CBO成本优化
- ✅ **索引选择**：索引失效场景、强制索引使用
- ✅ **IN()查询优化**：包含大量值（9万+）的9种解决方案

**核心解决方案**：
| 方案 | 性能 | 推荐度 | 适用场景 |
|------|------|--------|----------|
| 临时表+JOIN | 3.2秒 | ⭐⭐⭐⭐⭐ | 5万+数据，数据库层最优 |
| 内存表+JOIN | 1.8秒 | ⭐⭐⭐⭐⭐ | 高并发，性能要求高 |
| Redis缓存 | 0.02秒 | ⭐⭐⭐⭐⭐ | 终极方案，应用层最优 |
| 分批查询 | 45秒 | ⭐⭐⭐ | 1-5万数据，简单场景 |
| 范围查询 | 0.5秒 | ⭐⭐⭐⭐ | ID连续，最简单高效 |

**代码实现**：
- ✅ Spring Boot + MyBatis完整代码
- ✅ JdbcTemplate批量操作
- ✅ Redis缓存集成
- ✅ 智能选择策略

**适合场景**：
- 大数据量IN()查询优化
- 慢查询排查与优化
- 生产环境性能调优
- 技术方案选型

---

## 🎯 学习路径

```mermaid
graph LR
    A[MySQL基础] --> B[MySQL核心机制详解]
    B --> C[理解事务/MVCC/日志]
    C --> D[MySQL查询核心机制详解]
    D --> E[掌握查询优化]
    E --> F[生产实践]
    
    style B fill:#99ccff
    style D fill:#99ccff
    style F fill:#ccffcc
```

**推荐顺序**：
1. 先学习《MySQL核心机制详解》，理解底层原理
2. 再学习《MySQL查询核心机制详解》，掌握优化技巧
3. 结合实际项目应用

---

## 🔗 相关资源

- 📚 [MySQL官方文档](https://dev.mysql.com/doc/)
- 📚 [高性能MySQL（第4版）](https://www.oreilly.com/library/view/high-performance-mysql/9781492080503/)
- 📚 [MySQL技术内幕：InnoDB存储引擎](https://book.douban.com/subject/24708143/)

---

## 📌 快速索引

### 常见问题速查

**Q1: 事务commit前数据在哪里？**
- 答：Buffer Pool（内存脏页）+ Redo Log Buffer + Undo Log（磁盘）
- 详见：[MySQL核心机制详解.md](./MySQL核心机制详解.md#1-mysql数据库commit提交前数据在哪)

**Q2: MVCC是如何实现的？**
- 答：隐藏字段（DB_TRX_ID、DB_ROLL_PTR）+ 版本链 + ReadView
- 详见：[MySQL核心机制详解.md](./MySQL核心机制详解.md#2-mvcc多版本并发控制)

**Q3: IN()包含9万个值如何优化？**
- 答：首选临时表+JOIN，性能要求高用Redis缓存
- 详见：[MySQL查询核心机制详解.md](./MySQL查询核心机制详解.md#5-in包含大量值问题与解决方案)

**Q4: 索引为什么会失效？**
- 答：函数操作、类型转换、LIKE左模糊、OR未索引字段等
- 详见：[MySQL查询核心机制详解.md](./MySQL查询核心机制详解.md#32-索引失效场景)

**Q5: 查询优化器如何选择索引？**
- 答：基于成本模型（IO成本+CPU成本）选择最优执行计划
- 详见：[MySQL查询核心机制详解.md](./MySQL查询核心机制详解.md#23-基于成本的优化cbo)

---

## 🔄 持续更新

- [ ] PostgreSQL核心机制详解
- [ ] MySQL索引深度优化
- [ ] MySQL分库分表实战
- [ ] MySQL主从复制与高可用

---

*最后更新：2025-10-27*

