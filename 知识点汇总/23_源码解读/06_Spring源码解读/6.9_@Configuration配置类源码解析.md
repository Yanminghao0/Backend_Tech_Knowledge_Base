# @Configurationé…ç½®ç±»æºç è§£æ

> ğŸ’¡ æ·±å…¥ç†è§£Springé…ç½®ç±»çš„å¤„ç†æœºåˆ¶ï¼ŒæŒæ¡CGLIBä»£ç†å¢å¼ºåŸç†

---

## ğŸ“š ç›®å½•

1. [@Configurationæ¦‚è¿°](#1-configurationæ¦‚è¿°)
2. [é…ç½®ç±»è§£ææµç¨‹](#2-é…ç½®ç±»è§£ææµç¨‹)
3. [ConfigurationClassPostProcessor](#3-configurationclasspostprocessor)
4. [CGLIBä»£ç†å¢å¼º](#4-cglibä»£ç†å¢å¼º)
5. [@Beanæ–¹æ³•è°ƒç”¨åŸç†](#5-beanæ–¹æ³•è°ƒç”¨åŸç†)
6. [Fullæ¨¡å¼vs Liteæ¨¡å¼](#6-fullæ¨¡å¼vs-liteæ¨¡å¼)
7. [é¢è¯•è¦ç‚¹](#7-é¢è¯•è¦ç‚¹)

---

## 1. @Configurationæ¦‚è¿°

### 1.1 é…ç½®ç±»çš„ä½œç”¨

```java
@Configuration
public class AppConfig {
    
    @Bean
    public DataSource dataSource() {
        return new HikariDataSource();
    }
    
    @Bean
    public JdbcTemplate jdbcTemplate() {
        // è°ƒç”¨dataSource()æ–¹æ³•ï¼Œä¼šè¿”å›åŒä¸€ä¸ªBeanå®ä¾‹
        return new JdbcTemplate(dataSource());
    }
}
```

### 1.2 æ ¸å¿ƒé—®é¢˜

```
é—®é¢˜ï¼šjdbcTemplate()ä¸­è°ƒç”¨dataSource()ï¼Œä¸ºä»€ä¹ˆä¸ä¼šåˆ›å»ºæ–°çš„DataSourceå®ä¾‹ï¼Ÿ

ç­”æ¡ˆï¼š@Configurationç±»ä¼šè¢«CGLIBä»£ç†å¢å¼ºï¼Œ@Beanæ–¹æ³•è°ƒç”¨ä¼šè¢«æ‹¦æˆªï¼Œ
     ä»å®¹å™¨ä¸­è·å–å·²å­˜åœ¨çš„Beanï¼Œè€Œä¸æ˜¯é‡æ–°åˆ›å»ºã€‚
```

### 1.3 æ ¸å¿ƒç±»å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  é…ç½®ç±»å¤„ç†æ ¸å¿ƒç±»                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ConfigurationClassPostProcessor                           â”‚
â”‚  â”œâ”€â”€ å®ç°BeanDefinitionRegistryPostProcessor               â”‚
â”‚  â”œâ”€â”€ è§£æ@Configurationç±»                                  â”‚
â”‚  â””â”€â”€ æ³¨å†Œ@Beanæ–¹æ³•å¯¹åº”çš„BeanDefinition                     â”‚
â”‚                                                             â”‚
â”‚  ConfigurationClassParser                                  â”‚
â”‚  â”œâ”€â”€ è§£æé…ç½®ç±»                                            â”‚
â”‚  â”œâ”€â”€ å¤„ç†@Importã€@ComponentScanç­‰                         â”‚
â”‚  â””â”€â”€ æ”¶é›†@Beanæ–¹æ³•                                         â”‚
â”‚                                                             â”‚
â”‚  ConfigurationClassEnhancer                                â”‚
â”‚  â”œâ”€â”€ CGLIBå¢å¼ºé…ç½®ç±»                                       â”‚
â”‚  â””â”€â”€ æ‹¦æˆª@Beanæ–¹æ³•è°ƒç”¨                                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. é…ç½®ç±»è§£ææµç¨‹

### 2.1 æ•´ä½“æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  é…ç½®ç±»å¤„ç†æµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. å®¹å™¨å¯åŠ¨                                                â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  2. è°ƒç”¨BeanFactoryPostProcessor                           â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  3. ConfigurationClassPostProcessor.postProcessBeanDefinitionRegistry()
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  4. è§£æ@Configurationç±»                                   â”‚
â”‚     â”œâ”€â”€ å¤„ç†@ComponentScan                                 â”‚
â”‚     â”œâ”€â”€ å¤„ç†@Import                                        â”‚
â”‚     â”œâ”€â”€ å¤„ç†@ImportResource                                â”‚
â”‚     â””â”€â”€ æ”¶é›†@Beanæ–¹æ³•                                      â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  5. æ³¨å†ŒBeanDefinition                                     â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  6. ConfigurationClassPostProcessor.postProcessBeanFactory()
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  7. CGLIBå¢å¼ºé…ç½®ç±»                                        â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  8. æ›¿æ¢BeanDefinitionä¸­çš„beanClass                        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


---

## 3. ConfigurationClassPostProcessor

### 3.1 ç±»å®šä¹‰

```java
/**
 * é…ç½®ç±»åç½®å¤„ç†å™¨
 * è´Ÿè´£è§£æ@Configurationç±»å¹¶æ³¨å†Œ@Beanæ–¹æ³•å¯¹åº”çš„BeanDefinition
 */
public class ConfigurationClassPostProcessor implements 
        BeanDefinitionRegistryPostProcessor,  // å¯ä»¥æ³¨å†Œæ–°çš„BeanDefinition
        PriorityOrdered,                       // æœ€é«˜ä¼˜å…ˆçº§æ‰§è¡Œ
        ResourceLoaderAware,
        BeanClassLoaderAware,
        EnvironmentAware {
    
    // é…ç½®ç±»è§£æå™¨
    private ConfigurationClassParser parser;
    
    // é…ç½®ç±»å¢å¼ºå™¨
    private ConfigurationClassEnhancer enhancer;
}
```

### 3.2 postProcessBeanDefinitionRegistryæ–¹æ³•

```java
/**
 * è§£æé…ç½®ç±»ï¼Œæ³¨å†Œ@Beanæ–¹æ³•å¯¹åº”çš„BeanDefinition
 */
@Override
public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) {
    // ç”Ÿæˆå”¯ä¸€æ ‡è¯†ï¼Œé˜²æ­¢é‡å¤å¤„ç†
    int registryId = System.identityHashCode(registry);
    if (this.registriesPostProcessed.contains(registryId)) {
        throw new IllegalStateException("...");
    }
    this.registriesPostProcessed.add(registryId);
    
    // ğŸ”¥ æ ¸å¿ƒï¼šå¤„ç†é…ç½®ç±»
    processConfigBeanDefinitions(registry);
}

/**
 * å¤„ç†é…ç½®ç±»çš„æ ¸å¿ƒæ–¹æ³•
 */
public void processConfigBeanDefinitions(BeanDefinitionRegistry registry) {
    List<BeanDefinitionHolder> configCandidates = new ArrayList<>();
    String[] candidateNames = registry.getBeanDefinitionNames();
    
    // 1. éå†æ‰€æœ‰BeanDefinitionï¼Œæ‰¾å‡ºé…ç½®ç±»å€™é€‰
    for (String beanName : candidateNames) {
        BeanDefinition beanDef = registry.getBeanDefinition(beanName);
        
        // æ£€æŸ¥æ˜¯å¦å·²ç»å¤„ç†è¿‡
        if (beanDef.getAttribute(ConfigurationClassUtils.CONFIGURATION_CLASS_ATTRIBUTE) != null) {
            // å·²å¤„ç†ï¼Œè·³è¿‡
        }
        // ğŸ”¥ æ£€æŸ¥æ˜¯å¦æ˜¯é…ç½®ç±»
        else if (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory)) {
            configCandidates.add(new BeanDefinitionHolder(beanDef, beanName));
        }
    }
    
    // æ²¡æœ‰é…ç½®ç±»ï¼Œç›´æ¥è¿”å›
    if (configCandidates.isEmpty()) {
        return;
    }
    
    // 2. æŒ‰@Orderæ’åº
    configCandidates.sort((bd1, bd2) -> {
        int i1 = ConfigurationClassUtils.getOrder(bd1.getBeanDefinition());
        int i2 = ConfigurationClassUtils.getOrder(bd2.getBeanDefinition());
        return Integer.compare(i1, i2);
    });
    
    // 3. åˆ›å»ºé…ç½®ç±»è§£æå™¨
    ConfigurationClassParser parser = new ConfigurationClassParser(
        this.metadataReaderFactory, 
        this.problemReporter, 
        this.environment,
        this.resourceLoader, 
        this.componentScanBeanNameGenerator, 
        registry
    );
    
    Set<BeanDefinitionHolder> candidates = new LinkedHashSet<>(configCandidates);
    Set<ConfigurationClass> alreadyParsed = new HashSet<>(configCandidates.size());
    
    // 4. å¾ªç¯è§£æï¼ˆå› ä¸ºè§£æè¿‡ç¨‹ä¸­å¯èƒ½å‘ç°æ–°çš„é…ç½®ç±»ï¼‰
    do {
        // ğŸ”¥ è§£æé…ç½®ç±»
        parser.parse(candidates);
        parser.validate();
        
        // è·å–è§£æç»“æœ
        Set<ConfigurationClass> configClasses = new LinkedHashSet<>(parser.getConfigurationClasses());
        configClasses.removeAll(alreadyParsed);
        
        // 5. åˆ›å»ºBeanDefinitionè¯»å–å™¨
        if (this.reader == null) {
            this.reader = new ConfigurationClassBeanDefinitionReader(
                registry, this.sourceExtractor, this.resourceLoader, 
                this.environment, this.importBeanNameGenerator, parser.getImportRegistry()
            );
        }
        
        // ğŸ”¥ åŠ è½½BeanDefinitionï¼ˆæ³¨å†Œ@Beanæ–¹æ³•ï¼‰
        this.reader.loadBeanDefinitions(configClasses);
        alreadyParsed.addAll(configClasses);
        
        // 6. æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„é…ç½®ç±»
        candidates.clear();
        if (registry.getBeanDefinitionCount() > candidateNames.length) {
            // æœ‰æ–°æ³¨å†Œçš„BeanDefinitionï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯é…ç½®ç±»
            // ...
        }
    } while (!candidates.isEmpty());
}
```

### 3.3 é…ç½®ç±»åˆ¤æ–­é€»è¾‘

```java
/**
 * æ£€æŸ¥æ˜¯å¦æ˜¯é…ç½®ç±»å€™é€‰
 */
public static boolean checkConfigurationClassCandidate(
        BeanDefinition beanDef, MetadataReaderFactory metadataReaderFactory) {
    
    String className = beanDef.getBeanClassName();
    if (className == null || beanDef.getFactoryMethodName() != null) {
        return false;
    }
    
    AnnotationMetadata metadata;
    // è·å–æ³¨è§£å…ƒæ•°æ®...
    
    Map<String, Object> config = metadata.getAnnotationAttributes(Configuration.class.getName());
    
    // ğŸ”¥ Fullæ¨¡å¼ï¼šæœ‰@Configurationæ³¨è§£ä¸”proxyBeanMethods=true
    if (config != null && !Boolean.FALSE.equals(config.get("proxyBeanMethods"))) {
        beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_FULL);
    }
    // ğŸ”¥ Liteæ¨¡å¼ï¼šæœ‰@Componentã€@ComponentScanã€@Importã€@ImportResourceæˆ–@Beanæ–¹æ³•
    else if (config != null || isConfigurationCandidate(metadata)) {
        beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_LITE);
    }
    else {
        return false;
    }
    
    // è·å–@Orderå€¼
    Integer order = getOrder(metadata);
    if (order != null) {
        beanDef.setAttribute(ORDER_ATTRIBUTE, order);
    }
    
    return true;
}
```

### 3.4 postProcessBeanFactoryæ–¹æ³•

```java
/**
 * å¢å¼ºé…ç½®ç±»
 */
@Override
public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) {
    int factoryId = System.identityHashCode(beanFactory);
    if (this.factoriesPostProcessed.contains(factoryId)) {
        throw new IllegalStateException("...");
    }
    this.factoriesPostProcessed.add(factoryId);
    
    // å¦‚æœè¿˜æ²¡è§£æè¿‡ï¼Œå…ˆè§£æ
    if (!this.registriesPostProcessed.contains(factoryId)) {
        processConfigBeanDefinitions((BeanDefinitionRegistry) beanFactory);
    }
    
    // ğŸ”¥ å¢å¼ºFullæ¨¡å¼çš„é…ç½®ç±»
    enhanceConfigurationClasses(beanFactory);
}

/**
 * ä½¿ç”¨CGLIBå¢å¼ºé…ç½®ç±»
 */
public void enhanceConfigurationClasses(ConfigurableListableBeanFactory beanFactory) {
    Map<String, AbstractBeanDefinition> configBeanDefs = new LinkedHashMap<>();
    
    for (String beanName : beanFactory.getBeanDefinitionNames()) {
        BeanDefinition beanDef = beanFactory.getBeanDefinition(beanName);
        Object configClassAttr = beanDef.getAttribute(
            ConfigurationClassUtils.CONFIGURATION_CLASS_ATTRIBUTE);
        
        // ğŸ”¥ åªå¢å¼ºFullæ¨¡å¼çš„é…ç½®ç±»
        if (ConfigurationClassUtils.CONFIGURATION_CLASS_FULL.equals(configClassAttr)) {
            if (!(beanDef instanceof AbstractBeanDefinition)) {
                throw new BeanDefinitionStoreException("...");
            }
            configBeanDefs.put(beanName, (AbstractBeanDefinition) beanDef);
        }
    }
    
    if (configBeanDefs.isEmpty()) {
        return;
    }
    
    // åˆ›å»ºå¢å¼ºå™¨
    ConfigurationClassEnhancer enhancer = new ConfigurationClassEnhancer();
    
    for (Map.Entry<String, AbstractBeanDefinition> entry : configBeanDefs.entrySet()) {
        AbstractBeanDefinition beanDef = entry.getValue();
        
        // è®¾ç½®æ ‡è®°ï¼Œè¡¨ç¤ºå·²å¢å¼º
        beanDef.setAttribute(AutoProxyUtils.PRESERVE_TARGET_CLASS_ATTRIBUTE, Boolean.TRUE);
        
        Class<?> configClass = beanDef.getBeanClass();
        
        // ğŸ”¥ CGLIBå¢å¼º
        Class<?> enhancedClass = enhancer.enhance(configClass, this.beanClassLoader);
        
        if (configClass != enhancedClass) {
            // æ›¿æ¢BeanDefinitionä¸­çš„beanClass
            beanDef.setBeanClass(enhancedClass);
        }
    }
}
```

---

## 4. CGLIBä»£ç†å¢å¼º

### 4.1 ConfigurationClassEnhancer

```java
/**
 * é…ç½®ç±»å¢å¼ºå™¨
 * ä½¿ç”¨CGLIBä¸º@Configurationç±»åˆ›å»ºä»£ç†
 */
class ConfigurationClassEnhancer {
    
    // å›è°ƒè¿‡æ»¤å™¨
    private static final Callback[] CALLBACKS = new Callback[] {
        new BeanMethodInterceptor(),           // @Beanæ–¹æ³•æ‹¦æˆªå™¨
        new BeanFactoryAwareMethodInterceptor(), // BeanFactoryAwareæ–¹æ³•æ‹¦æˆªå™¨
        NoOp.INSTANCE                          // ä¸æ‹¦æˆª
    };
    
    private static final ConditionalCallbackFilter CALLBACK_FILTER = 
        new ConditionalCallbackFilter(CALLBACKS);
    
    /**
     * å¢å¼ºé…ç½®ç±»
     */
    public Class<?> enhance(Class<?> configClass, @Nullable ClassLoader classLoader) {
        // æ£€æŸ¥æ˜¯å¦å·²ç»å¢å¼ºè¿‡
        if (EnhancedConfiguration.class.isAssignableFrom(configClass)) {
            return configClass;
        }
        
        // ğŸ”¥ åˆ›å»ºCGLIBå¢å¼ºç±»
        Class<?> enhancedClass = createClass(newEnhancer(configClass, classLoader));
        return enhancedClass;
    }
    
    /**
     * åˆ›å»ºCGLIB Enhancer
     */
    private Enhancer newEnhancer(Class<?> configSuperClass, @Nullable ClassLoader classLoader) {
        Enhancer enhancer = new Enhancer();
        
        // è®¾ç½®çˆ¶ç±»ï¼ˆåŸé…ç½®ç±»ï¼‰
        enhancer.setSuperclass(configSuperClass);
        
        // ğŸ”¥ å®ç°EnhancedConfigurationæ¥å£ï¼Œç”¨äºæ³¨å…¥BeanFactory
        enhancer.setInterfaces(new Class<?>[] {EnhancedConfiguration.class});
        
        enhancer.setUseFactory(false);
        enhancer.setNamingPolicy(SpringNamingPolicy.INSTANCE);
        enhancer.setStrategy(new BeanFactoryAwareGeneratorStrategy(classLoader));
        
        // è®¾ç½®å›è°ƒè¿‡æ»¤å™¨
        enhancer.setCallbackFilter(CALLBACK_FILTER);
        enhancer.setCallbackTypes(CALLBACK_FILTER.getCallbackTypes());
        
        return enhancer;
    }
}

/**
 * å¢å¼ºé…ç½®ç±»å®ç°çš„æ¥å£
 * ç”¨äºæ³¨å…¥BeanFactory
 */
public interface EnhancedConfiguration extends BeanFactoryAware {
}
```

### 4.2 BeanMethodInterceptor

```java
/**
 * @Beanæ–¹æ³•æ‹¦æˆªå™¨
 * æ ¸å¿ƒï¼šæ‹¦æˆª@Beanæ–¹æ³•è°ƒç”¨ï¼Œä»å®¹å™¨è·å–Beanè€Œä¸æ˜¯é‡æ–°åˆ›å»º
 */
private static class BeanMethodInterceptor implements MethodInterceptor, ConditionalCallback {
    
    @Override
    public Object intercept(Object enhancedConfigInstance, Method beanMethod, 
            Object[] beanMethodArgs, MethodProxy cglibMethodProxy) throws Throwable {
        
        // 1. è·å–BeanFactory
        ConfigurableBeanFactory beanFactory = getBeanFactory(enhancedConfigInstance);
        
        // 2. è·å–Beanåç§°
        String beanName = BeanAnnotationHelper.determineBeanNameFor(beanMethod);
        
        // 3. æ£€æŸ¥æ˜¯å¦æ˜¯ä½œç”¨åŸŸä»£ç†
        if (BeanAnnotationHelper.isScopedProxy(beanMethod)) {
            String scopedBeanName = ScopedProxyCreator.getTargetBeanName(beanName);
            if (beanFactory.isCurrentlyInCreation(scopedBeanName)) {
                beanName = scopedBeanName;
            }
        }
        
        // 4. ğŸ”¥ æ£€æŸ¥æ˜¯å¦æ­£åœ¨åˆ›å»ºä¸­ï¼ˆå¤„ç†å¾ªç¯ä¾èµ–ï¼‰
        if (factoryContainsBean(beanFactory, BeanFactory.FACTORY_BEAN_PREFIX + beanName) &&
                factoryContainsBean(beanFactory, beanName)) {
            Object factoryBean = beanFactory.getBean(BeanFactory.FACTORY_BEAN_PREFIX + beanName);
            if (factoryBean instanceof ScopedProxyFactoryBean) {
                // ä½œç”¨åŸŸä»£ç†ï¼Œä¸æ‹¦æˆª
            }
            else {
                // è¿”å›FactoryBeanåˆ›å»ºçš„å¯¹è±¡
                return enhanceFactoryBean(factoryBean, beanMethod.getReturnType(), 
                    beanFactory, beanName);
            }
        }
        
        // 5. ğŸ”¥ åˆ¤æ–­æ˜¯å¦æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„@Beanæ–¹æ³•
        if (isCurrentlyInvokedFactoryMethod(beanMethod)) {
            // æ˜¯å½“å‰æ–¹æ³•ï¼Œç›´æ¥è°ƒç”¨åŸæ–¹æ³•åˆ›å»ºBean
            return cglibMethodProxy.invokeSuper(enhancedConfigInstance, beanMethodArgs);
        }
        
        // 6. ğŸ”¥ ä¸æ˜¯å½“å‰æ–¹æ³•ï¼Œä»å®¹å™¨è·å–Bean
        return resolveBeanReference(beanMethod, beanMethodArgs, beanFactory, beanName);
    }
    
    /**
     * ä»å®¹å™¨è§£æBeanå¼•ç”¨
     */
    private Object resolveBeanReference(Method beanMethod, Object[] beanMethodArgs,
            ConfigurableBeanFactory beanFactory, String beanName) {
        
        // æ£€æŸ¥Beanæ˜¯å¦æ­£åœ¨åˆ›å»ºä¸­
        boolean alreadyInCreation = beanFactory.isCurrentlyInCreation(beanName);
        
        try {
            if (alreadyInCreation) {
                // ä¸´æ—¶è®¾ç½®ä¸ºéåˆ›å»ºä¸­ï¼Œé¿å…å¾ªç¯ä¾èµ–æ£€æµ‹
                beanFactory.setCurrentlyInCreation(beanName, false);
            }
            
            // å¤„ç†æ–¹æ³•å‚æ•°
            boolean useArgs = !ObjectUtils.isEmpty(beanMethodArgs);
            if (useArgs && beanFactory.isSingleton(beanName)) {
                // å•ä¾‹Beanä¸ä½¿ç”¨å‚æ•°
                for (Object arg : beanMethodArgs) {
                    if (arg == null) {
                        useArgs = false;
                        break;
                    }
                }
            }
            
            // ğŸ”¥ ä»å®¹å™¨è·å–Bean
            Object beanInstance = useArgs ? 
                beanFactory.getBean(beanName, beanMethodArgs) : 
                beanFactory.getBean(beanName);
            
            // ç±»å‹æ£€æŸ¥
            if (!ClassUtils.isAssignableValue(beanMethod.getReturnType(), beanInstance)) {
                if (beanInstance.equals(null)) {
                    beanInstance = null;
                }
                else {
                    throw new IllegalStateException("...");
                }
            }
            
            // è®°å½•å½“å‰æ–¹æ³•
            Method currentlyInvoked = SimpleInstantiationStrategy.getCurrentlyInvokedFactoryMethod();
            if (currentlyInvoked != null) {
                String outerBeanName = BeanAnnotationHelper.determineBeanNameFor(currentlyInvoked);
                beanFactory.registerDependentBean(beanName, outerBeanName);
            }
            
            return beanInstance;
        }
        finally {
            if (alreadyInCreation) {
                beanFactory.setCurrentlyInCreation(beanName, true);
            }
        }
    }
    
    /**
     * åˆ¤æ–­æ˜¯å¦åº”è¯¥æ‹¦æˆªè¯¥æ–¹æ³•
     */
    @Override
    public boolean isMatch(Method candidateMethod) {
        // åªæ‹¦æˆª@Beanæ–¹æ³•
        return candidateMethod.isAnnotationPresent(Bean.class);
    }
}
```


---

## 5. @Beanæ–¹æ³•è°ƒç”¨åŸç†

### 5.1 è°ƒç”¨æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              @Beanæ–¹æ³•è°ƒç”¨æµç¨‹                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  @Configuration                                            â”‚
â”‚  public class AppConfig {                                  â”‚
â”‚      @Bean                                                 â”‚
â”‚      public A a() { return new A(); }                     â”‚
â”‚                                                             â”‚
â”‚      @Bean                                                 â”‚
â”‚      public B b() { return new B(a()); } // è°ƒç”¨a()       â”‚
â”‚  }                                                         â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                             â”‚
â”‚  åˆ›å»ºBæ—¶è°ƒç”¨b()æ–¹æ³•ï¼š                                       â”‚
â”‚  1. b()æ–¹æ³•æ‰§è¡Œ                                            â”‚
â”‚  2. å†…éƒ¨è°ƒç”¨a()                                            â”‚
â”‚  3. ğŸ”¥ è¢«CGLIBæ‹¦æˆª                                         â”‚
â”‚  4. BeanMethodInterceptor.intercept()                     â”‚
â”‚  5. åˆ¤æ–­ï¼ša()ä¸æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•                         â”‚
â”‚  6. ä»å®¹å™¨è·å–åä¸º"a"çš„Bean                                â”‚
â”‚  7. è¿”å›å·²å­˜åœ¨çš„Aå®ä¾‹                                      â”‚
â”‚  8. Bä½¿ç”¨åŒä¸€ä¸ªAå®ä¾‹                                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å…³é”®åˆ¤æ–­ï¼šisCurrentlyInvokedFactoryMethod

```java
/**
 * åˆ¤æ–­æ˜¯å¦æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„å·¥å‚æ–¹æ³•
 * 
 * åœºæ™¯1ï¼šå®¹å™¨è°ƒç”¨a()åˆ›å»ºBean A
 *   - æ­¤æ—¶a()æ˜¯å½“å‰æ–¹æ³•ï¼Œåº”è¯¥æ‰§è¡ŒåŸæ–¹æ³•åˆ›å»ºBean
 *   
 * åœºæ™¯2ï¼šb()å†…éƒ¨è°ƒç”¨a()
 *   - æ­¤æ—¶b()æ˜¯å½“å‰æ–¹æ³•ï¼Œa()ä¸æ˜¯
 *   - a()åº”è¯¥ä»å®¹å™¨è·å–ï¼Œè€Œä¸æ˜¯é‡æ–°åˆ›å»º
 */
private boolean isCurrentlyInvokedFactoryMethod(Method method) {
    // è·å–å½“å‰æ­£åœ¨æ‰§è¡Œçš„å·¥å‚æ–¹æ³•
    Method currentlyInvoked = SimpleInstantiationStrategy.getCurrentlyInvokedFactoryMethod();
    
    // æ¯”è¾ƒæ–¹æ³•åå’Œå‚æ•°ç±»å‹
    return currentlyInvoked != null && 
           method.getName().equals(currentlyInvoked.getName()) &&
           Arrays.equals(method.getParameterTypes(), currentlyInvoked.getParameterTypes());
}
```

### 5.3 ç¤ºä¾‹åˆ†æ

```java
@Configuration
public class AppConfig {
    
    @Bean
    public DataSource dataSource() {
        System.out.println("Creating DataSource");
        return new HikariDataSource();
    }
    
    @Bean
    public JdbcTemplate jdbcTemplate() {
        System.out.println("Creating JdbcTemplate");
        // è¿™é‡Œè°ƒç”¨dataSource()
        return new JdbcTemplate(dataSource());
    }
    
    @Bean
    public TransactionManager transactionManager() {
        System.out.println("Creating TransactionManager");
        // è¿™é‡Œä¹Ÿè°ƒç”¨dataSource()
        return new DataSourceTransactionManager(dataSource());
    }
}

// è¾“å‡ºç»“æœï¼š
// Creating DataSource        <- åªåˆ›å»ºä¸€æ¬¡
// Creating JdbcTemplate
// Creating TransactionManager

// å¦‚æœæ²¡æœ‰CGLIBå¢å¼ºï¼ˆLiteæ¨¡å¼ï¼‰ï¼š
// Creating DataSource        <- ç¬¬ä¸€æ¬¡
// Creating JdbcTemplate
// Creating DataSource        <- ç¬¬äºŒæ¬¡ï¼
// Creating TransactionManager
// Creating DataSource        <- ç¬¬ä¸‰æ¬¡ï¼
```

---

## 6. Fullæ¨¡å¼vs Liteæ¨¡å¼

### 6.1 æ¨¡å¼å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ç‰¹æ€§         â”‚     Fullæ¨¡å¼         â”‚     Liteæ¨¡å¼         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è§¦å‘æ¡ä»¶           â”‚ @Configuration      â”‚ @Componentç­‰        â”‚
â”‚                    â”‚ proxyBeanMethods=trueâ”‚ æˆ–proxyBeanMethods=falseâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CGLIBä»£ç†          â”‚ âœ… æ˜¯               â”‚ âŒ å¦               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ @Beanæ–¹æ³•è°ƒç”¨      â”‚ ä»å®¹å™¨è·å–          â”‚ ç›´æ¥è°ƒç”¨ï¼ˆæ–°å®ä¾‹ï¼‰   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¯åŠ¨æ€§èƒ½           â”‚ è¾ƒæ…¢ï¼ˆéœ€è¦ä»£ç†ï¼‰    â”‚ è¾ƒå¿«                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å•ä¾‹ä¿è¯           â”‚ âœ… ä¿è¯             â”‚ âŒ ä¸ä¿è¯           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é€‚ç”¨åœºæ™¯           â”‚ éœ€è¦Beané—´ä¾èµ–      â”‚ ç‹¬ç«‹Beanå®šä¹‰        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Fullæ¨¡å¼ç¤ºä¾‹

```java
// Fullæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
@Configuration
public class FullModeConfig {
    
    @Bean
    public A a() {
        return new A();
    }
    
    @Bean
    public B b() {
        // è°ƒç”¨a()è¿”å›å®¹å™¨ä¸­çš„åŒä¸€ä¸ªå®ä¾‹
        return new B(a());
    }
}

// ç­‰ä»·äº
@Configuration(proxyBeanMethods = true)
public class FullModeConfig {
    // ...
}
```

### 6.3 Liteæ¨¡å¼ç¤ºä¾‹

```java
// Liteæ¨¡å¼æ–¹å¼1ï¼šproxyBeanMethods = false
@Configuration(proxyBeanMethods = false)
public class LiteModeConfig1 {
    
    @Bean
    public A a() {
        return new A();
    }
    
    @Bean
    public B b() {
        // âš ï¸ è°ƒç”¨a()ä¼šåˆ›å»ºæ–°å®ä¾‹ï¼
        return new B(a());
    }
}

// Liteæ¨¡å¼æ–¹å¼2ï¼šä½¿ç”¨@Component
@Component
public class LiteModeConfig2 {
    
    @Bean
    public A a() {
        return new A();
    }
    
    @Bean
    public B b(A a) {  // é€šè¿‡å‚æ•°æ³¨å…¥ï¼Œè€Œä¸æ˜¯è°ƒç”¨æ–¹æ³•
        return new B(a);
    }
}
```

### 6.4 Liteæ¨¡å¼çš„æ­£ç¡®ç”¨æ³•

```java
@Configuration(proxyBeanMethods = false)
public class LiteModeConfig {
    
    @Bean
    public DataSource dataSource() {
        return new HikariDataSource();
    }
    
    // âœ… æ­£ç¡®ï¼šé€šè¿‡å‚æ•°æ³¨å…¥ä¾èµ–
    @Bean
    public JdbcTemplate jdbcTemplate(DataSource dataSource) {
        return new JdbcTemplate(dataSource);
    }
    
    // âœ… æ­£ç¡®ï¼šé€šè¿‡å‚æ•°æ³¨å…¥ä¾èµ–
    @Bean
    public TransactionManager transactionManager(DataSource dataSource) {
        return new DataSourceTransactionManager(dataSource);
    }
}
```

### 6.5 SpringBootä¸­çš„åº”ç”¨

```java
// SpringBoot 2.2+ å¾ˆå¤šè‡ªåŠ¨é…ç½®ç±»ä½¿ç”¨Liteæ¨¡å¼
// æå‡å¯åŠ¨æ€§èƒ½

@Configuration(proxyBeanMethods = false)
@ConditionalOnClass(DataSource.class)
public class DataSourceAutoConfiguration {
    
    @Bean
    @ConditionalOnMissingBean
    public DataSourceInitializer dataSourceInitializer(
            DataSource dataSource,  // å‚æ•°æ³¨å…¥
            ResourceLoader resourceLoader) {
        return new DataSourceInitializer(dataSource, resourceLoader);
    }
}
```

---

## 7. é¢è¯•è¦ç‚¹

### 7.1 é«˜é¢‘é¢è¯•é¢˜

#### Q1: @Configurationå’Œ@Componentçš„åŒºåˆ«ï¼Ÿ

```
ç­”æ¡ˆè¦ç‚¹ï¼š
1. @Configurationæ˜¯@Componentçš„æ´¾ç”Ÿæ³¨è§£
2. @Configurationé»˜è®¤ä½¿ç”¨Fullæ¨¡å¼ï¼Œä¼šè¢«CGLIBä»£ç†
3. @Componentä½¿ç”¨Liteæ¨¡å¼ï¼Œä¸ä¼šè¢«ä»£ç†
4. Fullæ¨¡å¼ä¸‹ï¼Œ@Beanæ–¹æ³•è°ƒç”¨ä¼šä»å®¹å™¨è·å–Bean
5. Liteæ¨¡å¼ä¸‹ï¼Œ@Beanæ–¹æ³•è°ƒç”¨ä¼šåˆ›å»ºæ–°å®ä¾‹

å…³é”®åŒºåˆ«ï¼š
- @Configurationä¿è¯@Beanæ–¹æ³•è¿”å›çš„æ˜¯åŒä¸€ä¸ªå•ä¾‹
- @Componentä¸ä¿è¯ï¼Œéœ€è¦é€šè¿‡å‚æ•°æ³¨å…¥ä¾èµ–
```

#### Q2: @Configurationçš„proxyBeanMethodså±æ€§ä½œç”¨ï¼Ÿ

```java
// proxyBeanMethods = trueï¼ˆé»˜è®¤ï¼‰ï¼šFullæ¨¡å¼
// - é…ç½®ç±»ä¼šè¢«CGLIBä»£ç†
// - @Beanæ–¹æ³•è°ƒç”¨ä¼šè¢«æ‹¦æˆªï¼Œä»å®¹å™¨è·å–Bean
// - ä¿è¯å•ä¾‹è¯­ä¹‰

// proxyBeanMethods = falseï¼šLiteæ¨¡å¼
// - é…ç½®ç±»ä¸ä¼šè¢«ä»£ç†
// - @Beanæ–¹æ³•è°ƒç”¨ç›´æ¥æ‰§è¡Œï¼Œåˆ›å»ºæ–°å®ä¾‹
// - å¯åŠ¨æ›´å¿«ï¼Œä½†éœ€è¦é€šè¿‡å‚æ•°æ³¨å…¥ä¾èµ–
```

#### Q3: ä¸ºä»€ä¹ˆ@Beanæ–¹æ³•è°ƒç”¨ä¸ä¼šåˆ›å»ºå¤šä¸ªå®ä¾‹ï¼Ÿ

```
ç­”æ¡ˆè¦ç‚¹ï¼š
1. @Configurationç±»è¢«CGLIBä»£ç†å¢å¼º
2. @Beanæ–¹æ³•è°ƒç”¨è¢«BeanMethodInterceptoræ‹¦æˆª
3. æ‹¦æˆªå™¨åˆ¤æ–­æ˜¯å¦æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„å·¥å‚æ–¹æ³•
4. å¦‚æœä¸æ˜¯ï¼Œä»å®¹å™¨è·å–å·²å­˜åœ¨çš„Bean
5. å¦‚æœæ˜¯ï¼Œæ‰§è¡ŒåŸæ–¹æ³•åˆ›å»ºBean

æ ¸å¿ƒæœºåˆ¶ï¼š
- CGLIBåŠ¨æ€ä»£ç†
- æ–¹æ³•æ‹¦æˆª
- å®¹å™¨BeanæŸ¥æ‰¾
```

#### Q4: ConfigurationClassPostProcessorçš„ä½œç”¨ï¼Ÿ

```
ç­”æ¡ˆè¦ç‚¹ï¼š
1. å®ç°BeanDefinitionRegistryPostProcessoræ¥å£
2. è§£æ@Configurationç±»
3. å¤„ç†@ComponentScanã€@Importç­‰æ³¨è§£
4. æ³¨å†Œ@Beanæ–¹æ³•å¯¹åº”çš„BeanDefinition
5. ä½¿ç”¨CGLIBå¢å¼ºFullæ¨¡å¼çš„é…ç½®ç±»

æ‰§è¡Œæ—¶æœºï¼š
- åœ¨BeanFactoryåç½®å¤„ç†é˜¶æ®µæ‰§è¡Œ
- ä¼˜å…ˆçº§æœ€é«˜ï¼ˆPriorityOrderedï¼‰
```

### 7.2 çŸ¥è¯†ç‚¹æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              @Configurationæºç æ€»ç»“                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  æ ¸å¿ƒç»„ä»¶ï¼š                                                  â”‚
â”‚  â”œâ”€â”€ ConfigurationClassPostProcessor: é…ç½®ç±»åç½®å¤„ç†å™¨      â”‚
â”‚  â”œâ”€â”€ ConfigurationClassParser: é…ç½®ç±»è§£æå™¨                 â”‚
â”‚  â”œâ”€â”€ ConfigurationClassEnhancer: CGLIBå¢å¼ºå™¨               â”‚
â”‚  â””â”€â”€ BeanMethodInterceptor: @Beanæ–¹æ³•æ‹¦æˆªå™¨                â”‚
â”‚                                                             â”‚
â”‚  å¤„ç†æµç¨‹ï¼š                                                  â”‚
â”‚  1. æ‰«ææ‰¾å‡ºé…ç½®ç±»å€™é€‰                                      â”‚
â”‚  2. è§£æé…ç½®ç±»ï¼ˆ@Importã€@ComponentScanã€@Beanç­‰ï¼‰          â”‚
â”‚  3. æ³¨å†Œ@Beanæ–¹æ³•å¯¹åº”çš„BeanDefinition                       â”‚
â”‚  4. CGLIBå¢å¼ºFullæ¨¡å¼é…ç½®ç±»                                 â”‚
â”‚  5. æ›¿æ¢BeanDefinitionä¸­çš„beanClass                        â”‚
â”‚                                                             â”‚
â”‚  Full vs Liteï¼š                                             â”‚
â”‚  â”œâ”€â”€ Full: CGLIBä»£ç†ï¼Œ@Beanè°ƒç”¨ä»å®¹å™¨è·å–                   â”‚
â”‚  â””â”€â”€ Lite: æ— ä»£ç†ï¼Œ@Beanè°ƒç”¨åˆ›å»ºæ–°å®ä¾‹                      â”‚
â”‚                                                             â”‚
â”‚  æœ€ä½³å®è·µï¼š                                                  â”‚
â”‚  â”œâ”€â”€ æœ‰Beané—´ä¾èµ–ï¼šä½¿ç”¨Fullæ¨¡å¼                             â”‚
â”‚  â”œâ”€â”€ ç‹¬ç«‹Beanï¼šä½¿ç”¨Liteæ¨¡å¼æå‡æ€§èƒ½                         â”‚
â”‚  â””â”€â”€ Liteæ¨¡å¼ï¼šé€šè¿‡å‚æ•°æ³¨å…¥ä¾èµ–                             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [Springå®˜æ–¹æ–‡æ¡£ - @Configuration](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-java)
- [Springæºç  - ConfigurationClassPostProcessor](https://github.com/spring-projects/spring-framework)

---

**ç†è§£@ConfigurationåŸç†ï¼ŒæŒæ¡Springé…ç½®ç²¾é«“ï¼** ğŸš€

*æœ€åæ›´æ–°ï¼š2025-12-28*
