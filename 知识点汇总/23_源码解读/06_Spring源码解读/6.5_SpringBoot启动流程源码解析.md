# SpringBootå¯åŠ¨æµç¨‹æºç è§£æ

> æ·±å…¥åˆ†æSpringBootå¯åŠ¨è¿‡ç¨‹ï¼ŒæŒæ¡è‡ªåŠ¨é…ç½®å’Œå®¹å™¨åˆå§‹åŒ–æ ¸å¿ƒæœºåˆ¶

---

## ğŸ“š ç›®å½•

1. [æ•´ä½“æ¶æ„](#1-æ•´ä½“æ¶æ„)
2. [SpringApplicationæ„é€ ](#2-springapplicationæ„é€ )
3. [runæ–¹æ³•æ ¸å¿ƒæµç¨‹](#3-runæ–¹æ³•æ ¸å¿ƒæµç¨‹)
4. [ç¯å¢ƒå‡†å¤‡](#4-ç¯å¢ƒå‡†å¤‡)
5. [ApplicationContextåˆ›å»º](#5-applicationcontextåˆ›å»º)
6. [è‡ªåŠ¨é…ç½®åŠ è½½](#6-è‡ªåŠ¨é…ç½®åŠ è½½)
7. [å¯åŠ¨ä¼˜åŒ–](#7-å¯åŠ¨ä¼˜åŒ–)
8. [æµç¨‹å›¾è§£](#8-æµç¨‹å›¾è§£)
9. [é¢è¯•è¦ç‚¹](#9-é¢è¯•è¦ç‚¹)

---

## 1. æ•´ä½“æ¶æ„

### 1.1 å¯åŠ¨å…¥å£

```java
/**
 * SpringBootåº”ç”¨å¯åŠ¨å…¥å£
 */
@SpringBootApplication
public class Application {
    public static void main(String[] args) {
        // å¯åŠ¨SpringBootåº”ç”¨
        SpringApplication.run(Application.class, args);
    }
}

/**
 * @SpringBootApplication æ˜¯ç»„åˆæ³¨è§£
 */
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@SpringBootConfiguration  // ç­‰åŒäº@Configuration
@EnableAutoConfiguration  // å¼€å¯è‡ªåŠ¨é…ç½®
@ComponentScan            // ç»„ä»¶æ‰«æ
public @interface SpringBootApplication {
    // ...
}
```

### 1.2 æ ¸å¿ƒç±»ç»“æ„

```
SpringApplication
â”œâ”€â”€ å±æ€§
â”‚   â”œâ”€â”€ primarySources          # ä¸»é…ç½®ç±»
â”‚   â”œâ”€â”€ webApplicationType      # Webåº”ç”¨ç±»å‹
â”‚   â”œâ”€â”€ initializers            # ApplicationContextInitializeråˆ—è¡¨
â”‚   â”œâ”€â”€ listeners               # ApplicationListeneråˆ—è¡¨
â”‚   â””â”€â”€ mainApplicationClass    # mainæ–¹æ³•æ‰€åœ¨ç±»
â”œâ”€â”€ æ„é€ æ–¹æ³•
â”‚   â””â”€â”€ SpringApplication(Class<?>... primarySources)
â””â”€â”€ æ ¸å¿ƒæ–¹æ³•
    â””â”€â”€ run(String... args) â†’ ConfigurableApplicationContext
```


---

## 2. SpringApplicationæ„é€ 

### 2.1 æ„é€ æ–¹æ³•æºç 

```java
public class SpringApplication {
    
    // ä¸»é…ç½®ç±»é›†åˆ
    private Set<Class<?>> primarySources;
    
    // Webåº”ç”¨ç±»å‹
    private WebApplicationType webApplicationType;
    
    // åº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹åŒ–å™¨
    private List<ApplicationContextInitializer<?>> initializers;
    
    // åº”ç”¨ç›‘å¬å™¨
    private List<ApplicationListener<?>> listeners;
    
    // mainæ–¹æ³•æ‰€åœ¨ç±»
    private Class<?> mainApplicationClass;
    
    /**
     * æ„é€ æ–¹æ³•
     */
    public SpringApplication(Class<?>... primarySources) {
        this(null, primarySources);
    }
    
    public SpringApplication(ResourceLoader resourceLoader, Class<?>... primarySources) {
        this.resourceLoader = resourceLoader;
        Assert.notNull(primarySources, "PrimarySources must not be null");
        
        // 1. ä¿å­˜ä¸»é…ç½®ç±»
        this.primarySources = new LinkedHashSet<>(Arrays.asList(primarySources));
        
        // 2. æ¨æ–­Webåº”ç”¨ç±»å‹
        this.webApplicationType = WebApplicationType.deduceFromClasspath();
        
        // 3. åŠ è½½ApplicationContextInitializer
        setInitializers((Collection) getSpringFactoriesInstances(
            ApplicationContextInitializer.class));
        
        // 4. åŠ è½½ApplicationListener
        setListeners((Collection) getSpringFactoriesInstances(
            ApplicationListener.class));
        
        // 5. æ¨æ–­mainæ–¹æ³•æ‰€åœ¨ç±»
        this.mainApplicationClass = deduceMainApplicationClass();
    }
}
```

### 2.2 æ¨æ–­Webåº”ç”¨ç±»å‹

```java
/**
 * Webåº”ç”¨ç±»å‹æšä¸¾
 */
public enum WebApplicationType {
    NONE,      // éWebåº”ç”¨
    SERVLET,   // Servlet Webåº”ç”¨
    REACTIVE;  // å“åº”å¼Webåº”ç”¨
    
    private static final String[] SERVLET_INDICATOR_CLASSES = {
        "javax.servlet.Servlet",
        "org.springframework.web.context.ConfigurableWebApplicationContext"
    };
    
    private static final String WEBMVC_INDICATOR_CLASS = 
        "org.springframework.web.servlet.DispatcherServlet";
    
    private static final String WEBFLUX_INDICATOR_CLASS = 
        "org.springframework.web.reactive.DispatcherHandler";
    
    /**
     * æ ¹æ®ç±»è·¯å¾„æ¨æ–­Webåº”ç”¨ç±»å‹
     */
    static WebApplicationType deduceFromClasspath() {
        // 1. æ£€æŸ¥æ˜¯å¦æ˜¯å“åº”å¼åº”ç”¨
        if (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, null) && 
            !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, null) &&
            !ClassUtils.isPresent("org.glassfish.jersey.servlet.ServletContainer", null)) {
            return WebApplicationType.REACTIVE;
        }
        // 2. æ£€æŸ¥æ˜¯å¦æ˜¯Servletåº”ç”¨
        for (String className : SERVLET_INDICATOR_CLASSES) {
            if (!ClassUtils.isPresent(className, null)) {
                return WebApplicationType.NONE;
            }
        }
        return WebApplicationType.SERVLET;
    }
}
```

### 2.3 åŠ è½½SpringFactories

```java
/**
 * ä»META-INF/spring.factoriesåŠ è½½æŒ‡å®šç±»å‹çš„å®ä¾‹
 */
private <T> Collection<T> getSpringFactoriesInstances(Class<T> type) {
    return getSpringFactoriesInstances(type, new Class<?>[] {});
}

private <T> Collection<T> getSpringFactoriesInstances(Class<T> type, 
        Class<?>[] parameterTypes, Object... args) {
    ClassLoader classLoader = getClassLoader();
    // 1. ä»spring.factoriesåŠ è½½ç±»å
    Set<String> names = new LinkedHashSet<>(
        SpringFactoriesLoader.loadFactoryNames(type, classLoader));
    // 2. å®ä¾‹åŒ–
    List<T> instances = createSpringFactoriesInstances(type, parameterTypes, 
        classLoader, args, names);
    // 3. æ’åº
    AnnotationAwareOrderComparator.sort(instances);
    return instances;
}
```

---

## 3. runæ–¹æ³•æ ¸å¿ƒæµç¨‹

### 3.1 runæ–¹æ³•æºç 

```java
/**
 * SpringApplication.run() æ ¸å¿ƒæ–¹æ³•
 */
public ConfigurableApplicationContext run(String... args) {
    // 1. åˆ›å»ºStopWatchï¼Œè®°å½•å¯åŠ¨æ—¶é—´
    StopWatch stopWatch = new StopWatch();
    stopWatch.start();
    
    ConfigurableApplicationContext context = null;
    Collection<SpringBootExceptionReporter> exceptionReporters = new ArrayList<>();
    
    // 2. é…ç½®Headlesså±æ€§
    configureHeadlessProperty();
    
    // 3. è·å–SpringApplicationRunListeners
    SpringApplicationRunListeners listeners = getRunListeners(args);
    // å‘å¸ƒApplicationStartingEventäº‹ä»¶
    listeners.starting();
    
    try {
        // 4. å°è£…å‘½ä»¤è¡Œå‚æ•°
        ApplicationArguments applicationArguments = new DefaultApplicationArguments(args);
        
        // 5. å‡†å¤‡ç¯å¢ƒ
        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);
        configureIgnoreBeanInfo(environment);
        
        // 6. æ‰“å°Banner
        Banner printedBanner = printBanner(environment);
        
        // 7. åˆ›å»ºApplicationContext
        context = createApplicationContext();
        
        // 8. è·å–å¼‚å¸¸æŠ¥å‘Šå™¨
        exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,
            new Class[] { ConfigurableApplicationContext.class }, context);
        
        // 9. å‡†å¤‡ä¸Šä¸‹æ–‡
        prepareContext(context, environment, listeners, applicationArguments, printedBanner);
        
        // 10. åˆ·æ–°ä¸Šä¸‹æ–‡ï¼ˆæ ¸å¿ƒï¼ï¼‰
        refreshContext(context);
        
        // 11. åˆ·æ–°åå¤„ç†
        afterRefresh(context, applicationArguments);
        
        // 12. åœæ­¢è®¡æ—¶
        stopWatch.stop();
        if (this.logStartupInfo) {
            new StartupInfoLogger(this.mainApplicationClass)
                .logStarted(getApplicationLog(), stopWatch);
        }
        
        // 13. å‘å¸ƒApplicationStartedEventäº‹ä»¶
        listeners.started(context);
        
        // 14. è°ƒç”¨Runner
        callRunners(context, applicationArguments);
    } catch (Throwable ex) {
        handleRunFailure(context, ex, exceptionReporters, listeners);
        throw new IllegalStateException(ex);
    }
    
    try {
        // 15. å‘å¸ƒApplicationReadyEventäº‹ä»¶
        listeners.running(context);
    } catch (Throwable ex) {
        handleRunFailure(context, ex, exceptionReporters, null);
        throw new IllegalStateException(ex);
    }
    
    return context;
}
```

### 3.2 å¯åŠ¨äº‹ä»¶é¡ºåº

```
SpringBootå¯åŠ¨äº‹ä»¶é¡ºåºï¼š

1. ApplicationStartingEvent
   â””â”€ åº”ç”¨å¼€å§‹å¯åŠ¨ï¼Œç¯å¢ƒå’Œä¸Šä¸‹æ–‡è¿˜æœªåˆ›å»º

2. ApplicationEnvironmentPreparedEvent
   â””â”€ ç¯å¢ƒå‡†å¤‡å®Œæˆï¼Œä¸Šä¸‹æ–‡è¿˜æœªåˆ›å»º

3. ApplicationContextInitializedEvent
   â””â”€ ä¸Šä¸‹æ–‡åˆ›å»ºå®Œæˆï¼ŒBeanè¿˜æœªåŠ è½½

4. ApplicationPreparedEvent
   â””â”€ Beanå®šä¹‰åŠ è½½å®Œæˆï¼Œè¿˜æœªåˆ·æ–°

5. ContextRefreshedEvent (SpringåŸç”Ÿäº‹ä»¶)
   â””â”€ ä¸Šä¸‹æ–‡åˆ·æ–°å®Œæˆ

6. ApplicationStartedEvent
   â””â”€ åº”ç”¨å¯åŠ¨å®Œæˆï¼ŒRunnerè¿˜æœªè°ƒç”¨

7. ApplicationReadyEvent
   â””â”€ åº”ç”¨å®Œå…¨å°±ç»ªï¼Œå¯ä»¥æ¥æ”¶è¯·æ±‚
```

---

## 4. ç¯å¢ƒå‡†å¤‡

### 4.1 prepareEnvironmentæ–¹æ³•

```java
/**
 * å‡†å¤‡ç¯å¢ƒ
 */
private ConfigurableEnvironment prepareEnvironment(
        SpringApplicationRunListeners listeners,
        ApplicationArguments applicationArguments) {
    
    // 1. åˆ›å»ºæˆ–è·å–ç¯å¢ƒ
    ConfigurableEnvironment environment = getOrCreateEnvironment();
    
    // 2. é…ç½®ç¯å¢ƒ
    configureEnvironment(environment, applicationArguments.getSourceArgs());
    
    // 3. ç»‘å®šç¯å¢ƒåˆ°SpringApplication
    ConfigurationPropertySources.attach(environment);
    
    // 4. å‘å¸ƒApplicationEnvironmentPreparedEventäº‹ä»¶
    listeners.environmentPrepared(environment);
    
    // 5. ç»‘å®šç¯å¢ƒåˆ°SpringApplication
    bindToSpringApplication(environment);
    
    // 6. è½¬æ¢ç¯å¢ƒç±»å‹ï¼ˆå¦‚æœéœ€è¦ï¼‰
    if (!this.isCustomEnvironment) {
        environment = new EnvironmentConverter(getClassLoader())
            .convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());
    }
    
    // 7. é‡æ–°ç»‘å®šé…ç½®å±æ€§æº
    ConfigurationPropertySources.attach(environment);
    
    return environment;
}

/**
 * åˆ›å»ºç¯å¢ƒ
 */
private ConfigurableEnvironment getOrCreateEnvironment() {
    if (this.environment != null) {
        return this.environment;
    }
    switch (this.webApplicationType) {
        case SERVLET:
            return new StandardServletEnvironment();
        case REACTIVE:
            return new StandardReactiveWebEnvironment();
        default:
            return new StandardEnvironment();
    }
}
```

### 4.2 é…ç½®å±æ€§æº

```java
/**
 * é…ç½®ç¯å¢ƒ
 */
protected void configureEnvironment(ConfigurableEnvironment environment, String[] args) {
    // 1. æ·»åŠ è½¬æ¢æœåŠ¡
    if (this.addConversionService) {
        ConversionService conversionService = ApplicationConversionService.getSharedInstance();
        environment.setConversionService((ConfigurableConversionService) conversionService);
    }
    // 2. é…ç½®å±æ€§æº
    configurePropertySources(environment, args);
    // 3. é…ç½®Profiles
    configureProfiles(environment, args);
}

/**
 * é…ç½®å±æ€§æº
 */
protected void configurePropertySources(ConfigurableEnvironment environment, String[] args) {
    MutablePropertySources sources = environment.getPropertySources();
    // æ·»åŠ é»˜è®¤å±æ€§
    if (this.defaultProperties != null && !this.defaultProperties.isEmpty()) {
        sources.addLast(new MapPropertySource("defaultProperties", this.defaultProperties));
    }
    // æ·»åŠ å‘½ä»¤è¡Œå‚æ•°
    if (this.addCommandLineProperties && args.length > 0) {
        String name = CommandLinePropertySource.COMMAND_LINE_PROPERTY_SOURCE_NAME;
        if (sources.contains(name)) {
            PropertySource<?> source = sources.get(name);
            CompositePropertySource composite = new CompositePropertySource(name);
            composite.addPropertySource(new SimpleCommandLinePropertySource(
                "springApplicationCommandLineArgs", args));
            composite.addPropertySource(source);
            sources.replace(name, composite);
        } else {
            sources.addFirst(new SimpleCommandLinePropertySource(args));
        }
    }
}
```


---

## 5. ApplicationContextåˆ›å»º

### 5.1 createApplicationContextæ–¹æ³•

```java
/**
 * åˆ›å»ºApplicationContext
 */
protected ConfigurableApplicationContext createApplicationContext() {
    Class<?> contextClass = this.applicationContextClass;
    if (contextClass == null) {
        try {
            switch (this.webApplicationType) {
                case SERVLET:
                    contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);
                    break;
                case REACTIVE:
                    contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);
                    break;
                default:
                    contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);
            }
        } catch (ClassNotFoundException ex) {
            throw new IllegalStateException(...);
        }
    }
    return (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);
}

// é»˜è®¤ä¸Šä¸‹æ–‡ç±»
public static final String DEFAULT_CONTEXT_CLASS = 
    "org.springframework.context.annotation.AnnotationConfigApplicationContext";

public static final String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = 
    "org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext";

public static final String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = 
    "org.springframework.boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext";
```

### 5.2 prepareContextæ–¹æ³•

```java
/**
 * å‡†å¤‡ä¸Šä¸‹æ–‡
 */
private void prepareContext(ConfigurableApplicationContext context,
        ConfigurableEnvironment environment,
        SpringApplicationRunListeners listeners,
        ApplicationArguments applicationArguments,
        Banner printedBanner) {
    
    // 1. è®¾ç½®ç¯å¢ƒ
    context.setEnvironment(environment);
    
    // 2. åç½®å¤„ç†ä¸Šä¸‹æ–‡
    postProcessApplicationContext(context);
    
    // 3. åº”ç”¨åˆå§‹åŒ–å™¨
    applyInitializers(context);
    
    // 4. å‘å¸ƒApplicationContextInitializedEventäº‹ä»¶
    listeners.contextPrepared(context);
    
    // 5. æ‰“å°å¯åŠ¨æ—¥å¿—
    if (this.logStartupInfo) {
        logStartupInfo(context.getParent() == null);
        logStartupProfileInfo(context);
    }
    
    // 6. æ³¨å†Œç‰¹æ®Šçš„å•ä¾‹Bean
    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();
    beanFactory.registerSingleton("springApplicationArguments", applicationArguments);
    if (printedBanner != null) {
        beanFactory.registerSingleton("springBootBanner", printedBanner);
    }
    
    // 7. è®¾ç½®å…è®¸Beanå®šä¹‰è¦†ç›–
    if (beanFactory instanceof DefaultListableBeanFactory) {
        ((DefaultListableBeanFactory) beanFactory)
            .setAllowBeanDefinitionOverriding(this.allowBeanDefinitionOverriding);
    }
    
    // 8. æ·»åŠ æ‡’åŠ è½½åç½®å¤„ç†å™¨
    if (this.lazyInitialization) {
        context.addBeanFactoryPostProcessor(new LazyInitializationBeanFactoryPostProcessor());
    }
    
    // 9. åŠ è½½æ‰€æœ‰æºï¼ˆä¸»é…ç½®ç±»ï¼‰
    Set<Object> sources = getAllSources();
    Assert.notEmpty(sources, "Sources must not be empty");
    load(context, sources.toArray(new Object[0]));
    
    // 10. å‘å¸ƒApplicationPreparedEventäº‹ä»¶
    listeners.contextLoaded(context);
}

/**
 * åº”ç”¨åˆå§‹åŒ–å™¨
 */
protected void applyInitializers(ConfigurableApplicationContext context) {
    for (ApplicationContextInitializer initializer : getInitializers()) {
        Class<?> requiredType = GenericTypeResolver.resolveTypeArgument(
            initializer.getClass(), ApplicationContextInitializer.class);
        Assert.isInstanceOf(requiredType, context, "Unable to call initializer.");
        initializer.initialize(context);
    }
}
```

### 5.3 refreshContextæ–¹æ³•

```java
/**
 * åˆ·æ–°ä¸Šä¸‹æ–‡ï¼ˆæ ¸å¿ƒæ–¹æ³•ï¼‰
 */
private void refreshContext(ConfigurableApplicationContext context) {
    // æ³¨å†Œå…³é—­é’©å­
    if (this.registerShutdownHook) {
        try {
            context.registerShutdownHook();
        } catch (AccessControlException ex) {
            // Not allowed in some environments
        }
    }
    // åˆ·æ–°ä¸Šä¸‹æ–‡
    refresh(context);
}

/**
 * è°ƒç”¨AbstractApplicationContext.refresh()
 */
protected void refresh(ApplicationContext applicationContext) {
    Assert.isInstanceOf(AbstractApplicationContext.class, applicationContext);
    ((AbstractApplicationContext) applicationContext).refresh();
}
```

---

## 6. è‡ªåŠ¨é…ç½®åŠ è½½

### 6.1 @EnableAutoConfigurationåŸç†

```java
/**
 * @EnableAutoConfigurationæ³¨è§£
 */
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@AutoConfigurationPackage
@Import(AutoConfigurationImportSelector.class)  // å…³é”®ï¼
public @interface EnableAutoConfiguration {
    
    String ENABLED_OVERRIDE_PROPERTY = "spring.boot.enableautoconfiguration";
    
    Class<?>[] exclude() default {};
    
    String[] excludeName() default {};
}
```

### 6.2 AutoConfigurationImportSelector

```java
/**
 * è‡ªåŠ¨é…ç½®å¯¼å…¥é€‰æ‹©å™¨
 */
public class AutoConfigurationImportSelector implements DeferredImportSelector, 
        BeanClassLoaderAware, ResourceLoaderAware, BeanFactoryAware, EnvironmentAware, Ordered {
    
    /**
     * é€‰æ‹©è¦å¯¼å…¥çš„é…ç½®ç±»
     */
    @Override
    public String[] selectImports(AnnotationMetadata annotationMetadata) {
        if (!isEnabled(annotationMetadata)) {
            return NO_IMPORTS;
        }
        // è·å–è‡ªåŠ¨é…ç½®æ¡ç›®
        AutoConfigurationEntry autoConfigurationEntry = getAutoConfigurationEntry(annotationMetadata);
        return StringUtils.toStringArray(autoConfigurationEntry.getConfigurations());
    }
    
    /**
     * è·å–è‡ªåŠ¨é…ç½®æ¡ç›®
     */
    protected AutoConfigurationEntry getAutoConfigurationEntry(AnnotationMetadata annotationMetadata) {
        if (!isEnabled(annotationMetadata)) {
            return EMPTY_ENTRY;
        }
        // 1. è·å–æ³¨è§£å±æ€§
        AnnotationAttributes attributes = getAttributes(annotationMetadata);
        
        // 2. ä»spring.factoriesåŠ è½½æ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»
        List<String> configurations = getCandidateConfigurations(annotationMetadata, attributes);
        
        // 3. å»é‡
        configurations = removeDuplicates(configurations);
        
        // 4. è·å–æ’é™¤çš„é…ç½®ç±»
        Set<String> exclusions = getExclusions(annotationMetadata, attributes);
        checkExcludedClasses(configurations, exclusions);
        
        // 5. ç§»é™¤æ’é™¤çš„é…ç½®ç±»
        configurations.removeAll(exclusions);
        
        // 6. è¿‡æ»¤ï¼ˆæ ¹æ®@Conditionalæ¡ä»¶ï¼‰
        configurations = getConfigurationClassFilter().filter(configurations);
        
        // 7. è§¦å‘è‡ªåŠ¨é…ç½®å¯¼å…¥äº‹ä»¶
        fireAutoConfigurationImportEvents(configurations, exclusions);
        
        return new AutoConfigurationEntry(configurations, exclusions);
    }
    
    /**
     * ä»spring.factoriesåŠ è½½è‡ªåŠ¨é…ç½®ç±»
     */
    protected List<String> getCandidateConfigurations(AnnotationMetadata metadata,
            AnnotationAttributes attributes) {
        List<String> configurations = SpringFactoriesLoader.loadFactoryNames(
            getSpringFactoriesLoaderFactoryClass(), getBeanClassLoader());
        Assert.notEmpty(configurations,
            "No auto configuration classes found in META-INF/spring.factories. " +
            "If you are using a custom packaging, make sure that file is correct.");
        return configurations;
    }
    
    protected Class<?> getSpringFactoriesLoaderFactoryClass() {
        return EnableAutoConfiguration.class;
    }
}
```

### 6.3 spring.factoriesæ–‡ä»¶

```properties
# META-INF/spring.factories

# Auto Configure
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\
org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\
org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\
org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration,\
...
```

### 6.4 æ¡ä»¶æ³¨è§£è¿‡æ»¤

```java
/**
 * å¸¸ç”¨æ¡ä»¶æ³¨è§£
 */
// ç±»å­˜åœ¨æ—¶ç”Ÿæ•ˆ
@ConditionalOnClass(DataSource.class)

// ç±»ä¸å­˜åœ¨æ—¶ç”Ÿæ•ˆ
@ConditionalOnMissingClass("com.example.SomeClass")

// Beanå­˜åœ¨æ—¶ç”Ÿæ•ˆ
@ConditionalOnBean(DataSource.class)

// Beanä¸å­˜åœ¨æ—¶ç”Ÿæ•ˆ
@ConditionalOnMissingBean(DataSource.class)

// å±æ€§åŒ¹é…æ—¶ç”Ÿæ•ˆ
@ConditionalOnProperty(prefix = "spring.datasource", name = "enabled", havingValue = "true")

// Webåº”ç”¨æ—¶ç”Ÿæ•ˆ
@ConditionalOnWebApplication

// éWebåº”ç”¨æ—¶ç”Ÿæ•ˆ
@ConditionalOnNotWebApplication

/**
 * è‡ªåŠ¨é…ç½®ç±»ç¤ºä¾‹
 */
@Configuration
@ConditionalOnClass(DataSource.class)
@ConditionalOnMissingBean(DataSource.class)
@EnableConfigurationProperties(DataSourceProperties.class)
public class DataSourceAutoConfiguration {
    
    @Bean
    @ConditionalOnProperty(prefix = "spring.datasource", name = "type")
    public DataSource dataSource(DataSourceProperties properties) {
        return properties.initializeDataSourceBuilder().build();
    }
}
```


---

## 7. å¯åŠ¨ä¼˜åŒ–

### 7.1 å¯åŠ¨è€—æ—¶åˆ†æ

```java
/**
 * å¯åŠ¨è€—æ—¶åˆ†æ
 */
// æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨å‚æ•°
// java -jar app.jar --debug

// æ–¹å¼2ï¼šé…ç½®æ–‡ä»¶
// application.properties
// debug=true

// æ–¹å¼3ï¼šä½¿ç”¨ApplicationStartup
@SpringBootApplication
public class Application {
    public static void main(String[] args) {
        SpringApplication app = new SpringApplication(Application.class);
        // ä½¿ç”¨BufferingApplicationStartupè®°å½•å¯åŠ¨æ­¥éª¤
        app.setApplicationStartup(new BufferingApplicationStartup(2048));
        app.run(args);
    }
}

// æ–¹å¼4ï¼šä½¿ç”¨Actuatorç«¯ç‚¹
// GET /actuator/startup
```

### 7.2 å¸¸è§ä¼˜åŒ–æ‰‹æ®µ

```java
/**
 * SpringBootå¯åŠ¨ä¼˜åŒ–
 */
public class StartupOptimization {
    
    // 1. å»¶è¿Ÿåˆå§‹åŒ–
    // application.properties
    // spring.main.lazy-initialization=true
    
    // 2. æ’é™¤ä¸éœ€è¦çš„è‡ªåŠ¨é…ç½®
    @SpringBootApplication(exclude = {
        DataSourceAutoConfiguration.class,
        RedisAutoConfiguration.class
    })
    public class Application { }
    
    // 3. ä½¿ç”¨ç´¢å¼•åŠ é€Ÿç»„ä»¶æ‰«æ
    // æ·»åŠ ä¾èµ–ï¼šspring-context-indexer
    // ç¼–è¯‘æ—¶ç”Ÿæˆ META-INF/spring.components
    
    // 4. å‡å°‘ç»„ä»¶æ‰«æèŒƒå›´
    @SpringBootApplication
    @ComponentScan(basePackages = "com.example.service")
    public class Application { }
    
    // 5. ä½¿ç”¨JVMå‚æ•°ä¼˜åŒ–
    // -XX:TieredStopAtLevel=1
    // -noverify
    
    // 6. ä½¿ç”¨Spring Nativeï¼ˆGraalVMï¼‰
    // ç¼–è¯‘ä¸ºåŸç”Ÿé•œåƒï¼Œå¯åŠ¨æ—¶é—´æ¯«ç§’çº§
}
```

### 7.3 å¯åŠ¨äº‹ä»¶ç›‘å¬

```java
/**
 * è‡ªå®šä¹‰å¯åŠ¨ç›‘å¬å™¨
 */
@Component
public class StartupListener implements ApplicationListener<ApplicationReadyEvent> {
    
    @Override
    public void onApplicationEvent(ApplicationReadyEvent event) {
        // åº”ç”¨å¯åŠ¨å®Œæˆåæ‰§è¡Œ
        System.out.println("Application started successfully!");
    }
}

/**
 * ä½¿ç”¨@EventListener
 */
@Component
public class StartupEventHandler {
    
    @EventListener
    public void handleContextRefresh(ContextRefreshedEvent event) {
        System.out.println("Context refreshed!");
    }
    
    @EventListener
    public void handleApplicationReady(ApplicationReadyEvent event) {
        System.out.println("Application ready!");
    }
}

/**
 * ä½¿ç”¨CommandLineRunner/ApplicationRunner
 */
@Component
@Order(1)
public class MyRunner implements CommandLineRunner {
    
    @Override
    public void run(String... args) throws Exception {
        // åº”ç”¨å¯åŠ¨åæ‰§è¡Œ
        System.out.println("CommandLineRunner executed!");
    }
}

@Component
@Order(2)
public class MyApplicationRunner implements ApplicationRunner {
    
    @Override
    public void run(ApplicationArguments args) throws Exception {
        // å¯ä»¥è·å–æ›´ä¸°å¯Œçš„å‚æ•°ä¿¡æ¯
        System.out.println("ApplicationRunner executed!");
    }
}
```

---

## 8. æµç¨‹å›¾è§£

### 8.1 SpringBootå¯åŠ¨å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SpringBoot å¯åŠ¨å®Œæ•´æµç¨‹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

main()
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ new SpringApplication(primarySources)                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1. ä¿å­˜ä¸»é…ç½®ç±»                                      â”‚ â”‚
â”‚ â”‚ 2. æ¨æ–­Webåº”ç”¨ç±»å‹                                   â”‚ â”‚
â”‚ â”‚ 3. åŠ è½½ApplicationContextInitializer                â”‚ â”‚
â”‚ â”‚ 4. åŠ è½½ApplicationListener                          â”‚ â”‚
â”‚ â”‚ 5. æ¨æ–­mainæ–¹æ³•æ‰€åœ¨ç±»                               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SpringApplication.run(args)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â”œâ”€â†’ 1. åˆ›å»ºStopWatchï¼Œå¼€å§‹è®¡æ—¶
  â”‚
  â”œâ”€â†’ 2. è·å–SpringApplicationRunListeners
  â”‚      â””â”€â†’ å‘å¸ƒ ApplicationStartingEvent
  â”‚
  â”œâ”€â†’ 3. å‡†å¤‡ç¯å¢ƒ prepareEnvironment()
  â”‚      â”œâ”€â†’ åˆ›å»ºEnvironment
  â”‚      â”œâ”€â†’ é…ç½®å±æ€§æº
  â”‚      â””â”€â†’ å‘å¸ƒ ApplicationEnvironmentPreparedEvent
  â”‚
  â”œâ”€â†’ 4. æ‰“å°Banner
  â”‚
  â”œâ”€â†’ 5. åˆ›å»ºApplicationContext
  â”‚      â””â”€â†’ æ ¹æ®webApplicationTypeé€‰æ‹©å®ç°ç±»
  â”‚
  â”œâ”€â†’ 6. å‡†å¤‡ä¸Šä¸‹æ–‡ prepareContext()
  â”‚      â”œâ”€â†’ è®¾ç½®ç¯å¢ƒ
  â”‚      â”œâ”€â†’ åº”ç”¨åˆå§‹åŒ–å™¨
  â”‚      â”œâ”€â†’ å‘å¸ƒ ApplicationContextInitializedEvent
  â”‚      â”œâ”€â†’ åŠ è½½ä¸»é…ç½®ç±»
  â”‚      â””â”€â†’ å‘å¸ƒ ApplicationPreparedEvent
  â”‚
  â”œâ”€â†’ 7. åˆ·æ–°ä¸Šä¸‹æ–‡ refreshContext()
  â”‚      â””â”€â†’ AbstractApplicationContext.refresh()
  â”‚          â”œâ”€â†’ å‡†å¤‡BeanFactory
  â”‚          â”œâ”€â†’ è°ƒç”¨BeanFactoryPostProcessor
  â”‚          â”œâ”€â†’ æ³¨å†ŒBeanPostProcessor
  â”‚          â”œâ”€â†’ åˆå§‹åŒ–MessageSource
  â”‚          â”œâ”€â†’ åˆå§‹åŒ–äº‹ä»¶å¹¿æ’­å™¨
  â”‚          â”œâ”€â†’ åˆ›å»ºå†…åµŒWebæœåŠ¡å™¨
  â”‚          â”œâ”€â†’ æ³¨å†Œç›‘å¬å™¨
  â”‚          â”œâ”€â†’ å®ä¾‹åŒ–æ‰€æœ‰å•ä¾‹Bean
  â”‚          â””â”€â†’ å‘å¸ƒ ContextRefreshedEvent
  â”‚
  â”œâ”€â†’ 8. åœæ­¢è®¡æ—¶ï¼Œæ‰“å°å¯åŠ¨æ—¥å¿—
  â”‚
  â”œâ”€â†’ 9. å‘å¸ƒ ApplicationStartedEvent
  â”‚
  â”œâ”€â†’ 10. è°ƒç”¨Runner
  â”‚       â”œâ”€â†’ ApplicationRunner
  â”‚       â””â”€â†’ CommandLineRunner
  â”‚
  â””â”€â†’ 11. å‘å¸ƒ ApplicationReadyEvent
```

### 8.2 è‡ªåŠ¨é…ç½®åŠ è½½æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  è‡ªåŠ¨é…ç½®åŠ è½½æµç¨‹                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

@SpringBootApplication
        â”‚
        â”œâ”€â†’ @EnableAutoConfiguration
        â”‚           â”‚
        â”‚           â””â”€â†’ @Import(AutoConfigurationImportSelector.class)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AutoConfigurationImportSelector.selectImports()          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SpringFactoriesLoader.loadFactoryNames()                 â”‚
â”‚ ä» META-INF/spring.factories åŠ è½½                        â”‚
â”‚ EnableAutoConfiguration å¯¹åº”çš„é…ç½®ç±»                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å»é‡ã€æ’é™¤ã€è¿‡æ»¤                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1. removeDuplicates() - å»é‡                        â”‚ â”‚
â”‚ â”‚ 2. getExclusions() - è·å–æ’é™¤é¡¹                     â”‚ â”‚
â”‚ â”‚ 3. filter() - æ ¹æ®@Conditionalæ¡ä»¶è¿‡æ»¤              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿”å›æœ€ç»ˆçš„è‡ªåŠ¨é…ç½®ç±»åˆ—è¡¨                                  â”‚
â”‚ ç”±ConfigurationClassPostProcessorå¤„ç†                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. é¢è¯•è¦ç‚¹

### 9.1 é«˜é¢‘é¢è¯•é¢˜

```
Q1: SpringBootçš„å¯åŠ¨æµç¨‹ï¼Ÿ
A: 1. åˆ›å»ºSpringApplicationå¯¹è±¡
      - æ¨æ–­Webåº”ç”¨ç±»å‹
      - åŠ è½½åˆå§‹åŒ–å™¨å’Œç›‘å¬å™¨
   2. æ‰§è¡Œrunæ–¹æ³•
      - å‡†å¤‡ç¯å¢ƒ
      - åˆ›å»ºApplicationContext
      - å‡†å¤‡ä¸Šä¸‹æ–‡
      - åˆ·æ–°ä¸Šä¸‹æ–‡ï¼ˆæ ¸å¿ƒï¼‰
      - è°ƒç”¨Runner

Q2: SpringBootè‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ
A: 1. @EnableAutoConfigurationå¯¼å…¥AutoConfigurationImportSelector
   2. ä»META-INF/spring.factoriesåŠ è½½é…ç½®ç±»
   3. æ ¹æ®@Conditionalæ¡ä»¶è¿‡æ»¤
   4. æœ€ç»ˆç”Ÿæ•ˆçš„é…ç½®ç±»è¢«åŠ è½½åˆ°å®¹å™¨

Q3: spring.factoriesçš„ä½œç”¨ï¼Ÿ
A: SPIæœºåˆ¶çš„å®ç°ï¼Œç”¨äºåŠ è½½ï¼š
   - è‡ªåŠ¨é…ç½®ç±»
   - ApplicationContextInitializer
   - ApplicationListener
   - FailureAnalyzerç­‰

Q4: @Conditionalæ³¨è§£çš„ä½œç”¨ï¼Ÿ
A: æ¡ä»¶è£…é…ï¼Œåªæœ‰æ»¡è¶³æ¡ä»¶æ—¶æ‰åŠ è½½Beanï¼š
   - @ConditionalOnClassï¼šç±»å­˜åœ¨
   - @ConditionalOnMissingBeanï¼šBeanä¸å­˜åœ¨
   - @ConditionalOnPropertyï¼šå±æ€§åŒ¹é…

Q5: å¦‚ä½•è‡ªå®šä¹‰Starterï¼Ÿ
A: 1. åˆ›å»ºè‡ªåŠ¨é…ç½®ç±»
   2. ä½¿ç”¨@Conditionalæ¡ä»¶æ³¨è§£
   3. åœ¨spring.factoriesä¸­æ³¨å†Œ
   4. æ‰“åŒ…ä¸ºxxx-spring-boot-starter
```

### 9.2 å¯åŠ¨ä¼˜åŒ–å»ºè®®

```
1. å»¶è¿Ÿåˆå§‹åŒ–
   spring.main.lazy-initialization=true

2. æ’é™¤ä¸éœ€è¦çš„è‡ªåŠ¨é…ç½®
   @SpringBootApplication(exclude = {...})

3. ä½¿ç”¨ç»„ä»¶ç´¢å¼•
   æ·»åŠ spring-context-indexerä¾èµ–

4. å‡å°‘ç»„ä»¶æ‰«æèŒƒå›´
   ç²¾ç¡®æŒ‡å®š@ComponentScançš„basePackages

5. JVMå‚æ•°ä¼˜åŒ–
   -XX:TieredStopAtLevel=1 -noverify

6. ä½¿ç”¨Spring Native
   ç¼–è¯‘ä¸ºGraalVMåŸç”Ÿé•œåƒ
```

---

## ğŸ“š æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **å¯åŠ¨å…¥å£**ï¼šSpringApplication.run()
2. **Webç±»å‹æ¨æ–­**ï¼šNONE/SERVLET/REACTIVE
3. **è‡ªåŠ¨é…ç½®**ï¼šspring.factories + @Conditional
4. **äº‹ä»¶æœºåˆ¶**ï¼š7ä¸ªå¯åŠ¨äº‹ä»¶æŒ‰é¡ºåºå‘å¸ƒ
5. **æ‰©å±•ç‚¹**ï¼šInitializerã€Listenerã€Runner

### å…³é”®ç±»

| ç±»å | ä½œç”¨ |
|------|------|
| SpringApplication | å¯åŠ¨å¼•å¯¼ç±» |
| AutoConfigurationImportSelector | è‡ªåŠ¨é…ç½®é€‰æ‹©å™¨ |
| SpringFactoriesLoader | SPIåŠ è½½å™¨ |
| ConfigurationClassPostProcessor | é…ç½®ç±»å¤„ç†å™¨ |

---

*æœ€åæ›´æ–°ï¼š2025-12-28*
