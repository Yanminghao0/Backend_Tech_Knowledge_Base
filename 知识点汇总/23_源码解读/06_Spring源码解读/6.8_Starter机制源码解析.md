# SpringBoot Starteræœºåˆ¶æºç è§£æ

> ğŸ’¡ æ·±å…¥ç†è§£SpringBoot Starterçš„è®¾è®¡åŸç†ï¼ŒæŒæ¡è‡ªå®šä¹‰Starterå¼€å‘

---

## ğŸ“š ç›®å½•

1. [Starteræ¦‚è¿°](#1-starteræ¦‚è¿°)
2. [Starterå·¥ä½œåŸç†](#2-starterå·¥ä½œåŸç†)
3. [å®˜æ–¹Starteråˆ†æ](#3-å®˜æ–¹starteråˆ†æ)
4. [è‡ªå®šä¹‰Starterå¼€å‘](#4-è‡ªå®šä¹‰starterå¼€å‘)
5. [é…ç½®å±æ€§ç»‘å®š](#5-é…ç½®å±æ€§ç»‘å®š)
6. [æœ€ä½³å®è·µ](#6-æœ€ä½³å®è·µ)
7. [é¢è¯•è¦ç‚¹](#7-é¢è¯•è¦ç‚¹)

---

## 1. Starteræ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯Starter

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SpringBoot Starter                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Starter = ä¾èµ–ç®¡ç† + è‡ªåŠ¨é…ç½®                              â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚           spring-boot-starter-web        â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚  ä¾èµ–ï¼š                                  â”‚               â”‚
â”‚  â”‚  â”œâ”€â”€ spring-boot-starter                â”‚               â”‚
â”‚  â”‚  â”œâ”€â”€ spring-boot-starter-tomcat         â”‚               â”‚
â”‚  â”‚  â”œâ”€â”€ spring-web                         â”‚               â”‚
â”‚  â”‚  â”œâ”€â”€ spring-webmvc                      â”‚               â”‚
â”‚  â”‚  â””â”€â”€ jackson-databind                   â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚  è‡ªåŠ¨é…ç½®ï¼š                              â”‚               â”‚
â”‚  â”‚  â”œâ”€â”€ WebMvcAutoConfiguration            â”‚               â”‚
â”‚  â”‚  â”œâ”€â”€ DispatcherServletAutoConfiguration â”‚               â”‚
â”‚  â”‚  â””â”€â”€ HttpEncodingAutoConfiguration      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Starterå‘½åè§„èŒƒ

```
å®˜æ–¹Starterï¼š
spring-boot-starter-{name}
ä¾‹å¦‚ï¼š
- spring-boot-starter-web
- spring-boot-starter-data-jpa
- spring-boot-starter-security

ç¬¬ä¸‰æ–¹Starterï¼š
{name}-spring-boot-starter
ä¾‹å¦‚ï¼š
- mybatis-spring-boot-starter
- druid-spring-boot-starter
- pagehelper-spring-boot-starter
```

### 1.3 Starteræ¨¡å—ç»“æ„

```
my-spring-boot-starter/
â”œâ”€â”€ my-spring-boot-starter/                    # Starteræ¨¡å—ï¼ˆç©ºå£³ï¼‰
â”‚   â””â”€â”€ pom.xml                                # åªåŒ…å«ä¾èµ–
â”‚
â””â”€â”€ my-spring-boot-autoconfigure/              # è‡ªåŠ¨é…ç½®æ¨¡å—
    â”œâ”€â”€ src/main/java/
    â”‚   â””â”€â”€ com/example/autoconfigure/
    â”‚       â”œâ”€â”€ MyAutoConfiguration.java       # è‡ªåŠ¨é…ç½®ç±»
    â”‚       â””â”€â”€ MyProperties.java              # é…ç½®å±æ€§ç±»
    â”œâ”€â”€ src/main/resources/
    â”‚   â””â”€â”€ META-INF/
    â”‚       â””â”€â”€ spring/
    â”‚           â””â”€â”€ org.springframework.boot.autoconfigure.AutoConfiguration.imports
    â””â”€â”€ pom.xml
```


---

## 2. Starterå·¥ä½œåŸç†

### 2.1 å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Starterå·¥ä½œæµç¨‹                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. å¼•å…¥Starterä¾èµ–                                        â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  2. Maven/Gradleè§£æä¾èµ–                                   â”‚
â”‚     â””â”€â”€ ä¼ é€’ä¾èµ–ï¼šautoconfigureæ¨¡å— + æ ¸å¿ƒåº“               â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  3. SpringBootå¯åŠ¨                                         â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  4. @EnableAutoConfigurationè§¦å‘                           â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  5. AutoConfigurationImportSelectoråŠ è½½                    â”‚
â”‚     â””â”€â”€ è¯»å–AutoConfiguration.imports                      â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  6. æ¡ä»¶æ³¨è§£è¯„ä¼°                                           â”‚
â”‚     â”œâ”€â”€ @ConditionalOnClass: æ£€æŸ¥ç±»æ˜¯å¦å­˜åœ¨               â”‚
â”‚     â”œâ”€â”€ @ConditionalOnMissingBean: æ£€æŸ¥Beanæ˜¯å¦å­˜åœ¨       â”‚
â”‚     â””â”€â”€ @ConditionalOnProperty: æ£€æŸ¥å±æ€§é…ç½®              â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  7. è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆ                                         â”‚
â”‚     â””â”€â”€ æ³¨å†ŒBeanåˆ°å®¹å™¨                                     â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  8. åŠŸèƒ½å¯ç”¨                                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ä¾èµ–ä¼ é€’æœºåˆ¶

```xml
<!-- spring-boot-starter-webçš„pom.xml -->
<dependencies>
    <!-- æ ¸å¿ƒStarter -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter</artifactId>
    </dependency>
    
    <!-- JSONå¤„ç† -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-json</artifactId>
    </dependency>
    
    <!-- å†…åµŒTomcat -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-tomcat</artifactId>
    </dependency>
    
    <!-- Spring Web -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-web</artifactId>
    </dependency>
    
    <!-- Spring MVC -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
    </dependency>
</dependencies>
```

---

## 3. å®˜æ–¹Starteråˆ†æ

### 3.1 spring-boot-starter-data-redis

```java
/**
 * Redisè‡ªåŠ¨é…ç½®
 */
@AutoConfiguration
@ConditionalOnClass(RedisOperations.class)
@EnableConfigurationProperties(RedisProperties.class)
@Import({LettuceConnectionConfiguration.class, JedisConnectionConfiguration.class})
public class RedisAutoConfiguration {
    
    @Bean
    @ConditionalOnMissingBean(name = "redisTemplate")
    @ConditionalOnSingleCandidate(RedisConnectionFactory.class)
    public RedisTemplate<Object, Object> redisTemplate(RedisConnectionFactory redisConnectionFactory) {
        RedisTemplate<Object, Object> template = new RedisTemplate<>();
        template.setConnectionFactory(redisConnectionFactory);
        return template;
    }
    
    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnSingleCandidate(RedisConnectionFactory.class)
    public StringRedisTemplate stringRedisTemplate(RedisConnectionFactory redisConnectionFactory) {
        return new StringRedisTemplate(redisConnectionFactory);
    }
}

/**
 * Lettuceè¿æ¥é…ç½®
 */
@Configuration(proxyBeanMethods = false)
@ConditionalOnClass(RedisClient.class)
@ConditionalOnProperty(name = "spring.data.redis.client-type", havingValue = "lettuce", matchIfMissing = true)
class LettuceConnectionConfiguration extends RedisConnectionConfiguration {
    
    @Bean
    @ConditionalOnMissingBean(RedisConnectionFactory.class)
    LettuceConnectionFactory redisConnectionFactory(
            ObjectProvider<LettuceClientConfigurationBuilderCustomizer> builderCustomizers,
            ClientResources clientResources) {
        
        LettuceClientConfiguration clientConfig = getLettuceClientConfiguration(
            builderCustomizers, clientResources, getProperties().getLettuce().getPool());
        return createLettuceConnectionFactory(clientConfig);
    }
}
```

### 3.2 Redisé…ç½®å±æ€§

```java
@ConfigurationProperties(prefix = "spring.data.redis")
public class RedisProperties {
    
    private int database = 0;
    private String url;
    private String host = "localhost";
    private String username;
    private String password;
    private int port = 6379;
    private boolean ssl;
    private Duration timeout;
    private Duration connectTimeout;
    private String clientName;
    private ClientType clientType;
    private Sentinel sentinel;
    private Cluster cluster;
    private final Jedis jedis = new Jedis();
    private final Lettuce lettuce = new Lettuce();
    
    // å†…éƒ¨ç±»å®šä¹‰è¿æ¥æ± é…ç½®
    public static class Pool {
        private Boolean enabled;
        private int maxIdle = 8;
        private int minIdle = 0;
        private int maxActive = 8;
        private Duration maxWait = Duration.ofMillis(-1);
        private Duration timeBetweenEvictionRuns;
        // getters and setters
    }
    
    // getters and setters
}
```

### 3.3 spring-boot-starter-jdbc

```java
/**
 * DataSourceè‡ªåŠ¨é…ç½®
 */
@AutoConfiguration(before = SqlInitializationAutoConfiguration.class)
@ConditionalOnClass({DataSource.class, EmbeddedDatabaseType.class})
@ConditionalOnMissingBean(type = "io.r2dbc.spi.ConnectionFactory")
@EnableConfigurationProperties(DataSourceProperties.class)
@Import({
    DataSourcePoolMetadataProvidersConfiguration.class,
    DataSourceInitializationConfiguration.class
})
public class DataSourceAutoConfiguration {
    
    @Configuration(proxyBeanMethods = false)
    @Conditional(PooledDataSourceCondition.class)
    @ConditionalOnMissingBean({DataSource.class, XADataSource.class})
    @Import({
        DataSourceConfiguration.Hikari.class,
        DataSourceConfiguration.Tomcat.class,
        DataSourceConfiguration.Dbcp2.class,
        DataSourceConfiguration.OracleUcp.class,
        DataSourceConfiguration.Generic.class,
        DataSourceJmxConfiguration.class
    })
    protected static class PooledDataSourceConfiguration {
    }
}

/**
 * HikariCPé…ç½®
 */
@Configuration(proxyBeanMethods = false)
@ConditionalOnClass(HikariDataSource.class)
@ConditionalOnMissingBean(DataSource.class)
@ConditionalOnProperty(name = "spring.datasource.type", 
    havingValue = "com.zaxxer.hikari.HikariDataSource", matchIfMissing = true)
static class Hikari {
    
    @Bean
    @ConfigurationProperties(prefix = "spring.datasource.hikari")
    HikariDataSource dataSource(DataSourceProperties properties) {
        HikariDataSource dataSource = createDataSource(properties, HikariDataSource.class);
        if (StringUtils.hasText(properties.getName())) {
            dataSource.setPoolName(properties.getName());
        }
        return dataSource;
    }
}
```

---

## 4. è‡ªå®šä¹‰Starterå¼€å‘

### 4.1 é¡¹ç›®ç»“æ„

```
my-service-spring-boot/
â”œâ”€â”€ my-service-spring-boot-starter/           # Starteræ¨¡å—
â”‚   â””â”€â”€ pom.xml
â”‚
â”œâ”€â”€ my-service-spring-boot-autoconfigure/     # è‡ªåŠ¨é…ç½®æ¨¡å—
â”‚   â”œâ”€â”€ src/main/java/
â”‚   â”‚   â””â”€â”€ com/example/myservice/autoconfigure/
â”‚   â”‚       â”œâ”€â”€ MyServiceAutoConfiguration.java
â”‚   â”‚       â”œâ”€â”€ MyServiceProperties.java
â”‚   â”‚       â””â”€â”€ MyServiceTemplate.java
â”‚   â”œâ”€â”€ src/main/resources/
â”‚   â”‚   â””â”€â”€ META-INF/
â”‚   â”‚       â”œâ”€â”€ spring/
â”‚   â”‚       â”‚   â””â”€â”€ org.springframework.boot.autoconfigure.AutoConfiguration.imports
â”‚   â”‚       â””â”€â”€ additional-spring-configuration-metadata.json
â”‚   â””â”€â”€ pom.xml
â”‚
â””â”€â”€ pom.xml                                   # çˆ¶POM
```

### 4.2 Starteræ¨¡å—POM

```xml
<!-- my-service-spring-boot-starter/pom.xml -->
<?xml version="1.0" encoding="UTF-8"?>
<project>
    <modelVersion>4.0.0</modelVersion>
    
    <groupId>com.example</groupId>
    <artifactId>my-service-spring-boot-starter</artifactId>
    <version>1.0.0</version>
    <packaging>jar</packaging>
    
    <name>My Service Spring Boot Starter</name>
    <description>Starter for My Service</description>
    
    <dependencies>
        <!-- è‡ªåŠ¨é…ç½®æ¨¡å— -->
        <dependency>
            <groupId>com.example</groupId>
            <artifactId>my-service-spring-boot-autoconfigure</artifactId>
            <version>${project.version}</version>
        </dependency>
        
        <!-- æ ¸å¿ƒä¾èµ–ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ -->
        <dependency>
            <groupId>com.example</groupId>
            <artifactId>my-service-core</artifactId>
            <version>${project.version}</version>
        </dependency>
    </dependencies>
</project>
```

### 4.3 è‡ªåŠ¨é…ç½®æ¨¡å—POM

```xml
<!-- my-service-spring-boot-autoconfigure/pom.xml -->
<?xml version="1.0" encoding="UTF-8"?>
<project>
    <modelVersion>4.0.0</modelVersion>
    
    <groupId>com.example</groupId>
    <artifactId>my-service-spring-boot-autoconfigure</artifactId>
    <version>1.0.0</version>
    
    <dependencies>
        <!-- SpringBootè‡ªåŠ¨é…ç½® -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-autoconfigure</artifactId>
        </dependency>
        
        <!-- é…ç½®å¤„ç†å™¨ï¼ˆç”Ÿæˆé…ç½®å…ƒæ•°æ®ï¼‰ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-configuration-processor</artifactId>
            <optional>true</optional>
        </dependency>
        
        <!-- æ ¸å¿ƒä¾èµ–ï¼ˆå¯é€‰ï¼Œç”¨äºæ¡ä»¶åˆ¤æ–­ï¼‰ -->
        <dependency>
            <groupId>com.example</groupId>
            <artifactId>my-service-core</artifactId>
            <version>${project.version}</version>
            <optional>true</optional>
        </dependency>
    </dependencies>
</project>
```

### 4.4 é…ç½®å±æ€§ç±»

```java
package com.example.myservice.autoconfigure;

import org.springframework.boot.context.properties.ConfigurationProperties;
import java.time.Duration;

/**
 * My Serviceé…ç½®å±æ€§
 */
@ConfigurationProperties(prefix = "my.service")
public class MyServiceProperties {
    
    /**
     * æ˜¯å¦å¯ç”¨My Service
     */
    private boolean enabled = true;
    
    /**
     * æœåŠ¡åç§°
     */
    private String name = "default";
    
    /**
     * æœåŠ¡åœ°å€
     */
    private String url;
    
    /**
     * è¿æ¥è¶…æ—¶æ—¶é—´
     */
    private Duration connectTimeout = Duration.ofSeconds(5);
    
    /**
     * è¯»å–è¶…æ—¶æ—¶é—´
     */
    private Duration readTimeout = Duration.ofSeconds(30);
    
    /**
     * é‡è¯•é…ç½®
     */
    private final Retry retry = new Retry();
    
    /**
     * è¿æ¥æ± é…ç½®
     */
    private final Pool pool = new Pool();
    
    // getters and setters
    
    public static class Retry {
        private boolean enabled = true;
        private int maxAttempts = 3;
        private Duration delay = Duration.ofMillis(100);
        // getters and setters
    }
    
    public static class Pool {
        private int maxSize = 10;
        private int minIdle = 2;
        private Duration maxWait = Duration.ofSeconds(5);
        // getters and setters
    }
}
```

### 4.5 æœåŠ¡æ¨¡æ¿ç±»

```java
package com.example.myservice.autoconfigure;

import java.time.Duration;

/**
 * My Serviceæ“ä½œæ¨¡æ¿
 */
public class MyServiceTemplate {
    
    private final String name;
    private final String url;
    private final Duration connectTimeout;
    private final Duration readTimeout;
    
    public MyServiceTemplate(MyServiceProperties properties) {
        this.name = properties.getName();
        this.url = properties.getUrl();
        this.connectTimeout = properties.getConnectTimeout();
        this.readTimeout = properties.getReadTimeout();
    }
    
    /**
     * æ‰§è¡Œæ“ä½œ
     */
    public <T> T execute(String operation, Class<T> responseType) {
        // å®ç°ä¸šåŠ¡é€»è¾‘
        System.out.println("Executing " + operation + " on " + name);
        return null;
    }
    
    /**
     * å‘é€è¯·æ±‚
     */
    public String send(String message) {
        System.out.println("Sending to " + url + ": " + message);
        return "OK";
    }
    
    /**
     * å¥åº·æ£€æŸ¥
     */
    public boolean isHealthy() {
        // å®ç°å¥åº·æ£€æŸ¥é€»è¾‘
        return true;
    }
    
    // getters
    public String getName() { return name; }
    public String getUrl() { return url; }
}
```

### 4.6 è‡ªåŠ¨é…ç½®ç±»

```java
package com.example.myservice.autoconfigure;

import org.springframework.boot.autoconfigure.AutoConfiguration;
import org.springframework.boot.autoconfigure.condition.*;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

/**
 * My Serviceè‡ªåŠ¨é…ç½®
 */
@AutoConfiguration
@ConditionalOnClass(MyServiceTemplate.class)
@ConditionalOnProperty(prefix = "my.service", name = "enabled", havingValue = "true", matchIfMissing = true)
@EnableConfigurationProperties(MyServiceProperties.class)
public class MyServiceAutoConfiguration {
    
    /**
     * åˆ›å»ºMyServiceTemplate Bean
     */
    @Bean
    @ConditionalOnMissingBean
    public MyServiceTemplate myServiceTemplate(MyServiceProperties properties) {
        return new MyServiceTemplate(properties);
    }
    
    /**
     * å¥åº·æ£€æŸ¥é…ç½®
     */
    @Configuration(proxyBeanMethods = false)
    @ConditionalOnClass(name = "org.springframework.boot.actuate.health.HealthIndicator")
    static class HealthIndicatorConfiguration {
        
        @Bean
        @ConditionalOnMissingBean(name = "myServiceHealthIndicator")
        @ConditionalOnBean(MyServiceTemplate.class)
        public MyServiceHealthIndicator myServiceHealthIndicator(MyServiceTemplate template) {
            return new MyServiceHealthIndicator(template);
        }
    }
    
    /**
     * Metricsé…ç½®
     */
    @Configuration(proxyBeanMethods = false)
    @ConditionalOnClass(name = "io.micrometer.core.instrument.MeterRegistry")
    static class MetricsConfiguration {
        
        @Bean
        @ConditionalOnMissingBean
        @ConditionalOnBean(MyServiceTemplate.class)
        public MyServiceMetrics myServiceMetrics(MyServiceTemplate template) {
            return new MyServiceMetrics(template);
        }
    }
}
```

### 4.7 æ³¨å†Œè‡ªåŠ¨é…ç½®

```
# META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports
com.example.myservice.autoconfigure.MyServiceAutoConfiguration
```

### 4.8 é…ç½®å…ƒæ•°æ®

```json
// META-INF/additional-spring-configuration-metadata.json
{
  "properties": [
    {
      "name": "my.service.enabled",
      "type": "java.lang.Boolean",
      "description": "Whether to enable My Service.",
      "defaultValue": true
    },
    {
      "name": "my.service.name",
      "type": "java.lang.String",
      "description": "The name of the service.",
      "defaultValue": "default"
    },
    {
      "name": "my.service.url",
      "type": "java.lang.String",
      "description": "The URL of the service."
    }
  ],
  "hints": [
    {
      "name": "my.service.name",
      "values": [
        {
          "value": "production",
          "description": "Production environment."
        },
        {
          "value": "development",
          "description": "Development environment."
        }
      ]
    }
  ]
}
```


---

## 5. é…ç½®å±æ€§ç»‘å®š

### 5.1 @ConfigurationPropertiesåŸç†

```java
/**
 * é…ç½®å±æ€§ç»‘å®šå¤„ç†å™¨
 */
public class ConfigurationPropertiesBindingPostProcessor 
        implements BeanPostProcessor, PriorityOrdered, ApplicationContextAware {
    
    @Override
    public Object postProcessBeforeInitialization(Object bean, String beanName) {
        // ç»‘å®šé…ç½®å±æ€§
        bind(ConfigurationPropertiesBean.get(this.applicationContext, bean, beanName));
        return bean;
    }
    
    private void bind(ConfigurationPropertiesBean bean) {
        if (bean == null) {
            return;
        }
        try {
            // ğŸ”¥ æ‰§è¡Œç»‘å®š
            this.binder.bind(bean);
        } catch (Exception ex) {
            throw new ConfigurationPropertiesBindException(bean, ex);
        }
    }
}

/**
 * é…ç½®å±æ€§ç»‘å®šå™¨
 */
class ConfigurationPropertiesBinder {
    
    private final ApplicationContext applicationContext;
    private final PropertySources propertySources;
    private final Binder binder;
    
    void bind(ConfigurationPropertiesBean propertiesBean) {
        Bindable<?> target = propertiesBean.asBindTarget();
        ConfigurationProperties annotation = propertiesBean.getAnnotation();
        
        // è·å–ç»‘å®šå¤„ç†å™¨
        BindHandler bindHandler = getBindHandler(target, annotation);
        
        // ğŸ”¥ æ‰§è¡Œç»‘å®š
        this.binder.bind(annotation.prefix(), target, bindHandler);
    }
}
```

### 5.2 å±æ€§ç»‘å®šæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  é…ç½®å±æ€§ç»‘å®šæµç¨‹                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  application.yml:                                          â”‚
â”‚  my:                                                       â”‚
â”‚    service:                                                â”‚
â”‚      name: myapp                                           â”‚
â”‚      url: http://localhost:8080                            â”‚
â”‚      connect-timeout: 5s                                   â”‚
â”‚                                                             â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  1. PropertySourceåŠ è½½é…ç½®                                 â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  2. @ConfigurationProperties(prefix = "my.service")        â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  3. Binderç»‘å®šå±æ€§                                         â”‚
â”‚     â”œâ”€â”€ my.service.name â†’ setName("myapp")                â”‚
â”‚     â”œâ”€â”€ my.service.url â†’ setUrl("http://...")             â”‚
â”‚     â””â”€â”€ my.service.connect-timeout â†’ setConnectTimeout()  â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  4. ç±»å‹è½¬æ¢                                               â”‚
â”‚     â””â”€â”€ "5s" â†’ Duration.ofSeconds(5)                      â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  5. å±æ€§éªŒè¯ï¼ˆå¦‚æœæœ‰@Validatedï¼‰                           â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  6. Beanå°±ç»ª                                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 æ¾æ•£ç»‘å®šè§„åˆ™

```java
// é…ç½®å±æ€§ç±»
@ConfigurationProperties(prefix = "my.service")
public class MyServiceProperties {
    private String serverUrl;  // é©¼å³°å‘½å
}

// ä»¥ä¸‹é…ç½®æ–¹å¼éƒ½å¯ä»¥ç»‘å®šåˆ°serverUrlï¼š
// my.service.server-url=xxx     (æ¨èï¼škebab-case)
// my.service.serverUrl=xxx      (é©¼å³°)
// my.service.server_url=xxx     (ä¸‹åˆ’çº¿)
// my.service.SERVERURL=xxx      (å¤§å†™)
// MY_SERVICE_SERVER_URL=xxx     (ç¯å¢ƒå˜é‡é£æ ¼)
```

---

## 6. æœ€ä½³å®è·µ

### 6.1 æ¡ä»¶æ³¨è§£ä½¿ç”¨

```java
@AutoConfiguration
// 1. ç±»å­˜åœ¨æ¡ä»¶ - æœ€å…ˆè¯„ä¼°ï¼Œæ€§èƒ½æœ€å¥½
@ConditionalOnClass(MyService.class)

// 2. å±æ€§æ¡ä»¶ - å…è®¸ç”¨æˆ·ç¦ç”¨
@ConditionalOnProperty(prefix = "my.service", name = "enabled", 
    havingValue = "true", matchIfMissing = true)

// 3. Beanæ¡ä»¶ - å…è®¸ç”¨æˆ·è‡ªå®šä¹‰è¦†ç›–
@ConditionalOnMissingBean(MyServiceTemplate.class)
public class MyServiceAutoConfiguration {
    
    @Bean
    @ConditionalOnMissingBean  // å…è®¸ç”¨æˆ·è¦†ç›–
    public MyServiceTemplate myServiceTemplate(MyServiceProperties properties) {
        return new MyServiceTemplate(properties);
    }
}
```

### 6.2 é…ç½®é¡ºåºæ§åˆ¶

```java
// åœ¨æŸä¸ªé…ç½®ä¹‹å‰
@AutoConfiguration(before = DataSourceAutoConfiguration.class)

// åœ¨æŸä¸ªé…ç½®ä¹‹å
@AutoConfiguration(after = DataSourceAutoConfiguration.class)

// ä½¿ç”¨@AutoConfigureOrder
@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE)

// ä½¿ç”¨@AutoConfigureBefore/@AutoConfigureAfter
@AutoConfigureBefore(DataSourceAutoConfiguration.class)
@AutoConfigureAfter(JdbcTemplateAutoConfiguration.class)
```

### 6.3 é…ç½®å±æ€§éªŒè¯

```java
@ConfigurationProperties(prefix = "my.service")
@Validated  // å¯ç”¨éªŒè¯
public class MyServiceProperties {
    
    @NotNull
    private String name;
    
    @NotEmpty
    @URL
    private String url;
    
    @Min(1)
    @Max(100)
    private int maxConnections = 10;
    
    @DurationMin(seconds = 1)
    @DurationMax(minutes = 5)
    private Duration timeout = Duration.ofSeconds(30);
}
```

### 6.4 æä¾›é»˜è®¤å€¼å’Œæ–‡æ¡£

```java
@ConfigurationProperties(prefix = "my.service")
public class MyServiceProperties {
    
    /**
     * æœåŠ¡åç§°ï¼Œç”¨äºæ ‡è¯†å’Œæ—¥å¿—è®°å½•
     * @see MyServiceTemplate#getName()
     */
    private String name = "default";  // æä¾›åˆç†çš„é»˜è®¤å€¼
    
    /**
     * æœåŠ¡URLï¼Œå¿…é¡»æ˜¯æœ‰æ•ˆçš„HTTP/HTTPSåœ°å€
     * ç¤ºä¾‹ï¼šhttps://api.example.com
     */
    private String url;
    
    /**
     * è¿æ¥è¶…æ—¶æ—¶é—´
     * æ”¯æŒçš„æ ¼å¼ï¼š5s, 500ms, 1m
     * é»˜è®¤ï¼š5ç§’
     */
    private Duration connectTimeout = Duration.ofSeconds(5);
}
```

---

## 7. é¢è¯•è¦ç‚¹

### 7.1 é«˜é¢‘é¢è¯•é¢˜

#### Q1: SpringBoot Starterçš„ä½œç”¨ï¼Ÿ

```
ç­”æ¡ˆè¦ç‚¹ï¼š
1. ç®€åŒ–ä¾èµ–ç®¡ç†ï¼šä¸€ä¸ªStarteråŒ…å«æ‰€æœ‰å¿…è¦ä¾èµ–
2. è‡ªåŠ¨é…ç½®ï¼šå¼•å…¥å³å¯ä½¿ç”¨ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®
3. çº¦å®šä¼˜äºé…ç½®ï¼šæä¾›åˆç†çš„é»˜è®¤å€¼
4. å¯æ‰©å±•ï¼šæ”¯æŒè‡ªå®šä¹‰è¦†ç›–

ç»„æˆéƒ¨åˆ†ï¼š
- Starteræ¨¡å—ï¼šä¾èµ–èšåˆï¼ˆç©ºå£³ï¼‰
- Autoconfigureæ¨¡å—ï¼šè‡ªåŠ¨é…ç½®é€»è¾‘
- æ ¸å¿ƒåº“ï¼šå®é™…åŠŸèƒ½å®ç°
```

#### Q2: å¦‚ä½•è‡ªå®šä¹‰Starterï¼Ÿ

```
æ­¥éª¤ï¼š
1. åˆ›å»ºautoconfigureæ¨¡å—
   - é…ç½®å±æ€§ç±»ï¼ˆ@ConfigurationPropertiesï¼‰
   - è‡ªåŠ¨é…ç½®ç±»ï¼ˆ@AutoConfigurationï¼‰
   - æ³¨å†Œåˆ°AutoConfiguration.imports

2. åˆ›å»ºstarteræ¨¡å—
   - ä¾èµ–autoconfigureæ¨¡å—
   - ä¾èµ–æ ¸å¿ƒåº“

3. ä½¿ç”¨æ¡ä»¶æ³¨è§£
   - @ConditionalOnClass
   - @ConditionalOnMissingBean
   - @ConditionalOnProperty

4. æä¾›é…ç½®å…ƒæ•°æ®
   - spring-configuration-metadata.json
```

#### Q3: @ConfigurationPropertieså’Œ@Valueçš„åŒºåˆ«ï¼Ÿ

```
@ConfigurationPropertiesï¼š
- æ‰¹é‡ç»‘å®šé…ç½®
- æ”¯æŒæ¾æ•£ç»‘å®š
- æ”¯æŒç±»å‹å®‰å…¨
- æ”¯æŒéªŒè¯
- æ”¯æŒå¤æ‚ç±»å‹ï¼ˆListã€Mapã€åµŒå¥—å¯¹è±¡ï¼‰
- éœ€è¦@EnableConfigurationProperties

@Valueï¼š
- å•ä¸ªå±æ€§æ³¨å…¥
- æ”¯æŒSpELè¡¨è¾¾å¼
- ä¸æ”¯æŒæ¾æ•£ç»‘å®š
- ä¸æ”¯æŒéªŒè¯
- é€‚åˆç®€å•åœºæ™¯

æ¨èï¼šé…ç½®ç±»ä½¿ç”¨@ConfigurationProperties
```

### 7.2 çŸ¥è¯†ç‚¹æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SpringBoot Starteræ€»ç»“                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Starterç»„æˆï¼š                                               â”‚
â”‚  â”œâ”€â”€ starteræ¨¡å—ï¼šä¾èµ–èšåˆ                                  â”‚
â”‚  â”œâ”€â”€ autoconfigureæ¨¡å—ï¼šè‡ªåŠ¨é…ç½®                            â”‚
â”‚  â””â”€â”€ æ ¸å¿ƒåº“ï¼šåŠŸèƒ½å®ç°                                       â”‚
â”‚                                                             â”‚
â”‚  å‘½åè§„èŒƒï¼š                                                  â”‚
â”‚  â”œâ”€â”€ å®˜æ–¹ï¼šspring-boot-starter-{name}                      â”‚
â”‚  â””â”€â”€ ç¬¬ä¸‰æ–¹ï¼š{name}-spring-boot-starter                    â”‚
â”‚                                                             â”‚
â”‚  è‡ªåŠ¨é…ç½®è¦ç´ ï¼š                                              â”‚
â”‚  â”œâ”€â”€ @AutoConfiguration                                    â”‚
â”‚  â”œâ”€â”€ @ConditionalOnXxxæ¡ä»¶æ³¨è§£                             â”‚
â”‚  â”œâ”€â”€ @EnableConfigurationProperties                        â”‚
â”‚  â””â”€â”€ AutoConfiguration.importsæ³¨å†Œ                         â”‚
â”‚                                                             â”‚
â”‚  é…ç½®å±æ€§ï¼š                                                  â”‚
â”‚  â”œâ”€â”€ @ConfigurationPropertiesç»‘å®š                          â”‚
â”‚  â”œâ”€â”€ æ¾æ•£ç»‘å®šè§„åˆ™                                          â”‚
â”‚  â”œâ”€â”€ ç±»å‹è½¬æ¢                                              â”‚
â”‚  â””â”€â”€ å±æ€§éªŒè¯                                              â”‚
â”‚                                                             â”‚
â”‚  æœ€ä½³å®è·µï¼š                                                  â”‚
â”‚  â”œâ”€â”€ æä¾›åˆç†é»˜è®¤å€¼                                        â”‚
â”‚  â”œâ”€â”€ ä½¿ç”¨@ConditionalOnMissingBeanå…è®¸è¦†ç›–                 â”‚
â”‚  â”œâ”€â”€ æä¾›é…ç½®å…ƒæ•°æ®                                        â”‚
â”‚  â””â”€â”€ ç¼–å†™å®Œå–„çš„æ–‡æ¡£                                        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [SpringBootå®˜æ–¹æ–‡æ¡£ - Creating Your Own Starter](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.developing-auto-configuration)
- [SpringBootæºç  - spring-boot-starters](https://github.com/spring-projects/spring-boot/tree/main/spring-boot-project/spring-boot-starters)

---

**æŒæ¡Starteræœºåˆ¶ï¼Œæ‰“é€ ä¸“ä¸šçš„SpringBootæ‰©å±•ï¼** ğŸš€

*æœ€åæ›´æ–°ï¼š2025-12-28*
