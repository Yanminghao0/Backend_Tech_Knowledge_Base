# Nettyæºç è§£è¯»

> ğŸ’¡ æ·±å…¥ç†è§£Nettyé«˜æ€§èƒ½ç½‘ç»œæ¡†æ¶çš„æ ¸å¿ƒå®ç°åŸç†

---

## ğŸ“š ç›®å½•ç»“æ„

```
Nettyæºç è§£è¯»/
â”œâ”€â”€ README.md                    # æœ¬æ–‡æ¡£
â”œâ”€â”€ æ ¸å¿ƒæ¶æ„è§£æ.md              # Nettyæ•´ä½“æ¶æ„ âœ…
â”œâ”€â”€ EventLoopæºç è§£æ.md         # äº‹ä»¶å¾ªç¯æœºåˆ¶ âœ…
â”œâ”€â”€ Pipelineæºç è§£æ.md          # è´£ä»»é“¾æ¨¡å¼ âœ…
â”œâ”€â”€ å†…å­˜ç®¡ç†æºç è§£æ.md          # ByteBufä¸å†…å­˜æ±  âœ…
â”œâ”€â”€ Bootstrapæºç è§£æ.md         # å¯åŠ¨å™¨æºç  âœ…
â”œâ”€â”€ ChannelHandleræºç è§£æ.md    # å¤„ç†å™¨æºç  âœ…
â”œâ”€â”€ ç¼–è§£ç å™¨æºç è§£æ.md          # ç¼–è§£ç å™¨æºç  âœ…
â””â”€â”€ é›¶æ‹·è´æºç è§£æ.md            # é›¶æ‹·è´å®ç° âœ…
```

---

## ğŸ¯ å­¦ä¹ ç›®æ ‡

### æ ¸å¿ƒé—®é¢˜
1. Nettyçš„çº¿ç¨‹æ¨¡å‹æ˜¯æ€æ ·çš„ï¼Ÿ
2. EventLoopæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ
3. Pipelineè´£ä»»é“¾æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ
4. Nettyçš„å†…å­˜ç®¡ç†æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ
5. Bootstrapå¯åŠ¨å™¨å¦‚ä½•å·¥ä½œï¼Ÿ
6. ChannelHandlerå¦‚ä½•å¤„ç†äº‹ä»¶ï¼Ÿ
7. ç¼–è§£ç å™¨å¦‚ä½•å®ç°æ•°æ®è½¬æ¢ï¼Ÿ
8. Nettyå¦‚ä½•å®ç°é›¶æ‹·è´ï¼Ÿ

### é¢è¯•é«˜é¢‘é—®é¢˜
- â­â­â­â­â­ Reactorçº¿ç¨‹æ¨¡å‹
- â­â­â­â­â­ EventLoopå·¥ä½œåŸç†
- â­â­â­â­â­ Bootstrapå¯åŠ¨æµç¨‹
- â­â­â­â­ Pipelineè´£ä»»é“¾
- â­â­â­â­ ChannelHandleræœºåˆ¶
- â­â­â­â­ ByteBufå†…å­˜ç®¡ç†
- â­â­â­â­ ç¼–è§£ç å™¨åŸç†
- â­â­â­â­ é›¶æ‹·è´å®ç°

---

## ğŸ“– æ ¸å¿ƒå†…å®¹

### 1ï¸âƒ£ æ ¸å¿ƒæ¶æ„è§£æ
ğŸ“„ [æ ¸å¿ƒæ¶æ„è§£æ.md](./æ ¸å¿ƒæ¶æ„è§£æ.md)

**æ ¸å¿ƒå†…å®¹**ï¼š
- âœ… Nettyæ•´ä½“æ¶æ„
- âœ… Reactorçº¿ç¨‹æ¨¡å‹
- âœ… æ ¸å¿ƒç»„ä»¶å…³ç³»
- âœ… å¯åŠ¨æµç¨‹åˆ†æ

### 2ï¸âƒ£ EventLoopæºç è§£æ
ğŸ“„ [EventLoopæºç è§£æ.md](./EventLoopæºç è§£æ.md)

**æ ¸å¿ƒå†…å®¹**ï¼š
- âœ… EventLoopç»§æ‰¿ä½“ç³»
- âœ… äº‹ä»¶å¾ªç¯æœºåˆ¶
- âœ… ä»»åŠ¡è°ƒåº¦
- âœ… çº¿ç¨‹æ¨¡å‹

### 3ï¸âƒ£ Pipelineæºç è§£æ
ğŸ“„ [Pipelineæºç è§£æ.md](./Pipelineæºç è§£æ.md)

**æ ¸å¿ƒå†…å®¹**ï¼š
- âœ… Pipelineç»“æ„
- âœ… Handleré“¾
- âœ… äº‹ä»¶ä¼ æ’­æœºåˆ¶
- âœ… å…¥ç«™å‡ºç«™å¤„ç†

### 4ï¸âƒ£ å†…å­˜ç®¡ç†æºç è§£æ
ğŸ“„ [å†…å­˜ç®¡ç†æºç è§£æ.md](./å†…å­˜ç®¡ç†æºç è§£æ.md)

**æ ¸å¿ƒå†…å®¹**ï¼š
- âœ… ByteBufä½“ç³»
- âœ… å†…å­˜æ± è®¾è®¡
- âœ… å¼•ç”¨è®¡æ•°
- âœ… é›¶æ‹·è´å®ç°

### 5ï¸âƒ£ Bootstrapæºç è§£æ
ğŸ“„ [Bootstrapæºç è§£æ.md](./Bootstrapæºç è§£æ.md)

**æ ¸å¿ƒå†…å®¹**ï¼š
- âœ… å¯åŠ¨å™¨è®¾è®¡æ¨¡å¼
- âœ… ServerBootstrap vs Bootstrap
- âœ… å¯åŠ¨æµç¨‹åˆ†æ
- âœ… é…ç½®å‚æ•°è¯¦è§£

### 6ï¸âƒ£ ChannelHandleræºç è§£æ
ğŸ“„ [ChannelHandleræºç è§£æ.md](./ChannelHandleræºç è§£æ.md)

**æ ¸å¿ƒå†…å®¹**ï¼š
- âœ… Handleræ¥å£ä½“ç³»
- âœ… ChannelHandlerContext
- âœ… ChannelPipelineç®¡ç†
- âœ… äº‹ä»¶ä¼ æ’­æœºåˆ¶

### 7ï¸âƒ£ ç¼–è§£ç å™¨æºç è§£æ
ğŸ“„ [ç¼–è§£ç å™¨æºç è§£æ.md](./ç¼–è§£ç å™¨æºç è§£æ.md)

**æ ¸å¿ƒå†…å®¹**ï¼š
- âœ… ByteToMessageDecoder
- âœ… MessageToByteEncoder
- âœ… å†…ç½®ç¼–è§£ç å™¨
- âœ… è‡ªå®šä¹‰ç¼–è§£ç å™¨

### 8ï¸âƒ£ é›¶æ‹·è´æºç è§£æ
ğŸ“„ [é›¶æ‹·è´æºç è§£æ.md](./é›¶æ‹·è´æºç è§£æ.md)

**æ ¸å¿ƒå†…å®¹**ï¼š
- âœ… é›¶æ‹·è´åŸç†
- âœ… CompositeByteBuf
- âœ… FileRegionæ–‡ä»¶ä¼ è¾“
- âœ… DirectByteBufferä¼˜åŒ–

---

## ğŸš€ å¿«é€Ÿå…¥é—¨

### NettyæœåŠ¡ç«¯ç¤ºä¾‹

```java
public class NettyServer {
    public static void main(String[] args) throws Exception {
        // Bossçº¿ç¨‹ç»„ï¼šæ¥æ”¶è¿æ¥
        EventLoopGroup bossGroup = new NioEventLoopGroup(1);
        // Workerçº¿ç¨‹ç»„ï¼šå¤„ç†IO
        EventLoopGroup workerGroup = new NioEventLoopGroup();
        
        try {
            ServerBootstrap bootstrap = new ServerBootstrap();
            bootstrap.group(bossGroup, workerGroup)
                .channel(NioServerSocketChannel.class)
                .option(ChannelOption.SO_BACKLOG, 128)
                .childOption(ChannelOption.SO_KEEPALIVE, true)
                .childHandler(new ChannelInitializer<SocketChannel>() {
                    @Override
                    protected void initChannel(SocketChannel ch) {
                        ch.pipeline()
                            .addLast(new StringDecoder())
                            .addLast(new StringEncoder())
                            .addLast(new ServerHandler());
                    }
                });
            
            // ç»‘å®šç«¯å£
            ChannelFuture future = bootstrap.bind(8080).sync();
            System.out.println("Server started on port 8080");
            
            // ç­‰å¾…å…³é—­
            future.channel().closeFuture().sync();
        } finally {
            bossGroup.shutdownGracefully();
            workerGroup.shutdownGracefully();
        }
    }
}

class ServerHandler extends SimpleChannelInboundHandler<String> {
    @Override
    protected void channelRead0(ChannelHandlerContext ctx, String msg) {
        System.out.println("Received: " + msg);
        ctx.writeAndFlush("Echo: " + msg);
    }
}
```

---

## ğŸ’¡ æ ¸å¿ƒçŸ¥è¯†ç‚¹é€ŸæŸ¥

### Reactorçº¿ç¨‹æ¨¡å‹

```
å•çº¿ç¨‹æ¨¡å‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Reactor Thread            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Accept  â”‚  â”‚  Read/Write     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸»ä»å¤šçº¿ç¨‹æ¨¡å‹ï¼ˆNettyé»˜è®¤ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Boss EventLoopGroup         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     Accept Connections      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Worker EventLoopGroup        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚EventLoopâ”‚ â”‚EventLoopâ”‚ â”‚ ... â”‚  â”‚
â”‚  â”‚Read/Writeâ”‚ â”‚Read/Writeâ”‚ â”‚     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

```
Channelï¼šç½‘ç»œé€šé“ï¼Œä»£è¡¨ä¸€ä¸ªè¿æ¥
EventLoopï¼šäº‹ä»¶å¾ªç¯ï¼Œå¤„ç†IOäº‹ä»¶
EventLoopGroupï¼šEventLoopç»„
ChannelPipelineï¼šå¤„ç†å™¨é“¾
ChannelHandlerï¼šäº‹ä»¶å¤„ç†å™¨
ByteBufï¼šå­—èŠ‚ç¼“å†²åŒº
Bootstrapï¼šå¯åŠ¨å¼•å¯¼ç±»
```

### Pipelineäº‹ä»¶ä¼ æ’­

```
å…¥ç«™äº‹ä»¶ï¼ˆInboundï¼‰ï¼šä»Headåˆ°Tail
â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ Head â”‚ -> â”‚ Handler1 â”‚ -> â”‚ Handler2 â”‚ -> â”‚ Tail â”‚
â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜

å‡ºç«™äº‹ä»¶ï¼ˆOutboundï¼‰ï¼šä»Tailåˆ°Head
â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ Head â”‚ <- â”‚ Handler1 â”‚ <- â”‚ Handler2 â”‚ <- â”‚ Tail â”‚
â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### æ¨èä¹¦ç±
- ğŸ“˜ ã€ŠNettyå®æˆ˜ã€‹- Norman Maurer
- ğŸ“˜ ã€ŠNettyæƒå¨æŒ‡å—ã€‹- ææ—é”‹

### åœ¨çº¿èµ„æº
- ğŸŒ [Nettyå®˜æ–¹æ–‡æ¡£](https://netty.io/wiki/)
- ğŸŒ [Nettyæºç ](https://github.com/netty/netty)

---

**æ·±å…¥Nettyæºç ï¼ŒæŒæ¡é«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹ï¼** ğŸš€

*æœ€åæ›´æ–°ï¼š2025-12-28*
