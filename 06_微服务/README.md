# 微服务架构

> 💡 深入理解微服务架构设计、注册中心、配置中心、RPC框架等核心技术

---

## 📚 本模块内容

### 1️⃣ 注册中心与配置中心

#### Nacos核心机制详解
📄 [Nacos核心机制详解.md](./Nacos核心机制详解.md)

**核心内容**：
- ✅ 服务注册与发现机制
- ✅ 配置管理与动态推送
- ✅ 一致性协议（Distro + Raft）
- ✅ 集群架构与数据同步
- ✅ 客户端机制（心跳、长轮询）

**核心特性**：
- 🔍 动态服务发现
- ⚙️ 动态配置管理
- 📊 服务健康监测
- 🌐 多数据中心支持

**适用场景**：注册中心、配置中心、服务元数据管理、灰度发布

---

### 2️⃣ Spring Cloud Alibaba生态

#### Spring Cloud Alibaba全家桶
📄 [Spring Cloud Alibaba全家桶.md](./Spring%20Cloud%20Alibaba全家桶.md)

**核心内容**：
- ✅ **Nacos**：服务注册发现 + 配置中心
- ✅ **Sentinel**：流量控制、熔断降级
- ✅ **Gateway**：统一网关、路由转发
- ✅ **OpenFeign**：声明式HTTP客户端
- ✅ **Seata**：分布式事务解决方案

**架构图**：
```
┌─────────────┐
│   Gateway   │  统一网关
└──────┬──────┘
       │
   ┌───┴───┬───────┬───────┐
   │       │       │       │
┌──▼──┐ ┌──▼──┐ ┌──▼──┐ ┌──▼──┐
│ 服务A│ │ 服务B│ │ 服务C│ │ 服务D│
└──┬──┘ └──┬──┘ └──┬──┘ └──┬──┘
   │       │       │       │
   └───┬───┴───────┴───────┘
       │
   ┌───▼────┐
   │ Nacos  │  注册中心 + 配置中心
   └────────┘
       │
   ┌───▼────┐
   │Sentinel│  流量控制 + 熔断降级
   └────────┘
```

**关键字**：`Spring Cloud` `Nacos` `Sentinel` `Gateway` `微服务`

---

### 3️⃣ RPC框架

#### Dubbo与gRPC详解
📄 [Dubbo与gRPC详解.md](./Dubbo与gRPC详解.md)

**核心内容**：

**Dubbo部分**：
- ✅ Dubbo架构原理（Provider、Consumer、Registry、Monitor）
- ✅ 服务暴露与引用流程
- ✅ 集群容错（Failover、Failfast、Failsafe等）
- ✅ 负载均衡（随机、轮询、最少活跃、一致性哈希）
- ✅ SPI机制与扩展点

**gRPC部分**：
- ✅ Protocol Buffers序列化
- ✅ HTTP/2协议优势
- ✅ 四种通信模式（一元、服务端流、客户端流、双向流）
- ✅ Java集成与实战

**对比**：

| 特性 | Dubbo | gRPC |
|------|-------|------|
| 协议 | Dubbo协议 | HTTP/2 |
| 序列化 | Hessian/Kryo等 | Protobuf |
| 服务治理 | ⭐⭐⭐⭐⭐ 强大 | ⭐⭐⭐ 基础 |
| 跨语言 | ⭐⭐⭐ 支持 | ⭐⭐⭐⭐⭐ 强大 |
| 生态 | ⭐⭐⭐⭐⭐ 国内主流 | ⭐⭐⭐⭐ 全球主流 |

**关键字**：`Dubbo` `gRPC` `RPC` `服务治理` `负载均衡`

---

## 🎯 学习路径

### 第一阶段：微服务基础
1. 理解微服务架构特点和优势
2. 学习Nacos服务注册与发现
3. 学习Nacos配置中心
4. 实践服务拆分与通信

### 第二阶段：Spring Cloud Alibaba
1. 掌握Gateway网关路由
2. 学习Sentinel流量控制
3. 理解OpenFeign声明式调用
4. 实践服务治理策略

### 第三阶段：RPC框架
1. 理解Dubbo架构和工作原理
2. 学习负载均衡和集群容错
3. 了解gRPC特点和使用场景
4. 对比选型Dubbo vs gRPC

### 第四阶段：高级特性
1. 灰度发布与蓝绿部署
2. 服务网格（Service Mesh）
3. 链路追踪（Sleuth + Zipkin）
4. 分布式事务（Seata）

---

## 💡 核心概念

### 微服务架构特点
```
优点：
✅ 服务独立部署、扩展
✅ 技术栈多样化
✅ 故障隔离
✅ 团队独立开发

缺点：
❌ 分布式复杂性
❌ 数据一致性
❌ 运维成本高
❌ 服务调用延迟
```

### 服务注册与发现
```
1. 服务启动 → 注册到Nacos
2. 消费者 → 订阅服务列表
3. Nacos推送服务变更
4. 消费者更新本地服务列表
5. 负载均衡选择实例
```

### 配置中心
```
1. 应用启动 → 从Nacos拉取配置
2. 配置变更 → Nacos推送通知
3. 应用监听 → 触发刷新
4. @RefreshScope → 自动更新Bean
```

---

## 🔧 技术选型建议

### Nacos vs Eureka vs Consul

| 特性 | Nacos | Eureka | Consul |
|------|-------|--------|--------|
| 服务发现 | ✅ | ✅ | ✅ |
| 配置管理 | ✅ | ❌ | ✅ |
| 健康检查 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ |
| 一致性 | CP+AP | AP | CP |
| 社区活跃 | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐ |
| 推荐度 | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐ |

**推荐**：优先选择Nacos（功能全面、性能好、国内主流）

---

### Dubbo vs gRPC vs Spring Cloud

| 场景 | 推荐方案 | 理由 |
|------|---------|------|
| 纯Java微服务 | Dubbo + Nacos | 服务治理能力强 |
| 跨语言微服务 | gRPC | 跨语言支持好 |
| Spring生态 | Spring Cloud Alibaba | 无缝集成 |
| 高性能RPC | Dubbo | 性能最优 |
| 流式传输 | gRPC | 支持双向流 |

---

## 📖 相关文档

### 本目录文档
- [Nacos核心机制详解.md](./Nacos核心机制详解.md)
- [Spring Cloud Alibaba全家桶.md](./Spring%20Cloud%20Alibaba全家桶.md)
- [Dubbo与gRPC详解.md](./Dubbo与gRPC详解.md)

### 相关领域
- [../01_Java核心/](../01_Java核心/) - Java基础、JVM、并发
- [../02_Spring生态/](../02_Spring生态/) - Spring核心原理
- [../07_分布式系统/](../07_分布式系统/) - 分布式事务、分布式锁
- [../11_性能优化/](../11_性能优化/) - 性能监控、JVM调优

### 待补充内容
- [ ] Sentinel流量控制详解
- [ ] Gateway网关详解
- [ ] Seata分布式事务深度解析
- [ ] 服务网格（Istio）详解

---

## ⭐ 学习建议

**前置知识**：
- ✅ Java基础（集合、并发、网络）
- ✅ Spring Boot基础
- ✅ HTTP协议
- ✅ MySQL、Redis基础

**学习重点**：
1. ⭐⭐⭐⭐⭐ Nacos服务注册与发现原理
2. ⭐⭐⭐⭐⭐ Nacos配置中心原理
3. ⭐⭐⭐⭐⭐ Dubbo架构和负载均衡
4. ⭐⭐⭐⭐ Spring Cloud组件集成
5. ⭐⭐⭐⭐ 服务治理策略

**实践建议**：
- 搭建Nacos集群环境
- 实现服务注册与发现
- 实现配置动态刷新
- 对比Dubbo和gRPC性能
- 实践服务限流降级

---

**上一级**：[../README.md](../README.md)

*最后更新：2025-10-27*
